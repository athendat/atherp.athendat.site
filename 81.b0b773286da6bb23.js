"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[81],{7231:(me,Y,l)=>{l.d(Y,{C:()=>N});var g=l(520),B=l(2340),e=l(5e3);const F=B.N.API_URL;let N=(()=>{class y{constructor(J){this._httpClient=J}uploadImage(J,_){const w=new FormData;return w.append("image",_,_.name),this._httpClient.post(`${F}/cloudinary/upload/${J}`,w)}removeImage(J,_){const w=_.slice(_.indexOf(J),_.length).split(".")[0],j=(new g.LE).set("public_id",w);return this._httpClient.delete(`${F}/cloudinary/remove`,{params:j})}}return y.\u0275fac=function(J){return new(J||y)(e.LFG(g.eN))},y.\u0275prov=e.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()},6428:(me,Y,l)=>{l.d(Y,{B:()=>e});const e=(0,l(5620).P1)(F=>F.pagination,F=>F.pagination)},5081:(me,Y,l)=>{l.r(Y),l.d(Y,{CommercialModule:()=>Oi});var g=l(5357),B=l(6338),e=l(5e3),F=l(520),N=l(8505),y=l(2114),V=l(5714),J=l(2340),_=l(5620);const w=J.N.API_URL;let j=(()=>{class o{constructor(t,n){this._httpClient=t,this.store=n}getUoms(t=0,n=10,r="name",s="asc",c=""){const u=(new F.LE).append("page",t.toString()).append("size",n.toString()).append("sort",r).append("order",s).append("search",c);return this._httpClient.get(`${w}/uoms/`,{params:u}).pipe((0,N.b)(I=>{this.store.dispatch((0,V.Jr)({pagination:I.pagination})),this.store.dispatch((0,y.u8)({uoms:I.dataArr}))}))}getUomById(t){return this._httpClient.get(`${w}/uoms/${t}`).pipe((0,N.b)(n=>{this.store.dispatch((0,y.sh)({uom:n.uom}))}))}createUom(t){return this._httpClient.post(`${w}/uoms/`,t).pipe((0,N.b)(n=>{this.store.dispatch((0,V.W4)()),this.store.dispatch((0,y.N9)({uom:n.data}))}))}updateUom(t){return this._httpClient.patch(`${w}/uoms/${t._id}`,t).pipe((0,N.b)(n=>{this.store.dispatch((0,y.zM)({uom:n.data}))}))}deleteUom(t){return this._httpClient.delete(`${w}/uoms/${t}`).pipe((0,N.b)(()=>{this.store.dispatch((0,y.X5)({id:t}))}))}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(F.eN),e.LFG(_.yh))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),de=(()=>{class o{constructor(t){this._uomService=t}resolve(t,n){return this._uomService.getUoms()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(j))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var a=l(3075),S=l(9646),C=l(7579),d=l(2722),K=l(7489),L=l(4787),oe=l(1910),f=l(9784),G=l(2491);const ue=o=>o.uoms,ne=((0,_.P1)(ue,o=>o.uom),(0,_.P1)(ue,o=>o.uoms));var D=l(4062),pe=l(3005),q=l(1683),$=l(2834),Q=l(7261),Ae=l(7231),m=l(9808),U=l(393),W=l(508),k=l(7423),X=l(288),b=l(5245),p=l(7322),A=l(7531),ie=l(4107),re=l(2368);function we(o,i){1&o&&(e.TgZ(0,"div",4),e._UZ(1,"mat-icon",6),e.TgZ(2,"a",66),e._uU(3,"Nuevo"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-right"))}function Qe(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1,"Nuevo Producto o Servicio"),e.qZA())}function Ue(o,i){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Informaci\xf3n de ",t.selectedProductService.name,"")}}const ee=function(o){return{"cursor-not-allowed":o}};function Fe(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,ee,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function Je(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,ee,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function Se(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function Pe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function De(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function Ne(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",30),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function Me(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function Re(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",27)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",70),e.YNc(4,Ne,3,2,"ng-container",56),e.qZA(),e.YNc(5,Me,2,0,"mat-error",15),e.qZA()),2&o){const t=i.ngIf,n=e.oxw();e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function Ee(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function Ye(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function Be(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function Le(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function Oe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function ze(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function je(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function Ge(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function $e(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function He(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 100"),e.qZA())}function Ve(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function Ke(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function We(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 100"),e.qZA())}function Xe(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function et(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",71)(2,"div",72),e._UZ(3,"img",73),e.TgZ(4,"button",74),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeImage(s))}),e._UZ(5,"mat-icon",75),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.Q6J("alt","Product images")("src",t,e.LSH)}}function tt(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.createProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,ee,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function ot(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.updateProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,ee,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}let nt=(()=>{class o{constructor(t,n,r,s,c,u,I,E,zi){this._activatedRoute=t,this._changeDetectorRef=n,this._router=r,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=u,this._snackBar=I,this._imagesService=E,this.store=zi,this.user$=(0,S.of)(null),this.uoms$=null,this.images=[],this._unsubscribeAll=new C.x}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(ne),this.store.select(oe.Qs).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.store.select(pe.YP).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedProductService=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:["",[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!0},[a.kI.required]],cost:[0,[a.kI.required,a.kI.min(1),G.L.numbersAndDecimalsPattern()]],margin:[0,[a.kI.min(0),a.kI.max(1e3),G.L.numbersAndDecimalsPattern()]],taxPercent:[0,[a.kI.min(0),a.kI.max(100),G.L.numbersAndDecimalsPattern()]],discount:[0,[a.kI.min(0),a.kI.max(100),G.L.numbersAndDecimalsPattern()]],price:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],imageUrl:[""],images:[[]],description:["",[a.kI.maxLength(1e3)]]}),this._activatedRoute.params.pipe((0,d.R)(this._unsubscribeAll)).subscribe(({goodsId:t})=>{this.windowsMode="new"===t?"new":"edit",this._fillProductServiceData(),this._changeDetectorRef.markForCheck()}),this.productServiceForm.get("images").valueChanges.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.images=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){let t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t=(0,K.omit)(t,"_id"),t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}uploadImage(t){if(!t.length)return;const r=t[0];!["image/jpeg","image/jpg","image/webp","image/png"].includes(r.type)||this._imagesService.uploadImage("Comercial",r).subscribe(s=>{const c=[...this.productServiceForm.get("images").value,s.imageUrl];this.productServiceForm.get("images").setValue(c);const u=Object.assign(Object.assign({},K.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:c});"edit"===this.windowsMode&&this._productServicesService.updateProductService(u).subscribe(()=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})},s=>{console.warn(s)})}removeImage(t){void 0!==t&&this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(r=>{"confirmed"===r&&this._imagesService.removeImage("Comercial",t).subscribe(c=>{const u=[...this.productServiceForm.get("images").value],I=u.findIndex(E=>E===t);if(u.splice(I,1),this.productServiceForm.get("images").setValue(u),"edit"===this.windowsMode){const E=Object.assign(Object.assign({},K.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:u});this._productServicesService.updateProductService(E).subscribe(()=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})}})})}trackByFn(t,n){return n.id||t}_fillProductServiceData(){"edit"===this.windowsMode&&(this.productServiceForm.patchValue(this.selectedProductService),this.images=this.selectedProductService.images,this.productServiceForm.get("merchantId").setValue(this.selectedProductService.merchantId._id),void 0!==this.selectedProductService&&this.productServiceForm.get("uomId").setValue(this.selectedProductService.uomId._id))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0),e.Y36(a.qu),e.Y36(q.R),e.Y36($.z),e.Y36(Q.ux),e.Y36(Ae.C),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-detail"]],decls:153,vars:69,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/goods",1,"ml-1","text-primary-500","hover:underline"],["class","flex items-center ml-1 whitespace-nowrap",4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[4,"ngIf"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 text-white bg-primary-500 hover:bg-primary-700 hover:shadow-lg","mat-raised-button","",3,"disabled","ngClass","click",4,"ngIf"],[1,"flex-auto","p-4","sm:p-6"],[1,"flex","flex-col","flex-auto","min-w-0"],[3,"formGroup","autocomplete"],["multi","",1,"w-full","bg-transparent"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","pb-8","pt-8","pr-4","pl-4","border-t-2","sm:grid-cols-2","gap-y-3","gap-x-6"],[1,"sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["class","sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["value","MXN"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","required","",3,"formControlName","min","max"],["impuestoField",""],["descuentoField",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","value"],[1,"flex","flex-col","sm:col-span-1"],["value","true",1,"pt-4","mb-2",3,"color","formControlName"],[1,"pt-4","sm:col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[1,"w-full","pb-8","pt-8","pr-4","pl-4","border-t-2"],[1,"flex","flex-row","w-full","flex-wrap"],[1,"flex","flex-row","flex-wrap"],[4,"ngFor","ngForOf"],[1,"w-26","h-26","mt-3"],["id","image-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["imageFileInput",""],["for","image-file-input","matRipple",""],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","w-26","h-26","transition-all","duration-100","ease-linear","border","border-gray-300","rounded-lg","cursor-pointer","hover:bg-hover"],[1,"flex","flex-col","items-center","justify-center","h-full"],[1,"font-thin","icon-size-10",3,"svgIcon"],[1,"flex","flex-col","flex-wrap","justify-end","px-6","pb-10","sm:flex-row","flex-0","sm:items-center","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex","items-center","flex-shrink-0","mt-6","text-right","sm:mt-0","sm:ml-4"],[1,"ml-1","text-primary-500"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[3,"formControlName"],[1,"flex","items-center","mt-3"],[1,"relative","flex","items-center","justify-center","mr-6","overflow-hidden","border","rounded","w-26","h-26","flex-0"],[3,"alt","src"],["mat-mini-fab","",1,"absolute","p-5","transition-opacity","ease-linear","delay-200","rounded-full","opacity-50","bg-primary-500","hover:opacity-100",3,"click"],["svgIcon","heroicons_solid:trash",1,"text-white","icon-size-5"]],template:function(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()(),e.YNc(16,we,4,1,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"a",11),e._UZ(19,"mat-icon",6),e.TgZ(20,"span",12),e._uU(21,"Regresar"),e.qZA()()()(),e.TgZ(22,"div",13)(23,"div",14),e.YNc(24,Qe,2,0,"span",15),e.YNc(25,Ue,2,1,"span",15),e.qZA()()(),e.TgZ(26,"div",16),e.YNc(27,Fe,4,5,"button",17),e.YNc(28,Je,4,5,"button",17),e.qZA()(),e.TgZ(29,"div",18)(30,"div",19)(31,"form",20)(32,"mat-accordion",21)(33,"mat-expansion-panel",22)(34,"mat-expansion-panel-header",23)(35,"mat-panel-title",24)(36,"div",25),e._uU(37," Informaci\xf3n General "),e.qZA()()(),e.TgZ(38,"div",26)(39,"div",27)(40,"mat-form-field",28)(41,"mat-label"),e._uU(42,"Tipo"),e.qZA(),e.TgZ(43,"mat-select",29)(44,"mat-option",30),e._uU(45," Producto "),e.qZA(),e.TgZ(46,"mat-option",30),e._uU(47," Servicio "),e.qZA()(),e.YNc(48,Se,2,0,"mat-error",15),e.TgZ(49,"mat-hint"),e._uU(50,"Especifique si es producto o servicio"),e.qZA()()(),e.TgZ(51,"div",27)(52,"mat-form-field",28)(53,"mat-label"),e._uU(54,"Nombre"),e.qZA(),e._UZ(55,"input",31),e.YNc(56,Pe,2,0,"mat-error",15),e.YNc(57,De,2,0,"mat-error",15),e.qZA()(),e.YNc(58,Re,6,3,"mat-form-field",32),e.ALo(59,"async"),e.TgZ(60,"div",27)(61,"mat-form-field",28)(62,"mat-label"),e._uU(63,"Moneda por defecto"),e.qZA(),e.TgZ(64,"mat-select",29)(65,"mat-option",33),e._uU(66,"CUP"),e.qZA(),e.TgZ(67,"mat-option",34),e._uU(68,"MLC"),e.qZA(),e.TgZ(69,"mat-option",35),e._uU(70,"USD"),e.qZA(),e.TgZ(71,"mat-option",36),e._uU(72,"MXN"),e.qZA()(),e._UZ(73,"mat-icon",37),e.YNc(74,Ee,2,0,"mat-error",15),e.qZA()(),e.TgZ(75,"mat-form-field",27)(76,"mat-label"),e._uU(77,"Costo"),e.qZA(),e.TgZ(78,"span",38),e._uU(79,"$"),e.qZA(),e._UZ(80,"input",39,40),e.YNc(82,Ye,2,0,"mat-error",15),e.YNc(83,Be,2,0,"mat-error",15),e.YNc(84,Le,2,0,"mat-error",15),e.qZA(),e.TgZ(85,"mat-form-field",27)(86,"mat-label"),e._uU(87,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(88,"span",38),e._uU(89,"%"),e.qZA(),e._UZ(90,"input",41,42),e.YNc(92,Oe,2,0,"mat-error",15),e.YNc(93,ze,2,0,"mat-error",15),e.YNc(94,je,2,0,"mat-hint",15),e.qZA(),e.TgZ(95,"mat-form-field",27)(96,"mat-label"),e._uU(97,"Impuesto"),e.qZA(),e.TgZ(98,"span",38),e._uU(99,"%"),e.qZA(),e._UZ(100,"input",43,44),e.YNc(102,Ge,2,0,"mat-error",15),e.YNc(103,$e,2,0,"mat-error",15),e.YNc(104,He,2,0,"mat-hint",15),e.qZA(),e.TgZ(105,"mat-form-field",27)(106,"mat-label"),e._uU(107,"Descuento"),e.qZA(),e.TgZ(108,"span",38),e._uU(109,"%"),e.qZA(),e._UZ(110,"input",43,45),e.YNc(112,Ve,2,0,"mat-error",15),e.YNc(113,Ke,2,0,"mat-error",15),e.YNc(114,We,2,0,"mat-hint",15),e.qZA(),e.TgZ(115,"mat-form-field",27)(116,"mat-label"),e._uU(117,"Precio"),e.qZA(),e.TgZ(118,"span",38),e._uU(119,"$"),e.qZA(),e._UZ(120,"input",46),e.YNc(121,Xe,2,0,"mat-error",15),e.qZA(),e.TgZ(122,"div",47)(123,"mat-label"),e._uU(124,"Estado"),e.qZA(),e.TgZ(125,"mat-slide-toggle",48),e._uU(126," Activo "),e.qZA()(),e.TgZ(127,"div",49)(128,"mat-form-field",50)(129,"mat-label"),e._uU(130,"Descripci\xf3n"),e.qZA(),e._UZ(131,"mat-icon",51)(132,"textarea",52),e.qZA()()()(),e.TgZ(133,"mat-expansion-panel")(134,"mat-expansion-panel-header",23)(135,"mat-panel-title",24)(136,"div",25),e._uU(137," Im\xe1genes "),e.qZA()()(),e.TgZ(138,"div",53)(139,"div",54)(140,"div",55),e.YNc(141,et,6,2,"ng-container",56),e.TgZ(142,"div",57)(143,"input",58,59),e.NdJ("change",function(){e.CHM(r);const c=e.MAs(144);return e.KtG(n.uploadImage(c.files))}),e.qZA(),e.TgZ(145,"label",60)(146,"div",61)(147,"div",62),e._UZ(148,"mat-icon",63),e.qZA()()()()()()()()()()()(),e.TgZ(149,"div",64)(150,"div",65),e.YNc(151,tt,4,5,"button",17),e.YNc(152,ot,4,5,"button",17),e.qZA()()()}if(2&t){const r=e.MAs(81),s=e.MAs(91),c=e.MAs(101),u=e.MAs(111);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(3),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(5),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","edit"===n.windowsMode&&n.selectedProductService),e.xp6(2),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode),e.xp6(3),e.Q6J("formGroup",n.productServiceForm)("autocomplete","off"),e.xp6(2),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("maxlength")||n.productServiceForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",e.lcZ(59,67,n.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(9),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("currency").hasError("required")),e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("margin").hasError("min")||n.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").hasError("min")||n.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("discount").hasError("min")||n.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",c.value/100*r.value-u.value/100*r.value+s.value/100*r.value+ +r.value),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("price").hasError("required")),e.xp6(4),e.Q6J("color","primary")("formControlName","active"),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(7),e.Q6J("ngForOf",n.images),e.xp6(2),e.Q6J("multiple",!0)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(3),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode)}},dependencies:[g.yS,m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.sg,a.u,U.PQ,W.ey,k.lW,X.pp,X.ib,X.yz,X.yK,b.Hw,p.TO,p.KE,p.bx,p.hX,p.qo,A.Nt,W.wG,ie.gD,re.Rr,m.Ov],encapsulation:2,changeDetection:0}),o})();var T=l(6087),h=l(4847),O=l(6451),P=l(8372),x=l(3900),M=l(4004),R=l(3844);class it{}var z=l(6428),v=l(8966),ae=l(5119);function rt(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Agregar producto o servicio"),e.qZA())}function at(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar producto o servicio"),e.qZA())}function st(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del producto o servicio"),e.qZA())}function ct(o,i){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),e.ynx(4),e.TgZ(5,"div",12)(6,"mat-label",13),e._uU(7,"Nombre"),e.qZA(),e.TgZ(8,"div",14),e._uU(9),e.qZA()(),e.BQk(),e.ynx(10),e.TgZ(11,"div",12)(12,"mat-label",13),e._uU(13,"Descripci\xf3n"),e.qZA(),e.TgZ(14,"div",14),e._uU(15),e.qZA()(),e.BQk(),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(9),e.Oqu(t.data.productService.name),e.xp6(6),e.Oqu(t.data.productService.description)}}function lt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function mt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function dt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function ut(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",21),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function pt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function gt(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",18)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",45),e.YNc(4,ut,3,2,"ng-container",46),e.qZA(),e.YNc(5,pt,2,0,"mat-error",6),e.qZA()),2&o){const t=i.ngIf,n=e.oxw(2);e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function _t(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function ft(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function ht(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function xt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function vt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function bt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function Zt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function Ct(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function yt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 15 "),e.qZA())}function Tt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 15"),e.qZA())}function It(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function qt(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 50 "),e.qZA())}function kt(o,i){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 50"),e.qZA())}function At(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function wt(o,i){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Tipo"),e.qZA(),e.TgZ(7,"mat-select",20)(8,"mat-option",21),e._uU(9," Producto "),e.qZA(),e.TgZ(10,"mat-option",21),e._uU(11," Servicio "),e.qZA()(),e.YNc(12,lt,2,0,"mat-error",6),e.TgZ(13,"mat-hint"),e._uU(14,"Especifique si es producto o servicio"),e.qZA()()(),e.TgZ(15,"div",18)(16,"mat-form-field",19)(17,"mat-label"),e._uU(18,"Nombre"),e.qZA(),e._UZ(19,"input",22),e.YNc(20,mt,2,0,"mat-error",6),e.YNc(21,dt,2,0,"mat-error",6),e.qZA()(),e.YNc(22,gt,6,3,"mat-form-field",23),e.ALo(23,"async"),e.TgZ(24,"div",18)(25,"mat-form-field",19)(26,"mat-label"),e._uU(27,"Moneda por defecto"),e.qZA(),e.TgZ(28,"mat-select",20)(29,"mat-option",24),e._uU(30,"CUP"),e.qZA(),e.TgZ(31,"mat-option",25),e._uU(32,"MLC"),e.qZA(),e.TgZ(33,"mat-option",26),e._uU(34,"USD"),e.qZA(),e.TgZ(35,"mat-option",27),e._uU(36,"MXN"),e.qZA()(),e._UZ(37,"mat-icon",28),e.YNc(38,_t,2,0,"mat-error",6),e.qZA()(),e.TgZ(39,"mat-form-field",18)(40,"mat-label"),e._uU(41,"Costo"),e.qZA(),e.TgZ(42,"span",29),e._uU(43,"$"),e.qZA(),e._UZ(44,"input",30,31),e.YNc(46,ft,2,0,"mat-error",6),e.YNc(47,ht,2,0,"mat-error",6),e.YNc(48,xt,2,0,"mat-error",6),e.qZA(),e.TgZ(49,"mat-form-field",18)(50,"mat-label"),e._uU(51,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(52,"span",29),e._uU(53,"%"),e.qZA(),e._UZ(54,"input",32,33),e.YNc(56,vt,2,0,"mat-error",6),e.YNc(57,bt,2,0,"mat-error",6),e.YNc(58,Zt,2,0,"mat-hint",6),e.qZA(),e.TgZ(59,"mat-form-field",18)(60,"mat-label"),e._uU(61,"Impuesto"),e.qZA(),e.TgZ(62,"span",29),e._uU(63,"%"),e.qZA(),e._UZ(64,"input",34,35),e.YNc(66,Ct,2,0,"mat-error",6),e.YNc(67,yt,2,0,"mat-error",6),e.YNc(68,Tt,2,0,"mat-hint",6),e.qZA(),e.TgZ(69,"mat-form-field",18)(70,"mat-label"),e._uU(71,"Descuento"),e.qZA(),e.TgZ(72,"span",29),e._uU(73,"%"),e.qZA(),e._UZ(74,"input",36,37),e.YNc(76,It,2,0,"mat-error",6),e.YNc(77,qt,2,0,"mat-error",6),e.YNc(78,kt,2,0,"mat-hint",6),e.qZA(),e.TgZ(79,"mat-form-field",18)(80,"mat-label"),e._uU(81,"Precio"),e.qZA(),e.TgZ(82,"span",29),e._uU(83,"$"),e.qZA(),e._UZ(84,"input",38),e.YNc(85,At,2,0,"mat-error",6),e.qZA(),e.TgZ(86,"div",39)(87,"mat-label"),e._uU(88,"Estado"),e.qZA(),e.TgZ(89,"mat-slide-toggle",40),e._uU(90," Activo "),e.qZA()(),e.TgZ(91,"div",41)(92,"mat-form-field",42)(93,"mat-label"),e._uU(94,"Descripci\xf3n"),e.qZA(),e._UZ(95,"mat-icon",43)(96,"textarea",44),e.qZA()()()()()),2&o){const t=e.MAs(45),n=e.MAs(55),r=e.MAs(65),s=e.MAs(75),c=e.oxw();e.xp6(2),e.Q6J("formGroup",c.productServiceForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("maxlength")||c.productServiceForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",e.lcZ(23,46,c.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(9),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("currency").hasError("required")),e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("min")||c.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("min")||c.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("min")||c.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",r.value/100*t.value-s.value/100*t.value+n.value/100*t.value+ +t.value),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("price").hasError("required")),e.xp6(4),e.Q6J("value",!0)("color","primary")("formControlName","active"),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3)}}const ge=function(o){return{"cursor-not-allowed":o}};function Qt(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.updateProductService())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,ge,t.productServiceForm.invalid))}}function Ut(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.createProductService())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,ge,t.productServiceForm.invalid))}}function Ft(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",47),e.ynx(2),e.TgZ(3,"button",48),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Qt,3,6,"ng-container",6),e.YNc(6,Ut,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Jt=(()=>{class o{constructor(t,n,r,s,c,u,I,E){this.data=t,this._activatedRoute=n,this._changeDetectorRef=r,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=u,this._snackBar=I,this.store=E,this.dialogMode="view",this.user$=(0,S.of)(null),this.uoms$=null,this._unsubscribeAll=new C.x}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(ne),this.store.select(oe.Qs).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:["",[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!0},[a.kI.required]],cost:[0,[a.kI.required,a.kI.min(1),G.L.onlyNumbersPattern()]],margin:[0,[a.kI.min(0),a.kI.max(1e3)]],taxPercent:[0,[a.kI.min(0),a.kI.max(15)]],discount:[0,[a.kI.min(0),a.kI.max(50)]],price:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],description:["",[a.kI.maxLength(1e3)]]}),"edit"===this.data.dialogMode&&(this.productServiceForm.patchValue(this.data.productService),this.productServiceForm.get("merchantId").setValue(this.data.productService.merchantId._id),void 0!==this.data.productService.uomId&&this.productServiceForm.get("uomId").setValue(this.data.productService.uomId._id))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){let t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t=(0,ae.Z)(t,"_id"),t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(g.gz),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(q.R),e.Y36($.z),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-dialog"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"flex","sm:items-center"],[1,"min-w-56","font-semibold"],[1,"leading-6"],[1,"w-full","overflow-hidden"],[1,"pt-5"],[1,"grid","grid-cols-2","gap-y-3","gap-x-4","w-full","mt-1",3,"formGroup","autocomplete"],[1,"col-span-2","sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["class","col-span-2 sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["value","MXN"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","min","0","max","15","maxlength","9","required","",3,"formControlName"],["impuestoField",""],["type","number","matInput","","step","1","min","0","max","50","maxlength","9","required","",3,"formControlName"],["descuentoField",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","value"],[1,"col-span-2","sm:col-span-1","flex","flex-col"],[1,"pt-4","mb-2",3,"value","color","formControlName"],[1,"col-span-2","pt-4","sm:col-span-2"],[1,"w-full","fuse-mat-textarea","flex-auto"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,rt,2,0,"h2",2),e.YNc(4,at,2,0,"h2",2),e.YNc(5,st,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,ct,16,2,"div",4),e.BQk(),e.ynx(9),e.YNc(10,wt,97,48,"div",5),e.BQk(),e.qZA(),e.YNc(11,Ft,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.productService._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},encapsulation:2,changeDetection:0}),o})();function St(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",44),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Pt(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",45),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}const _e=function(o){return[o]};function Dt(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div",36),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.qZA(),e.TgZ(8,"div",38),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"div",39),e.YNc(12,St,2,1,"ng-container",23),e.YNc(13,Pt,2,1,"ng-container",23),e.qZA(),e.TgZ(14,"div",40)(15,"button",41),e._UZ(16,"mat-icon",42),e.qZA(),e.TgZ(17,"button",43),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteProductService(s))}),e._UZ(18,"mat-icon",42),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.type," "),e.xp6(2),e.hij(" ",t.uomId.name," "),e.xp6(2),e.hij(" ",e.xi3(10,9,t.cost,e.VKq(12,_e,t.currency+" "))," "),e.xp6(3),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("routerLink",e.VKq(14,_e,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Nt(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Dt,19,16,"ng-container",34),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Mt=function(o){return{"pointer-events-none":o}},Rt=function(){return[10,25,50,100]};function Et(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26)(2,"div",27)(3,"div",28),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div",28),e._uU(6," Tipo "),e.qZA(),e.TgZ(7,"div",29),e._uU(8," U.Medida "),e.qZA(),e.TgZ(9,"div",30),e._uU(10," Costo "),e.qZA(),e.TgZ(11,"div",31),e._uU(12," Activo "),e.qZA(),e.TgZ(13,"div",32),e._uU(14," Acciones "),e.qZA()(),e.YNc(15,Nt,2,2,"ng-container",23),e.ALo(16,"async"),e._UZ(17,"mat-paginator",33),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","type"),e.xp6(4),e.Q6J("mat-sort-header","cost"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(16,11,t.productServices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,Mt,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(15,Rt))("showFirstLastButtons",!0)}}function Yt(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Et,18,16,"ng-container",25),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Bt(o,i){if(1&o&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl?"No se han encontrado productos o servicios":"No ha creado ning\xfan producto o servicio a\xfan!")}}const Lt=function(){return["new"]},Ot=[{path:"goods",component:(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._productServiceService=r,this._snackBar=s,this.dialog=c,this.store=u,this.merchantId="",this.productService=new it,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new a.NI(""),this._unsubscribeAll=new C.x}ngOnInit(){this.productServices$=this.store.select(pe.ZQ),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._productServiceService.getProductServices(0,20,"active","desc",t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._productServiceService.getProductServices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){this._openDialog(this.productService,"add")}editProductService(t){this._openDialog(t,"edit")}deleteProductService(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar el departamento ${t.name}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._productServiceService.deleteProductService(t._id,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,n){return n.id||t}_openDialog(t,n){this.dialog.open(Jt,{width:"600px",height:"98%",data:{productService:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(q.R),e.Y36($.z),e.Y36(Q.ux),e.Y36(v.uw),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-productServices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:38,vars:14,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:ml-4"],[1,"mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"ml-4","mt-4","sm:mt-0","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","overflow-x-auto","sm:overflow-x-clip"],[4,"ngIf"],["noProductServices",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","productServices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-end",3,"mat-sort-header"],[1,"flex","justify-center","lg:ml-6",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","productServices-table","md:px-8"],[1,"truncate"],[1,"truncate","text-center"],[1,"truncate","text-right"],[1,"text-center","lg:ml-6"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Productos y Servicios "),e.qZA()()(),e.TgZ(24,"div",14)(25,"mat-form-field",15),e._UZ(26,"mat-icon",16)(27,"input",17),e.qZA(),e.TgZ(28,"button",18),e._UZ(29,"mat-icon",19),e.TgZ(30,"span",20),e._uU(31,"Nuevo"),e.qZA()()()(),e.TgZ(32,"div",21)(33,"div",22),e.YNc(34,Yt,2,2,"ng-container",23),e.ALo(35,"async"),e.YNc(36,Bt,2,1,"ng-template",null,24,e.W1O),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar productos o servicios"),e.xp6(1),e.Q6J("routerLink",e.DdM(13,Lt)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(35,11,n.productServices$)))},dependencies:[g.rH,g.yS,m.mk,m.sg,m.O5,a.Fj,a.JJ,a.oH,U.PQ,k.lW,b.Hw,p.KE,p.qo,A.Nt,T.NW,h.YE,h.nU,m.Ov,m.H9],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})(),resolve:{prodS:(()=>{class o{constructor(t){this._productServicesService=t}resolve(t,n){return this._productServicesService.getProductServices()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG($.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}},{path:"goods/:goodsId",component:nt,resolve:{uoms:de,prod:(()=>{class o{constructor(t){this._productServicesService=t}resolve(t,n){const r=t.params.goodsId;if("new"!==r)return this._productServicesService.getProductServiceById(r)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG($.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}];let zt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Ot),B.m]}),o})();var jt=l(9602);let Gt=(()=>{class o{constructor(t,n,r){this._activatedRoute=t,this._changeDetectorRef=n,this._router=r,this.merchantId="",this._unsubscribeAll=new C.x}ngOnInit(){this._activatedRoute.params.pipe((0,d.R)(this._unsubscribeAll)).subscribe(({merchantId:t})=>{void 0!==t&&(this.merchantId=t,this._changeDetectorRef.markForCheck())})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-commercial"]],decls:38,vars:3,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","w-full"],[1,"grid","grid-flow-row","grid-cols-1","mt-8","sm:grid-cols-2","lg:grid-cols-4","gap-y-12","sm:gap-x-4"],["routerLink","/modules/commercial/goods",1,"flex","items-center","justify-between","w-full","p-6","cursor-pointer","max-w-80","filter-info","hover:shadow-md"],[1,"flex","flex-col"],[1,"text-2xl","font-semibold","leading-tight"],[1,"text-md","text-secondary"],["routerLink","/modules/commercial/uoms",1,"flex","items-center","justify-between","w-full","p-6","cursor-pointer","max-w-80","filter-info","hover:shadow-md"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()()(),e.TgZ(12,"div",8)(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA()()()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," Gesti\xf3n Gesti\xf3n Comercial "),e.qZA()()()(),e.TgZ(20,"div",13)(21,"div",14)(22,"div",15)(23,"div",12),e._uU(24," M\xf3dulos "),e.qZA(),e.TgZ(25,"div",16)(26,"fuse-card",17)(27,"div",18)(28,"div",19),e._uU(29,"Productos y Servicios"),e.qZA(),e.TgZ(30,"div",20),e._uU(31,"listado productos y servicios "),e.qZA()()(),e.TgZ(32,"fuse-card",21)(33,"div",18)(34,"div",19),e._uU(35,"Unidades de medida"),e.qZA(),e.TgZ(36,"div",20),e._uU(37,"listado de unidades de medida"),e.qZA()()()()()()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"))},dependencies:[g.rH,g.yS,jt.y,U.PQ,b.Hw],encapsulation:2,changeDetection:0}),o})();var $t=l(1915);const Ht=function(){return["../"]};let Vt=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["invoice-details-header"]],decls:28,vars:6,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"w-full"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la factura"),e.qZA()()()(),e._UZ(25,"div",14),e.qZA(),e.TgZ(26,"div",15),e._UZ(27,"invoice-details"),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("routerLink",e.DdM(5,Ht)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"))},dependencies:[g.yS,U.PQ,b.Hw,$t._],encapsulation:2,changeDetection:0}),o})();var H=(()=>{return(o=H||(H={})).PendientePago="Pendiente de Pago",o.PagadaParcialmente="Pagada Parcialmente",o.PagadaTotalmente="Pagada Totalmente",o.Cancelada="Cancelada",H;var o})(),Kt=l(7939),se=l(3294),fe=l(9997),ce=l(2181),te=l(7238);function Wt(o,i){1&o&&e.GkF(0)}function Xt(o,i){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function eo(o,i){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function to(o,i){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function oo(o,i){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}const no=function(){return["CUP "]},io=function(o,i,t,n){return{"bg-amber-50 text-amber-700":o,"bg-teal-50 text-teal-700":i,"bg-green-50 text-green-700":t,"bg-red-50 text-red-700":n}},ro=function(o){return[o]};function ao(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"div")(18,"button",44),e._UZ(19,"mat-icon",43),e.qZA(),e.TgZ(20,"mat-menu",null,45)(22,"button",46)(23,"div",47),e.YNc(24,Xt,1,1,"mat-icon",48),e.qZA(),e.TgZ(25,"span",49),e._uU(26,"Pendiente de Pago"),e.qZA()(),e.TgZ(27,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Parcialmente"))}),e.TgZ(28,"div",47),e.YNc(29,eo,1,1,"mat-icon",48),e.qZA(),e.TgZ(30,"span",49),e._uU(31,"Pagada Parcialmente"),e.qZA()(),e.TgZ(32,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Totalmente"))}),e.TgZ(33,"div",47),e.YNc(34,to,1,1,"mat-icon",48),e.qZA(),e.TgZ(35,"span",49),e._uU(36,"Pagada Totalmente"),e.qZA()(),e.TgZ(37,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.cancelInvoice(s))}),e.TgZ(38,"div",47),e.YNc(39,oo,1,1,"mat-icon",48),e.qZA(),e.TgZ(40,"span",49),e._uU(41,"Cancelada"),e.qZA()()()(),e.TgZ(42,"button",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteInvoice(s))}),e._UZ(43,"mat-icon",43),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit,n=e.MAs(21),r=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.quotationNo," "),e.xp6(2),e.hij(" ",e.xi3(8,23,r.getTotalAmount(t),e.DdM(26,no))," "),e.xp6(3),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Cancelada"===t.status?"Motivo: "+t.canceledReason:"")("ngClass",e.l5B(27,io,"Pendiente de Pago"===t.status,"Pagada Parcialmente"===t.status,"Pagada Totalmente"===t.status,"Cancelada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(32,ro,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(2),e.Q6J("matMenuTriggerFor",n)("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-list"),e.xp6(3),e.Q6J("disabled",!0),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pendiente de Pago")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Parcialmente")||t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Parcialmente")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Totalmente")),e.xp6(3),e.Q6J("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Cancelada")),e.xp6(3),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function so(o,i){if(1&o&&(e.ynx(0),e.YNc(1,ao,44,34,"ng-container",34),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const co=function(o){return{"pointer-events-none":o}},lo=function(){return[10,25,50,100]};function mo(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,Wt,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," N.Factura "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,so,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","quotationNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.invoices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,co,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,lo))("showFirstLastButtons",!0)}}const uo=function(o){return{"bg-amber-200 text-amber-900":o}},po=function(o){return{"bg-teal-200 text-teal-900":o}},go=function(o){return{"bg-green-200 text-green-900":o}},_o=function(o){return{"bg-red-200 text-red-900":o}};function fo(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",52)(1,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pendiente de Pago"!==r.filterInputControl.value?"Pendiente de Pago":""))}),e.TgZ(2,"span",54),e._uU(3,"Pendiente de Pago"),e.qZA(),e._UZ(4,"div",55),e.qZA(),e.TgZ(5,"button",56),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pagada Parcialmente"!==r.filterInputControl.value?"Pagada Parcialmente":""))}),e.TgZ(6,"span",54),e._uU(7,"Pagada Parcialmente"),e.qZA(),e._UZ(8,"div",57),e.qZA(),e.TgZ(9,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Pagada Totalmente"!==r.filterInputControl.value?"Pagada Totalmente":""))}),e.TgZ(10,"span",54),e._uU(11,"Pagada Totalmente"),e.qZA(),e._UZ(12,"div",59),e.qZA(),e.TgZ(13,"button",60),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Cancelada"!==r.filterInputControl.value?"Cancelada":""))}),e.TgZ(14,"span",54),e._uU(15,"Canceladas"),e.qZA(),e._UZ(16,"div",61),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(4,uo,"Pendiente de Pago"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(6,po,"Pagada Parcialmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(8,go,"Pagada Totalmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(10,_o,"Cancelada"===t.filterInputControl.value))}}function ho(o,i){if(1&o&&(e.TgZ(0,"div",62),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"No se han econtrado facturas":"No ha creado ninguna factura a\xfan!!")}}function xo(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Facturas "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,mo,21,16,"ng-container",19),e.YNc(29,fo,17,12,"ng-template",null,20,e.W1O),e.YNc(31,ho,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(30),r=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar facturas"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let vo=(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._invoiceService=s,this._snackBar=c,this.store=u,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new C.x}ngOnInit(){this.invoices$=this.store.select(Kt.vm),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._invoiceService.getInvoices(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._invoiceService.getInvoices(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._invoiceService.getInvoices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteInvoice(t){this._fuseConfirmationService.open({title:"Eliminar Factura",message:`\xbfEst\xe1 seguro que desea eliminar la factura # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._invoiceService.deleteInvoice(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}updateStatus(t,n){this._fuseConfirmationService.open({title:"Actualizar estado",message:`\xbfEst\xe1 seguro desea actualizar el estado de la factura # ${t.no} a ${n} `,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._invoiceService.updateStatus(t._id,n).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}cancelInvoice(t){this._dialog.open(se.g,{data:{title:"Cancelar Factura",message:`\xbfEst\xe1 seguro desea cancelar la factura # ${t.no}`,rejectedReason:t.canceledReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._invoiceService.updateStatus(t._id,H.Cancelada,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}getTotalAmount(t){return t.goodsData.map(n=>n.quantity).reduce((n,r)=>n+r,0)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(q.R),e.Y36(fe.x),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noInvoices",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","invoices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","invoices-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Cambiar estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],["listStatusMenu","matMenu"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled"],[1,"col-span-1"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"col-span-3"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-6","w-9/12","sm:w-4/12","md:w-full","lg:w-9/12","xl:w-8/12","flex","justify-around"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","hover:bg-amber-200","hover:text-amber-900",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-teal-700","transition-all","ease-in-out","delay-100","bg-teal-50","border-0","rounded-full","hover:bg-teal-200","hover:text-teal-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-teal-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","hover:bg-green-200","hover:text-green-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","hover:bg-red-200","hover:text-red-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,xo,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.invoices$))},dependencies:[m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,U.PQ,k.lW,b.Hw,p.KE,p.qo,A.Nt,ce.VK,ce.OP,ce.p6,T.NW,h.YE,h.nU,te.gM,m.Ov,m.H9],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})();var he=l(2567);const xe=o=>o.paymentMethods,ve=((0,_.P1)(xe,o=>o.paymentMethod),(0,_.P1)(xe,o=>o.paymentMethods));class be{}var le=l(8721),bo=l(7446),Ze=l(9814);function Zo(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar forma de pago"),e.qZA())}function Co(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar forma de pago "),e.qZA())}function yo(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del forma de pago"),e.qZA())}function To(o,i){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.paymentMethod.name||"Sin nombre")}}function Io(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function qo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre debe contener entre 3 y 255 caracteres. "),e.qZA())}function ko(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Porciento"),e.qZA())}function Ao(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El porciento es obligatorio "),e.qZA())}function wo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function Qo(o,i){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.get("percent").getError("outOfRange")," ")}}function Uo(o,i){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Descripci\xf3n"),e.qZA())}function Fo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n es obligatoria "),e.qZA())}function Jo(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n debe contener entre 3 y 1000 caracteres. "),e.qZA())}function So(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",45)(2,"button",46),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,s=e.oxw(2);return e.KtG(s.removeTermField(r))}),e._UZ(3,"mat-icon",25),e.qZA()(),e.BQk()}2&o&&(e.xp6(3),e.Q6J("svgIcon","heroicons_solid:trash"))}function Po(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38)(2,"mat-form-field",39),e.YNc(3,ko,2,0,"mat-label",6),e.TgZ(4,"span",40),e._uU(5,"%"),e.qZA(),e.TgZ(6,"input",41),e.NdJ("blur",function(r){const c=e.CHM(t).index,u=e.oxw(2);return e.KtG(u.checkOutOfRange(r.target.value,c))}),e.qZA(),e.YNc(7,Ao,2,0,"mat-error",6),e.YNc(8,wo,2,0,"mat-error",6),e.YNc(9,Qo,2,1,"mat-error",6),e.qZA(),e.TgZ(10,"mat-form-field",42),e.YNc(11,Uo,2,0,"mat-label",6),e._UZ(12,"mat-icon",43)(13,"textarea",44),e.YNc(14,Fo,2,0,"mat-error",6),e.YNc(15,Jo,2,0,"mat-error",6),e.qZA(),e.YNc(16,So,4,1,"ng-container",6),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,n=i.first,r=i.last;e.xp6(3),e.Q6J("ngIf",n),e.xp6(3),e.Q6J("formControl",t.get("percent"))("spellcheck",!1),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("min")||t.get("percent").hasError("max")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("outOfRange")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControl",t.get("description"))("placeholder","Descripci\xf3n")("minLength",3)("maxLength",1e3),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("maxlength")||t.get("description").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",!(n&&r))}}function Do(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",9)(2,"form",16)(3,"div",17)(4,"mat-form-field",18)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",19),e.YNc(8,Io,2,0,"mat-error",6),e.YNc(9,qo,2,0,"mat-error",6),e.qZA()(),e.TgZ(10,"div",20)(11,"span",21),e._uU(12,"T\xe9rminos"),e.qZA(),e.TgZ(13,"div",22),e.YNc(14,Po,17,15,"ng-container",23),e.qZA(),e.TgZ(15,"div",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addTermField())}),e._UZ(16,"mat-icon",25),e.TgZ(17,"span",26),e._uU(18,"Agregar t\xe9rmino"),e.qZA()()(),e.TgZ(19,"div",27)(20,"span",21),e._uU(21,"Pagos"),e.qZA(),e.TgZ(22,"div",28)(23,"mat-checkbox",29),e._uU(24),e.ALo(25,"uppercase"),e.qZA(),e.TgZ(26,"mat-radio-group",30)(27,"mat-radio-button",31),e._uU(28,"Ninguno"),e.qZA(),e.TgZ(29,"mat-radio-button",32),e._uU(30,"Pagos por ATHENDAT"),e.qZA(),e.TgZ(31,"mat-radio-button",33),e._uU(32),e.ALo(33,"uppercase"),e.qZA()()(),e._UZ(34,"div",34),e.qZA(),e.TgZ(35,"div",35)(36,"span",36),e._uU(37,"Estado"),e.qZA(),e.TgZ(38,"mat-slide-toggle",37),e._uU(39),e.qZA()()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.paymentMethodForm)("autocomplete","off"),e.xp6(5),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del forma de pago"),e.xp6(1),e.Q6J("ngIf",t.paymentMethodForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.paymentMethodForm.get("name").hasError("maxlength")||t.paymentMethodForm.get("name").hasError("minlength")),e.xp6(5),e.Q6J("ngForOf",t.paymentMethodForm.get("terms").controls)("ngForTrackBy",t.trackByFn),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:plus-circle"),e.xp6(7),e.Q6J("color","primary")("formControlName","includeBankAccount"),e.xp6(1),e.hij(" Incluir la cuenta bancaria de ",e.lcZ(25,21,t.currentMerchant.name),""),e.xp6(2),e.Q6J("color","primary")("formControlName","paymentBy"),e.xp6(6),e.hij("Pagos por QRs de ",e.lcZ(33,23,t.currentMerchant.name),""),e.xp6(6),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.paymentMethodForm.get("active").value?"Activo":"Inactivo"," ")}}const Ce=function(o){return{"cursor-not-allowed":o}};function No(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.updatePaymentMethod())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value)("ngClass",e.VKq(4,Ce,t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value))}}function Mo(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.createPaymentMethod())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value)("ngClass",e.VKq(4,Ce,t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value))}}function Ro(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",47),e.ynx(2),e.TgZ(3,"button",48),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,No,3,6,"ng-container",6),e.YNc(6,Mo,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Eo=(()=>{class o{constructor(t,n,r,s,c,u,I){this.data=t,this._changeDetectorRef=n,this._formBuilder=r,this._fuseConfirmationService=s,this._paymentMethodsService=c,this._snackBar=u,this.store=I,this.paymentMethod=new be,this.dialogMode="view",this.merchants=[],this.selectedMerchant$=null,this.user=null,this.user$=(0,S.of)(null),this.totalPercent=0,this._unsubscribeAll=new C.x}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(oe.Qs).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.paymentMethodForm=this._formBuilder.group({_id:[""],active:[!0,[a.kI.required]],userId:[this.user._id,[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],paymentBy:["none",[a.kI.required]],includeBankAccount:[!0],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],terms:this._formBuilder.array([])}),"edit"===this.data.dialogMode&&(this.paymentMethodForm.patchValue(this.data.paymentMethod),this.paymentMethodForm.get("merchantId").setValue(this.data.paymentMethod.merchantId._id)),this.setTermsDataOnForm()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addTermField(){const t=this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(1e3)]]}),n=this.paymentMethodForm.get("terms");n.length<=6&&n.push(t),this._changeDetectorRef.markForCheck()}removeTermField(t){this.paymentMethodForm.get("terms").removeAt(t),this.totalPercent=this.paymentMethodForm.get("terms").getRawValue().map(r=>r.percent).reduce((r,s)=>r+s,0),this._changeDetectorRef.markForCheck()}createPaymentMethod(){if(100!==this.totalPercent||this.paymentMethodForm.invalid)return;let t=this.paymentMethodForm.getRawValue();t=(0,ae.Z)(t,"_id"),t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentMethodsService.createPaymentMethod(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updatePaymentMethod(){if(100!==this.totalPercent||this.paymentMethodForm.invalid)return;const t=this.paymentMethodForm.getRawValue();t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentMethodsService.updatePaymentMethod(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}checkOutOfRange(t,n){if(+t<=100){const r=this.paymentMethodForm.get("terms").getRawValue().map(c=>c.percent).reduce((c,u)=>c+u,0),s=this.paymentMethodForm.get("terms").controls;r<=100&&s.forEach(c=>{c.get("percent").hasError("outOfRange")&&c.get("percent").setErrors(null)}),r>100&&s.at(n).get("percent").setErrors({outOfRange:"La suma del % de todos los t\xe9rminos no debe superar a 100"}),this.totalPercent=r}}trackByFn(t,n){return n.id||t}setTermsDataOnForm(){if("add"===this.data.dialogMode)return void this.addTermField();const t=[];this.data.paymentMethod.terms.length>0?this.data.paymentMethod.terms.forEach(n=>{t.push(this._formBuilder.group({percent:[n.percent,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:[n.description,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]}))}):t.push(this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]})),t.forEach(n=>{this.paymentMethodForm.get("terms").push(n)}),this.totalPercent=this.paymentMethodForm.get("terms").getRawValue().map(n=>n.percent).reduce((n,r)=>n+r,0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(q.R),e.Y36(le.o),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["paymentMethods-detail"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"pt-5"],[1,"w-full"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"mt-4"],[1,"text-gray-400"],[1,"border-t-2","p-6","pb-0"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","items-center","px-4","-ml-4","mt-2","rounded","cursor-pointer","group",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"mt-6"],[1,"border-t-2","p-6","pt-7","pb-7","grid","sm:grid-cols-2","gap-4"],[1,"mb-4",3,"color","formControlName"],["aria-label","Select an option",1,"sm:col-span-2","flex","flex-wrap","justify-between","gap-2",3,"color","formControlName"],["value","none",1,"sm:col-span-1"],["value","UseAthendatPayments",1,"sm:col-span-1","truncate"],["value","UseMerchantPayments",1,"sm:col-span-1"],[1,"border-t-2","w-full"],[1,"flex","flex-col","mt-8"],[1,"font-medium"],[1,"mt-1","sm:mt-3",3,"formControlName","color"],[1,"flex","flex-col","sm:flex-row"],[1,"flex-auto","mt-2","sm:max-w-[20%]"],["matPrefix",""],["matInput","","type","number","min","0","max","100","required","",3,"formControl","spellcheck","blur"],[1,"flex-auto","w-full","mt-2","sm:ml-4","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"formControl","placeholder","minLength","maxLength"],[1,"flex","sm:items-center","mb-2","self-end","w-10","sm:pl-2"],["mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","min-h-8",3,"click"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Zo,2,0,"h2",2),e.YNc(4,Co,2,0,"h2",2),e.YNc(5,yo,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,To,9,1,"div",4),e.BQk(),e.ynx(9),e.YNc(10,Do,40,25,"div",5),e.BQk(),e.qZA(),e.YNc(11,Ro,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.paymentMethod._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentMethod._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentMethod._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,k.lW,bo.oG,v.ZT,b.Hw,p.TO,p.KE,p.hX,p.qo,A.Nt,Ze.VQ,Ze.U0,re.Rr,te.gM,m.gd],encapsulation:2,changeDetection:0}),o})();function Yo(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",39),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Bo(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",40),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Lo(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33)(2,"div",34),e._uU(3),e.qZA(),e.TgZ(4,"div",35),e.YNc(5,Yo,2,1,"ng-container",30),e.YNc(6,Bo,2,1,"ng-container",30),e.qZA(),e.TgZ(7,"div",36)(8,"button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.editPaymentMethod(s))}),e._UZ(9,"mat-icon",38),e.qZA(),e.TgZ(10,"button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deletePaymentMethod(s._id))}),e._UZ(11,"mat-icon",38),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Oo(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Lo,12,5,"ng-container",32),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const zo=function(o){return{"pointer-events-none":o}},jo=function(){return[10,25,50,100]};function Go(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26)(3,"div",27),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div",28),e._uU(6," Activo "),e.qZA(),e.TgZ(7,"div",29),e._uU(8," Acciones "),e.qZA()(),e.YNc(9,Oo,2,2,"ng-container",30),e.ALo(10,"async"),e._UZ(11,"mat-paginator",31),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name")("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(10,10,t.paymentMethods$)),e.xp6(2),e.Q6J("ngClass",e.VKq(12,zo,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,jo))("showFirstLastButtons",!0)}}function $o(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Go,12,15,"ng-container",23),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Ho(o,i){if(1&o&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl?"No se han encontrado formas de pago":"No ha creado ninguna forma de pago a\xfan!")}}let Vo=(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._paymentMethodService=n,this._dialog=r,this._fuseConfirmationService=s,this._snackBar=c,this.store=u,this.merchantId="",this.paymentMethods$=(0,S.of)([]),this.paymentMethod=new be,this.isLoading=!1,this.searchInputControl=new a.NI(""),this._unsubscribeAll=new C.x}ngOnInit(){this.paymentMethods$=this.store.select(ve),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._paymentMethodService.getPaymentMethods(0,20,"active","desc",t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._paymentMethodService.getPaymentMethods(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createPaymentMethod(){this._openDialog(this.paymentMethod,"add")}editPaymentMethod(t){this._openDialog(t,"edit")}deletePaymentMethod(t){this._fuseConfirmationService.open({title:"Eliminar Forma de pago",message:"\xbfEsta seguro que desea Eliminar el Forma de pago? Perder\xe1 el acceso a todos los datos asociados al mismo.",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._paymentMethodService.deletePaymentMethod(t,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}_openDialog(t,n){this._dialog.open(Eo,{data:{paymentMethod:t,dialogMode:n},panelClass:"ath-payment-method-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(le.o),e.Y36(v.uw),e.Y36(q.R),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-paymentMethods"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:38,vars:13,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto","overflow-x-auto","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:ml-4"],[1,"mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"ml-4","mt-4","sm:mt-0","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[4,"ngIf","ngIfElse"],["noPaymentMethods",""],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","payment-methods-table"],[3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"text-center","mr-4","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","md:px-8","payment-methods-table"],[1,"truncate"],[1,"text-center","sm:mr-4"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Formas de pago"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Formas de Pago "),e.qZA()()(),e.TgZ(24,"div",14)(25,"mat-form-field",15),e._UZ(26,"mat-icon",16)(27,"input",17),e.qZA(),e.TgZ(28,"button",18),e.NdJ("click",function(){return n.createPaymentMethod()}),e._UZ(29,"mat-icon",19),e.TgZ(30,"span",20),e._uU(31,"Nueva"),e.qZA()()()(),e.TgZ(32,"div",21)(33,"div",22),e.YNc(34,$o,2,2,"ng-container",23),e.ALo(35,"async"),e.YNc(36,Ho,2,1,"ng-template",null,24,e.W1O),e.qZA()()()),2&t){const r=e.MAs(37);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar formas de pago"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(35,11,n.paymentMethods$))("ngIfElse",r)}},dependencies:[g.yS,m.mk,m.sg,m.O5,a.Fj,a.JJ,a.oH,U.PQ,k.lW,b.Hw,p.KE,p.qo,A.Nt,T.NW,h.YE,h.nU,m.Ov],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})(),Ko=(()=>{class o{constructor(t){this._paymentMethodsService=t}resolve(t,n){return this._paymentMethodsService.getPaymentMethods(0,20,"name","asc","")}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(le.o))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Wo=l(5453);const Xo=function(){return["../"]};let en=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-details-header"]],decls:28,vars:6,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"w-full"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la oferta"),e.qZA()()()(),e._UZ(25,"div",14),e.qZA(),e.TgZ(26,"div",15),e._UZ(27,"quotation-details"),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("routerLink",e.DdM(5,Xo)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"))},dependencies:[g.yS,U.PQ,b.Hw,Wo.i],encapsulation:2,changeDetection:0}),o})();var tn=l(6861),on=l(1494);function nn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 30. "),e.qZA())}const rn=function(o){return{"cursor-not-allowed":o}};let an=(()=>{class o{constructor(t,n,r,s,c,u){this.data=t,this._formBuilder=n,this._dialogRef=r,this._invoiceService=s,this._snackBar=c,this.store=u,this.selectedQuotation=null,this.user$=(0,S.of)(null),this._unsubscribeAll=new C.x,this.selectedQuotation=t.quotation}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t}),this.invoiceForm=this._formBuilder.group({merchantId:[this.selectedQuotation.merchantId._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],quotationId:[this.selectedQuotation._id,[a.kI.required]],quotationNo:[{disabled:!0,value:this.selectedQuotation.no},[a.kI.required]],expirationDays:[this.selectedQuotation.merchantId.commercialManagement.expirationInvoiceDays,[a.kI.required,a.kI.min(1),a.kI.max(30)]],bankAccount:["",[a.kI.minLength(16),a.kI.maxLength(24)]],status:[H.PendientePago,[a.kI.required]],paymentMethodData:[null,[a.kI.required]]}),this.invoiceForm.get("paymentMethodData").setValue(this.selectedQuotation.paymentMethodData),this.selectedQuotation.paymentMethodData.includeBankAccount&&this.invoiceForm.get("bankAccount").setValue(this.selectedQuotation.merchantId.bankAccount)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){let t=this.invoiceForm.getRawValue();t=Object.assign(Object.assign({},t),{goodsData:this.selectedQuotation.goodsData}),this._invoiceService.createInvoice(t).subscribe(n=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),console.log({quotation:Object.assign(Object.assign({},this.selectedQuotation),{status:"Facturada"})}),this.store.dispatch((0,on.qm)({quotation:Object.assign(Object.assign({},this.selectedQuotation),{status:"Facturada"})})),this._dialogRef.close()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(a.qu),e.Y36(v.so),e.Y36(fe.x),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoice-conform-dialog"]],decls:29,vars:15,consts:[[1,"ng-star-inserted","h-full"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"h-full","flex","items-center"],[1,"block","w-full"],[1,"flex","flex-col","sm:flex-row","flex-auto","items-center","sm:items-start","p-8","pb-4","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","flex-0","items-center","justify-center","w-10","h-10","sm:mr-4","rounded-full","text-blue-600","bg-blue-100","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"mat-icon","notranslate","text-current","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","sm:items-start","mt-4","sm:mt-0","sm:pr-8","space-y-1","text-center","sm:text-left","ng-star-inserted"],[1,"text-xl","leading-6","font-medium","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pr-8","pl-8","mt-10","sm:mt-0","sm:pl-22","pb-6",3,"formGroup","autocomplete"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"flex","flex-wrap","tems-center","justify-center","md:justify-end","px-6","py-4","space-x-3","bg-gray-50","dark:bg-black","dark:bg-opacity-10","ng-star-inserted"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","","mat-button","",3,"color","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8),e.qZA()()(),e.kcU(),e.TgZ(9,"div",9)(10,"div",10),e._uU(11),e.qZA(),e.TgZ(12,"div",11),e._uU(13),e.qZA()()(),e.TgZ(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),e._uU(18,"Expira en"),e.qZA(),e.TgZ(19,"span",14),e._uU(20,"D\xedas"),e.qZA(),e._UZ(21,"mat-icon",15)(22,"input",16),e.YNc(23,nn,2,0,"mat-error",17),e.qZA()()()()(),e.TgZ(24,"div",18)(25,"button",19),e._uU(26,"Cancelar"),e.qZA(),e.TgZ(27,"button",20),e.NdJ("click",function(){return n.createInvoice()}),e._uU(28," Aceptar "),e.qZA()()()()),2&t&&(e.xp6(11),e.Oqu(n.data.title),e.xp6(2),e.Oqu(n.data.message),e.xp6(1),e.Q6J("formGroup",n.invoiceForm)("autocomplete","off"),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",30),e.xp6(1),e.Q6J("ngIf",n.invoiceForm.get("expirationDays").hasError("min")||n.invoiceForm.get("expirationDays").hasError("max")),e.xp6(2),e.Q6J("matDialogClose",!0),e.xp6(2),e.Q6J("color","primary")("disabled",n.invoiceForm.invalid)("ngClass",e.VKq(13,rn,n.invoiceForm.invalid)))},dependencies:[m.mk,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.qQ,a.Fd,a.sg,a.u,k.lW,v.ZT,b.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,A.Nt],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})();var ye=l(7871);function sn(o,i){1&o&&e.GkF(0)}const cn=function(){return["CUP "]},ln=function(o,i,t,n){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":i,"bg-green-50 text-green-700":t,"bg-red-50 text-red-700":n}},mn=function(o){return[o]};function dn(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.rejectQuotation(s))}),e._UZ(18,"mat-icon",43),e.qZA(),e.TgZ(19,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.conformInvoice(s))}),e._UZ(20,"mat-icon",43),e.qZA(),e.TgZ(21,"button",46),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteQuotation(s))}),e._UZ(22,"mat-icon",43),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.requestNo," "),e.xp6(2),e.hij(" ",e.xi3(8,16,n.getTotalAmount(t),e.DdM(19,cn))," "),e.xp6(3),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.l5B(20,ln,"Nueva"===t.status,"Aceptada"===t.status,"Facturada"===t.status,"Rechazada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(25,mn,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Nueva")&&!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-copy"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-check"),e.xp6(1),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Nueva")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function un(o,i){if(1&o&&(e.ynx(0),e.YNc(1,dn,23,27,"ng-container",34),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const pn=function(o){return{"pointer-events-none":o}},gn=function(){return[10,25,50,100]};function _n(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,sn,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," N.Oferta "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,un,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","requestNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.quotations$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,pn,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,gn))("showFirstLastButtons",!0)}}const fn=function(o){return{"bg-amber-200 text-amber-900":o}},hn=function(o){return{"bg-blue-200 text-blue-900":o}},xn=function(o){return{"bg-green-200 text-green-900":o}},vn=function(o){return{"bg-red-200 text-red-900":o}};function bn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Nueva"!==r.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",49),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",50),e.qZA(),e.TgZ(5,"button",51),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Aceptada"!==r.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",49),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",52),e.qZA(),e.TgZ(9,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Facturada"!==r.filterInputControl.value?"Facturada":""))}),e.TgZ(10,"span",49),e._uU(11,"Facturadas"),e.qZA(),e._UZ(12,"div",54),e.qZA(),e.TgZ(13,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Rechazada"!==r.filterInputControl.value?"Rechazada":""))}),e.TgZ(14,"span",49),e._uU(15,"Rechazadas"),e.qZA(),e._UZ(16,"div",56),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(4,fn,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(6,hn,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(8,xn,"Facturada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(10,vn,"Rechazada"===t.filterInputControl.value))}}function Zn(o,i){if(1&o&&(e.TgZ(0,"div",57),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"No se han econtrado ofertas":"No ha creado ninguna oferta a\xfan!!")}}function Cn(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Ofertas "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,_n,21,16,"ng-container",19),e.YNc(29,bn,17,12,"ng-template",null,20,e.W1O),e.YNc(31,Zn,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(30),r=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar ofertas"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let yn=(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._quotationService=s,this._snackBar=c,this.store=u,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new C.x}ngOnInit(){this.quotations$=this.store.select(tn.uy),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._quotationService.getQuotations(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._quotationService.getQuotations(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._quotationService.getQuotations(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteQuotation(t){this._fuseConfirmationService.open({title:"Eliminar Oferta",message:`\xbfEst\xe1 seguro que desea eliminar la oferta # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._quotationService.deleteQuotation(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectQuotation(t){this._dialog.open(se.g,{data:{title:"Rechazar Oferta",message:`\xbfEst\xe1 seguro desea Rechazar la oferta # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._quotationService.rejectQuotation(t._id,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}conformInvoice(t){this._dialog.open(an,{data:{title:"Generar Factura",message:`\xbfEst\xe1 seguro que desea generar una factura para la oferta # ${t.no}?`,quotation:t},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"})}getTotalAmount(t){return t.goodsData.map(n=>n.quantity).reduce((n,r)=>n+r,0)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(q.R),e.Y36(ye.D),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-quotations"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noQuotations",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","quotations-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-10","mr-6","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","quotations-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["matTooltip","Rechazar Oferta","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["matTooltip","Generar Factura","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-6","w-9/12","md:w-8/12","lg:w-8/12","xl:w-[54%]","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-200","hover:text-amber-900",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-200","hover:text-blue-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","hover:bg-green-200","hover:text-green-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-200","hover:text-red-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,Cn,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.quotations$))},dependencies:[m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,U.PQ,k.lW,b.Hw,p.KE,p.qo,A.Nt,T.NW,h.YE,h.nU,te.gM,m.Ov,m.H9],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})();var Te=l(9641),Tn=l(2627);let In=(()=>{class o{constructor(){}ngOnInit(){}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["request-details-header"]],decls:28,vars:4,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/request",1,"ml-1","text-primary-500","hover:underline"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"w-full"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la solicitud"),e.qZA()()()(),e._UZ(25,"div",14),e.qZA(),e.TgZ(26,"div",15),e._UZ(27,"request-details"),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"))},dependencies:[g.yS,U.PQ,b.Hw,Tn.d],encapsulation:2,changeDetection:0}),o})();var qn=l(4899),Ie=l(2440),kn=l(2454),qe=l(7205),Z=l(8279);function An(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",27),e._uU(2),e.qZA(),e.BQk()),2&o){const t=i.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("value",n.transformPaymentMethod(t)),e.xp6(1),e.hij(" ",t.name," ")}}function wn(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El m\xe9todo de pago es obligatoria. "),e.qZA())}function Qn(o,i){if(1&o&&(e.TgZ(0,"mat-form-field",6)(1,"mat-label"),e._uU(2,"M\xe9todo de pago"),e.qZA(),e._UZ(3,"mat-icon",8),e.TgZ(4,"mat-select",25),e.YNc(5,An,3,2,"ng-container",26),e.qZA(),e.YNc(6,wn,2,0,"mat-error",10),e.qZA()),2&o){const t=i.ngIf,n=e.oxw();e.xp6(3),e.Q6J("svgIcon","heroicons_solid:credit-card"),e.xp6(1),e.Q6J("formControlName","paymentMethodData"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("paymentMethodData").hasError("required"))}}function Un(o,i){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 30. "),e.qZA())}const Fn=function(o){return{"text-center pl-8  md:pl-0":o}};function Jn(o,i){if(1&o&&(e.TgZ(0,"th",32),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.Q6J("ngClass",e.VKq(2,Fn,"name"!==t)),e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}const Sn=function(o){return{"text-center":o}};function Pn(o,i){if(1&o&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&o){const t=i.$implicit,n=e.oxw(2).$implicit;e.Q6J("ngClass",e.VKq(2,Sn,"name"!==n)),e.xp6(1),e.hij(" ",t[n]," ")}}function Dn(o,i){1&o&&(e.TgZ(0,"span"),e._uU(1,"Total"),e.qZA())}const Nn=function(o,i){return{"text-center":o,truncate:i}};function Mn(o,i){if(1&o&&(e.TgZ(0,"td",34),e.YNc(1,Dn,2,0,"span",10),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.Q6J("ngClass",e.WLB(2,Nn,"name"!==t,"name"===t)),e.xp6(1),e.Q6J("ngIf","name"===t)}}function Rn(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,Jn,2,4,"th",29),e.YNc(2,Pn,2,4,"td",30),e.YNc(3,Mn,2,5,"td",31),e.qZA())}function En(o,i){if(1&o&&(e.TgZ(0,"th",38),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}function Yn(o,i){if(1&o&&(e.TgZ(0,"span",42),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t[n],"")}}function Bn(o,i){if(1&o&&(e.TgZ(0,"div",42)(1,"mat-form-field",43),e._UZ(2,"input",44),e.qZA()()),2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("formControl",n.amountFormControl)("min",0)("max",n.getOldGoodsAmountById(t.goodsId))}}function Ln(o,i){if(1&o&&(e.TgZ(0,"td",39)(1,"div",40),e.YNc(2,Yn,2,1,"span",41),e.YNc(3,Bn,3,3,"div",41),e.qZA()()),2&o){const t=i.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}function On(o,i){1&o&&e._UZ(0,"td",45)}function zn(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,En,2,1,"th",35),e.YNc(2,Ln,4,2,"td",36),e.YNc(3,On,1,0,"td",37),e.qZA())}function jn(o,i){1&o&&(e.TgZ(0,"th",49),e._uU(1," Acciones "),e.qZA())}function Gn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(r.goodsId,-1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("disabled",0===t.amount),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:minus-sm")}}function $n(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(r.goodsId,1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("disabled",t.amount===n.getOldGoodsAmountById(t.goodsId)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-sm")}}function Hn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(r))}),e._UZ(1,"mat-icon",56),e.qZA()}2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt"))}function Vn(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(r))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("color","primary")("disabled",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)&&n.amountFormControl.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt")}}function Kn(o,i){if(1&o&&(e.TgZ(0,"td",50)(1,"div",51),e.YNc(2,Gn,2,2,"button",52),e.YNc(3,$n,2,2,"button",52),e.YNc(4,Hn,2,1,"button",53),e.YNc(5,Vn,2,3,"button",54),e.qZA()()),2&o){const t=i.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}const Wn=function(){return["CUP "]};function Xn(o,i){if(1&o&&(e.TgZ(0,"td",59),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.xi3(2,1,t.getTotalQuantity(),e.DdM(4,Wn))," ")}}function ei(o,i){1&o&&(e.TgZ(0,"div"),e.YNc(1,jn,2,0,"th",46),e.YNc(2,Kn,6,4,"td",47),e.YNc(3,Xn,3,5,"td",48),e.qZA())}function ti(o,i){if(1&o&&(e.ynx(0,28),e.YNc(1,Rn,4,0,"div",10),e.YNc(2,zn,4,0,"div",10),e.YNc(3,ei,4,0,"div",10),e.BQk()),2&o){const t=i.$implicit;e.s9C("matColumnDef",t),e.xp6(1),e.Q6J("ngIf","actions"!==t&&"amount"!==t),e.xp6(1),e.Q6J("ngIf","amount"===t),e.xp6(1),e.Q6J("ngIf","actions"===t)}}function oi(o,i){1&o&&e._UZ(0,"tr",60)}function ni(o,i){1&o&&e._UZ(0,"tr",61)}function ii(o,i){1&o&&e._UZ(0,"tr",62)}const ri=function(o){return{"cursor-not-allowed":o}};let ai=(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._formBuilder=n,this._fuseConfirmationService=r,this._quotationsService=s,this._snackBar=c,this.store=u,this.selectedRequest=null,this.reject=new e.vpe,this.isQuotationCreated=new e.vpe,this.user$=(0,S.of)(null),this.selectedGoodDataToEdit=null,this.amountFormControl=new a.NI(0),this.paymentMethods$=(0,S.of)(null),this.displayedColumns=["name","type","uom","amount","price","quantity","actions"],this._unsubscribeAll=new C.x,this.amountFormControl.setValidators([a.kI.required])}ngOnInit(){this.goodsData=(0,K.cloneDeep)(this.selectedRequest.goodsData),this.user$=this.store.select(L.rk),this.user$.pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.paymentMethods$=this.store.select(ve),this.quotationForm=this._formBuilder.group({merchantId:[this.selectedRequest.merchantId._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],requestId:[this.selectedRequest._id,[a.kI.required]],requestNo:[{disabled:!0,value:this.selectedRequest.no},[a.kI.required]],expirationDays:[this.selectedRequest.merchantId.commercialManagement.expirationQuotationDays,[a.kI.required,a.kI.min(1),a.kI.max(30)]],status:[qe.qm.Nueva,[a.kI.required]],description:["",[a.kI.maxLength(1e3)]],paymentMethodData:[null,[a.kI.required]]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createQuotation(){let t=this.quotationForm.getRawValue();t=Object.assign(Object.assign({},t),{goodsData:this.goodsData}),this._fuseConfirmationService.open({title:"Crear Oferta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._quotationsService.createQuotation(t).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.isQuotationCreated.next(this.selectedRequest)}),this._changeDetectorRef.markForCheck()})}transformPaymentMethod(t){return new qe.R8(t)}getTotalQuantity(){return this.goodsData.map(t=>t.quantity).reduce((t,n)=>t+n,0)}getFieldsTableHeaderNames(t){switch(t){case"name":return"Nombre";case"uom":return"U.M";case"amount":return"Cantidad";case"price":return"Precio";case"quantity":return"Total unitario";case"type":return"Tipo"}}operation(t,n){const r=this.goodsData.find(s=>s.goodsId===t);r.amount=r.amount+n,r.quantity=r.amount*r.price}getOldGoodsAmountById(t){return this.selectedRequest.goodsData.find(n=>n.goodsId===t).amount}toggleToEditGoods(t){if(this.selectedGoodDataToEdit&&this.selectedGoodDataToEdit.goodsId===t.goodsId){const r=this.amountFormControl.value;this.amountFormControl.clearValidators();const s=this.goodsData.find(c=>c.goodsId===t.goodsId);return s.amount=r,s.quantity=s.amount*s.price,this.amountFormControl.clearValidators(),void(this.selectedGoodDataToEdit=null)}const n=this.selectedRequest.goodsData.find(r=>r.goodsId===t.goodsId);this.amountFormControl.setValidators([a.kI.required,a.kI.min(0),a.kI.max(n.amount)]),this.amountFormControl.setValue(t.amount),this.selectedGoodDataToEdit=t}triggerReject(){this.reject.next(this.selectedRequest)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(a.qu),e.Y36(q.R),e.Y36(ye.D),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-conform"]],inputs:{selectedRequest:"selectedRequest"},outputs:{reject:"reject",isQuotationCreated:"isQuotationCreated"},decls:36,vars:25,consts:[[1,"shadow-lg","overflow-hidden"],[1,"flex","flex-col","justify-between","order-b"],[1,"p-4","sm:p-10","flex","flex-col","space-y-1","w-full"],[1,"grid","w-full","grid-cols-4","gap-y-1","gap-x-6",3,"formGroup"],[1,"col-span-1"],["class","w-full",4,"ngIf"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matInput","","matTextareaAutosize","",1,"h-4","min-h-4","max-h-20",3,"formControlName","rows","spellcheck","maxlength"],[1,"flex","flex-col","col-span-4"],[1,"font-medium"],["tabindex","0",1,"mt-2","overflow-auto","max-h-80","rounded-md",2,"box-shadow","0 0 3px 0 rgb(0 0 0 / 10%), 0 1px 2px -1px rgb(0 0 0 / 10%) !important"],["mat-table","",1,"w-full",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","font-medium",4,"matFooterRowDef"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"color","disabled","ngClass","click"],["required","",3,"formControlName"],[4,"ngFor","ngForOf"],[3,"value"],[3,"matColumnDef"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-footer-cell","",3,"ngClass",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0",3,"ngClass"],["mat-cell","",3,"ngClass"],["mat-footer-cell","",3,"ngClass"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0 text-center pl-8  md:pl-0",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-center",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0","text-center","pl-8","md:pl-0"],["mat-cell","",1,"text-center"],[1,"flex","justify-center"],["class","w-24",4,"ngIf"],[1,"w-24"],[1,"w-full","fuse-mat-no-subscript"],["type","number","matInput","","required","",3,"formControl","min","max"],["mat-footer-cell","",1,"text-center"],["mat-header-cell","","class","text-center pr-8 pl-8 md:pr-6 md:pl-0",4,"matHeaderCellDef"],["style","width: 120px;","mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-end",4,"matFooterCellDef"],["mat-header-cell","",1,"text-center","pr-8","pl-8","md:pr-6","md:pl-0"],["mat-cell","",1,"text-center",2,"width","120px"],[1,"flex","justify-center","space-x-2",2,"width","120px"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"disabled","click",4,"ngIf"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"click",4,"ngIf"],["class","min-h-7 h-7 px-2 leading-6","mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],["mat-flat-button","",1,"min-h-7","h-7","px-2","leading-6",3,"color","disabled","click"],["mat-footer-cell","",1,"text-end"],["mat-header-row",""],["mat-row",""],["mat-footer-row","",1,"font-medium"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4),e.YNc(5,Qn,7,4,"mat-form-field",5),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"div",4)(8,"mat-form-field",6)(9,"mat-label"),e._uU(10,"Expira en"),e.qZA(),e.TgZ(11,"span",7),e._uU(12,"D\xedas"),e.qZA(),e._UZ(13,"mat-icon",8)(14,"input",9),e.YNc(15,Un,2,0,"mat-error",10),e.qZA()(),e.TgZ(16,"div",11)(17,"mat-form-field",12)(18,"mat-label"),e._uU(19,"Descripci\xf3n"),e.qZA(),e._UZ(20,"mat-icon",8)(21,"textarea",13),e.qZA()()(),e.TgZ(22,"div",14)(23,"mat-label",15),e._uU(24,"Productos y servicios"),e.qZA(),e.TgZ(25,"div",16)(26,"table",17),e.YNc(27,ti,4,4,"ng-container",18),e.YNc(28,oi,1,0,"tr",19),e.YNc(29,ni,1,0,"tr",20),e.YNc(30,ii,1,0,"tr",21),e.qZA()()()(),e.TgZ(31,"div",22)(32,"button",23),e.NdJ("click",function(){return n.triggerReject()}),e._uU(33," Rechazar Solicitud "),e.qZA(),e.TgZ(34,"button",24),e.NdJ("click",function(){return n.createQuotation()}),e._uU(35," Conformar Oferta "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",n.quotationForm),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,21,n.paymentMethods$)),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",30),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("expirationDays").hasError("min")||n.quotationForm.get("expirationDays").hasError("max")),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(5),e.Q6J("dataSource",n.goodsData),e.xp6(1),e.Q6J("ngForOf",n.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",n.displayedColumns),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("disabled",n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotalQuantity())("ngClass",e.VKq(23,ri,n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotalQuantity())))},dependencies:[m.mk,m.sg,m.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,W.ey,k.lW,b.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,A.Nt,ie.gD,Z.BZ,Z.fO,Z.as,Z.w1,Z.Dz,Z.nj,Z.mD,Z.Ke,Z.ge,Z.ev,Z.yh,Z.XQ,Z.Gk,Z.Q2,m.Ov,m.H9],encapsulation:2,changeDetection:0}),o})();function si(o,i){1&o&&e.GkF(0)}function ci(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"quotation-conform",46),e.NdJ("reject",function(r){e.CHM(t);const s=e.oxw(5);return e.KtG(s.rejectRequest(r))})("isQuotationCreated",function(r){e.CHM(t);const s=e.oxw(5);return e.KtG(s.getRequestById(r))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("selectedRequest",t)}}const li=function(){return["CUP "]},mi=function(o,i,t){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":i,"bg-red-50 text-red-700":t}},di=function(o){return[o]};function ui(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.toggleDetails(s))}),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"button",44),e._UZ(18,"mat-icon",43),e.qZA(),e.TgZ(19,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteRequest(s))}),e._UZ(20,"mat-icon",43),e.qZA()()(),e.TgZ(21,"div",25),e.YNc(22,ci,2,1,"ng-container",32),e.qZA(),e.BQk()}if(2&o){const t=i.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",e.xi3(8,14,n.getTotalAmount(t),e.DdM(17,li))," "),e.xp6(3),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.kEZ(18,mi,"Nueva"===t.status,"Aceptada"===t.status,"Rechazada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("disabled","Nueva"!==t.status),e.xp6(1),e.Q6J("svgIcon",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(1),e.Q6J("routerLink",e.VKq(22,di,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(1),e.Q6J("matTooltip","Eliminar"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash"),e.xp6(2),e.Q6J("ngIf",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id)}}function pi(o,i){if(1&o&&(e.ynx(0),e.YNc(1,ui,23,24,"ng-container",34),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const gi=function(o){return{"pointer-events-none":o}},_i=function(){return[10,25,50,100]};function fi(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,si,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," Nombre "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,pi,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.requests$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,gi,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,_i))("showFirstLastButtons",!0)}}const hi=function(o){return{"bg-amber-200 text-amber-900":o}},xi=function(o){return{"bg-blue-200 text-blue-900":o}},vi=function(o){return{"bg-red-200 text-red-900":o}};function bi(o,i){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Nueva"!==r.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",49),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",50),e.qZA(),e.TgZ(5,"button",51),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Aceptada"!==r.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",49),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",52),e.qZA(),e.TgZ(9,"button",53),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.filterInputControl.setValue("Rechazada"!==r.filterInputControl.value?"Rechazada":""))}),e.TgZ(10,"span",49),e._uU(11,"Rechazadas"),e.qZA(),e._UZ(12,"div",54),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(3,hi,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(5,xi,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,vi,"Rechazada"===t.filterInputControl.value))}}function Zi(o,i){if(1&o&&(e.TgZ(0,"div",55),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"No se han econtrado solicitudes":"No le han enviado ninguna solicitud a\xfan!")}}function Ci(o,i){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Solicitudes "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,fi,21,16,"ng-container",19),e.YNc(29,bi,13,9,"ng-template",null,20,e.W1O),e.YNc(31,Zi,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=i.ngIf,n=e.MAs(30),r=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar solicitudes"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:r)}}let yi=(()=>{class o{constructor(t,n,r,s,c,u){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._requestService=s,this._snackBar=c,this.store=u,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new C.x}ngOnInit(){this.requests$=this.store.select(qn.Mu),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._requestService.getRequests(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>this._requestService.getRequests(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._requestService.getRequests(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteRequest(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar la solicitud # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._requestService.deleteRequest(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectRequest(t){this._dialog.open(se.g,{data:{title:"Rechazar Solicitud",message:`\xbfEst\xe1 seguro desea Rechazar la solicitud # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,d.R)(this._unsubscribeAll)).subscribe(r=>{void 0!==r&&this._requestService.rejectRequest(t._id,r.reason).subscribe(c=>{this._snackBar.openFromComponent(f.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this.closeDetails(),this._changeDetectorRef.markForCheck()})})}getRequestById(t){this._requestService.getRequestById(t._id).subscribe(n=>{this.store.dispatch((0,Ie.WN)({request:n.request})),this.store.dispatch((0,Ie._P)()),this.closeDetails(),this._changeDetectorRef.markForCheck()})}getTotalAmount(t){return t.goodsData.map(n=>n.quantity).reduce((n,r)=>n+r,0)}toggleDetails(t){this.selectedRequest&&this.selectedRequest._id===t._id?this.closeDetails():this.selectedRequest=t}closeDetails(){this.selectedRequest=null}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(q.R),e.Y36(kn.r),e.Y36(Q.ux),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["hrm-requests"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noRequests",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","requests-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","requests-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","click"],[3,"selectedRequest","reject","isQuotationCreated"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-6","w-7/12","md:w-7/12","lg:w-6/12","xl:w-5/12","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-200","hover:text-amber-900",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-200","hover:text-blue-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-200","hover:text-red-900",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,Ci,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.requests$))},dependencies:[g.rH,g.yS,m.mk,m.sg,m.O5,m.tP,a.Fj,a.JJ,a.oH,U.PQ,k.lW,b.Hw,p.KE,p.qo,A.Nt,T.NW,h.YE,h.nU,te.gM,ai,m.Ov,m.H9],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})();var ke=l(4290);function Ti(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Unidad de Medida "),e.qZA())}function Ii(o,i){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Unidad de Medida "),e.qZA())}function qi(o,i){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.uom.name||"Sin nombre")}}function ki(o,i){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Sigla"),e.qZA(),e._UZ(12,"input",20),e.qZA()(),e.TgZ(13,"div",18)(14,"mat-form-field",19)(15,"mat-label"),e._uU(16,"Tipo"),e.qZA(),e.TgZ(17,"mat-select",21)(18,"mat-option",22),e._uU(19,"\xc1rea"),e.qZA(),e.TgZ(20,"mat-option",22),e._uU(21,"Conteo"),e.qZA(),e.TgZ(22,"mat-option",22),e._uU(23,"Energ\xeda"),e.qZA(),e.TgZ(24,"mat-option",22),e._uU(25,"Longitud"),e.qZA(),e.TgZ(26,"mat-option",22),e._uU(27,"Peso"),e.qZA(),e.TgZ(28,"mat-option",22),e._uU(29,"Volumen"),e.qZA(),e.TgZ(30,"mat-option",22),e._uU(31,"Tiempo"),e.qZA()()()(),e.TgZ(32,"div",23)(33,"span",24),e._uU(34,"Estado"),e.qZA(),e.TgZ(35,"mat-slide-toggle",25),e._uU(36),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.uomForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Unidad de Medida"),e.xp6(5),e.Q6J("formControlName","abbr")("placeholder","Siglas"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","area"),e.xp6(2),e.Q6J("value","conteo"),e.xp6(2),e.Q6J("value","energ\xeda"),e.xp6(2),e.Q6J("value","longitud"),e.xp6(2),e.Q6J("value","peso"),e.xp6(2),e.Q6J("value","volumen"),e.xp6(2),e.Q6J("value","tiempo"),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.uomForm.get("active").value?"Activo":"Inactivo"," ")}}function Ai(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.updateUom())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function wi(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.createUom())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function Qi(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26),e.ynx(2),e.TgZ(3,"button",27),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Ai,3,3,"ng-container",6),e.YNc(6,wi,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Ui=(()=>{class o{constructor(t,n,r,s,c,u,I){this.data=t,this._changeDetectorRef=n,this._formBuilder=r,this._fuseConfirmationService=s,this._dialogRef=c,this._uomService=u,this.store=I,this.dialogMode="view",this.user$=(0,S.of)(null),this.user=null,this._unsubscribeAll=new C.x,this.dialogMode=t.dialogMode,this.uom=t.uom}ngOnInit(){this.user$=this.store.select(L.rk),this.user$.subscribe(t=>this.user=t),this.uomForm=this._formBuilder.group({_id:[null],user:[this.user._id,[a.kI.required]],active:[!0,[a.kI.required]],name:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],abbr:[null,[a.kI.required,a.kI.maxLength(255)]],type:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]}),"edit"===this.dialogMode&&this.uomForm.patchValue(this.uom)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createUom(){let t=this.uomForm.getRawValue();t.slug=new D.i(t.name).slug,t=(0,ae.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._uomService.createUom(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}updateUom(){const t=this.uomForm.getRawValue();t.slug=new D.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(r=>{"confirmed"===r&&this._uomService.updateUom(t).pipe((0,d.R)(this._unsubscribeAll)).subscribe(s=>{this._fuseConfirmationService.open({title:"Confirmaci\xf3n",message:s.message,icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(e.sBO),e.Y36(a.QS),e.Y36(q.R),e.Y36(v.so),e.Y36(j),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName"],[3,"value"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Ti,2,0,"h2",2),e.YNc(4,Ii,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,qi,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,ki,37,17,"div",5),e.BQk(),e.qZA(),e.YNc(10,Qi,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[m.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.nD,a.sg,a.u,W.ey,k.lW,v.ZT,p.KE,p.hX,A.Nt,ie.gD,re.Rr],encapsulation:2}),o})();const Fi={_id:null,active:null,userId:null,name:null,slug:null,abbr:null,type:null};function Ji(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",38),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Si(o,i){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",39),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Pi(o,i){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",31)(2,"div",32),e._uU(3),e.qZA(),e.TgZ(4,"div",33)(5,"div",34),e._uU(6),e.qZA()(),e.TgZ(7,"div",33)(8,"div",34),e._uU(9),e.qZA()(),e.TgZ(10,"div",35),e.YNc(11,Ji,2,1,"ng-container",20),e.YNc(12,Si,2,1,"ng-container",20),e.qZA(),e.TgZ(13,"div")(14,"button",36),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateUom(s))}),e._UZ(15,"mat-icon",37),e.qZA()()(),e.BQk()}if(2&o){const t=i.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.abbr),e.xp6(3),e.Oqu(t.type),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil")}}function Di(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Pi,16,6,"ng-container",30),e.BQk()),2&o){const t=i.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Ni=function(){return[5,10,25,100]};function Mi(o,i){if(1&o&&(e.ynx(0),e.TgZ(1,"div",23)(2,"div",24)(3,"div",25),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",26),e._uU(6," Siglas "),e.qZA(),e.TgZ(7,"div",27),e._uU(8," Tipo "),e.qZA(),e.TgZ(9,"div",28),e._uU(10," Activo "),e.qZA(),e.TgZ(11,"div",26),e._uU(12,"Detalles"),e.qZA()(),e.YNc(13,Di,2,2,"ng-container",20),e.ALo(14,"async"),e.qZA(),e._UZ(15,"mat-paginator",29),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","value"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,9,t.uoms$)),e.xp6(2),e.Q6J("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(11,Ni))("showFirstLastButtons",!0)}}function Ri(o,i){if(1&o&&(e.ynx(0),e.YNc(1,Mi,16,12,"ng-container",22),e.BQk()),2&o){const t=i.ngIf;e.oxw();const n=e.MAs(31);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Ei(o,i){1&o&&(e.TgZ(0,"div",40),e._uU(1,"\xa1No se ha creado ninguna unidad de medida!"),e.qZA())}const Yi=[{path:"",component:Gt},{path:"uoms",component:(()=>{class o{constructor(t,n,r,s,c){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=r,this._uomService=s,this.store=c,this.flashMessage=null,this.uoms$=(0,S.of)([]),this.searchInputControl=new a.p4,this.isLoading=!1,this._unsubscribeAll=new C.x}ngOnInit(){this.uoms$=this.store.select(ne),this.store.select(z.B).pipe((0,d.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,d.R)(this._unsubscribeAll),(0,P.b)(300),(0,x.w)(t=>(this.isLoading=!0,this._uomService.getUoms(0,10,"name","asc",t))),(0,M.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,d.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,O.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._uomService.getUoms(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,M.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createUom(){this._openDialog(Fi,"add")}updateUom(t){this._openDialog(t,"edit")}trackByFn(t,n){return t||n.id}_openDialog(t,n){this._dialog.open(Ui,{data:{uom:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(q.R),e.Y36(j),e.Y36(_.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom"]],viewQuery:function(t,n){if(1&t&&(e.Gf(T.NW,5),e.Gf(h.YE,5)),2&t){let r;e.iGM(r=e.CRH())&&(n._paginator=r.first),e.iGM(r=e.CRH())&&(n._sort=r.first)}},decls:32,vars:10,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent","sm:overflow-x-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex","flex-wrap","items-center","font-medium"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","sm:mb-18","overflow-x-auto"],[4,"ngIf"],["noUoms",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","uom-grid","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,""],[1,"",3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"z-10","border-b","sm:absolute","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","uom-grid","md:px-8"],[1,"truncate"],[1,"items-center","flex"],[1,"min-w-4"],[1,"text-center"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"a",4),e._uU(6,"Inicio"),e.qZA()(),e.TgZ(7,"div",5),e._UZ(8,"mat-icon",6),e.TgZ(9,"a",7),e._uU(10,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(11,"div",5),e._UZ(12,"mat-icon",6),e.TgZ(13,"a",8),e._uU(14,"Unidades de Medida"),e.qZA()()(),e.TgZ(15,"div",9)(16,"h2",10),e._uU(17," Unidades de Medida "),e.qZA()()(),e.TgZ(18,"div",11)(19,"mat-form-field",12),e._UZ(20,"mat-icon",13)(21,"input",14),e.qZA(),e.TgZ(22,"button",15),e.NdJ("click",function(){return n.createUom()}),e._UZ(23,"mat-icon",16),e.TgZ(24,"span",17),e._uU(25,"Nueva"),e.qZA()()()(),e.TgZ(26,"div",18)(27,"div",19),e.YNc(28,Ri,2,2,"ng-container",20),e.ALo(29,"async"),e.YNc(30,Ei,2,0,"ng-template",null,21,e.W1O),e.qZA()()()),2&t&&(e.xp6(8),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar unidades"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(29,8,n.uoms$)))},dependencies:[g.yS,m.sg,m.O5,a.Fj,a.JJ,a.oH,k.lW,b.Hw,p.KE,p.qo,A.Nt,T.NW,h.YE,h.nU,m.Ov],styles:[".uom-grid{grid-template-columns:112px 70px 100px 72px 72px}@media (min-width: 960px){.uom-grid{grid-template-columns:auto 250px 150px 72px 72px}}\n"],encapsulation:2,data:{animation:R.L},changeDetection:0}),o})(),resolve:{uoms:de}},{path:"request",component:yi,resolve:{requests:ke.r}},{path:"request/:requestId",component:In,resolve:{request:ke.N}},{path:"payment-methods",component:Vo,resolve:{paymentMethod:Ko}},{path:"quotations",component:yn,resolve:{quotations:Te.S}},{path:"quotations/:quotationId",component:en,resolve:{quotation:Te.x}},{path:"invoices",component:vo,resolve:{quotations:he.l}},{path:"invoices/:invoiceId",component:Vt,resolve:{quotation:he.u}}];var Bi=l(6863),Li=l(6826);let Oi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Yi),zt,Bi.K,Li.b,B.m]}),o})()}}]);