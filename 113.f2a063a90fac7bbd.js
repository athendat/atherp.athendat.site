"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[113],{7231:(ve,O,l)=>{l.d(O,{C:()=>h});var g=l(520),z=l(2340),a=l(5e3);const T=z.N.API_URL;let h=(()=>{class m{constructor(b){this._httpClient=b}uploadImage(b,A){const _=new FormData;return _.append("image",A,A.name),this._httpClient.post(`${T}/cloudinary/upload/${b}`,_)}removeImage(b,A){const _=A.slice(A.indexOf(b),A.length).split(".")[0],P=(new g.LE).set("public_id",_);return this._httpClient.delete(`${T}/cloudinary/remove`,{params:P})}}return m.\u0275fac=function(b){return new(b||m)(a.LFG(g.eN))},m.\u0275prov=a.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"}),m})()},3113:(ve,O,l)=>{l.r(O),l.d(O,{CommercialModule:()=>Oi});var g=l(5357),z=l(763),a=l(3075),T=l(9646),h=l(7579),m=l(2722),R=l(7489),b=l(4787),A=l(1910),_=l(9784),P=l(2491),K=l(2075),S=l(4062),ie=l(3005),e=l(5e3),w=l(1683),B=l(2834),q=l(7261),be=l(7231),Z=l(5620),u=l(9808),U=l(393),j=l(508),C=l(7423),G=l(288),y=l(5245),p=l(7322),Q=l(7531),W=l(4107),X=l(2368);function Ze(o,r){1&o&&(e.TgZ(0,"div",4),e._UZ(1,"mat-icon",6),e.TgZ(2,"a",66),e._uU(3,"Nuevo"),e.qZA()()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-right"))}function Ce(o,r){1&o&&(e.TgZ(0,"span"),e._uU(1,"Nuevo Producto o Servicio"),e.qZA())}function ye(o,r){if(1&o&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Informaci\xf3n de ",t.selectedProductService.name,"")}}const H=function(o){return{"cursor-not-allowed":o}};function Ie(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.createProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,H,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function Te(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,H,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}function qe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function ke(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function Ae(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function we(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",30),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function Qe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function Ue(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",27)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",70),e.YNc(4,we,3,2,"ng-container",56),e.qZA(),e.YNc(5,Qe,2,0,"mat-error",15),e.qZA()),2&o){const t=r.ngIf,n=e.oxw();e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function Je(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function Fe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function De(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function Se(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function Pe(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function Ne(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function Me(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function Re(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function Ee(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function Ye(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 100"),e.qZA())}function Be(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function Le(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function Oe(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 100"),e.qZA())}function ze(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function je(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",71)(2,"div",72),e._UZ(3,"img",73),e.TgZ(4,"button",74),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw();return e.KtG(c.removeImage(s))}),e._UZ(5,"mat-icon",75),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.Q6J("alt","Product images")("src",t,e.LSH)}}function Ge(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.createProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Guardar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,H,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:save")}}function He(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",67),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.updateProductService())}),e._UZ(1,"mat-icon",68),e.TgZ(2,"span",69),e._uU(3,"Actualizar"),e.qZA()()}if(2&o){const t=e.oxw();e.Q6J("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(3,H,t.productServiceForm.invalid)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:refresh")}}let Ve=(()=>{class o{constructor(t,n,i,s,c,d,F,D,zi){this._activatedRoute=t,this._changeDetectorRef=n,this._router=i,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=d,this._snackBar=F,this._imagesService=D,this.store=zi,this.user$=(0,T.of)(null),this.uoms$=null,this.images=[],this._unsubscribeAll=new h.x}ngOnInit(){this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(K.av),this.store.select(A.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.store.select(ie.YP).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.selectedProductService=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:["",[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!0},[a.kI.required]],cost:[0,[a.kI.required,a.kI.min(1),P.L.numbersAndDecimalsPattern()]],margin:[0,[a.kI.min(0),a.kI.max(1e3),P.L.numbersAndDecimalsPattern()]],taxPercent:[0,[a.kI.min(0),a.kI.max(100),P.L.numbersAndDecimalsPattern()]],discount:[0,[a.kI.min(0),a.kI.max(100),P.L.numbersAndDecimalsPattern()]],price:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],imageUrl:[""],locations:[[{state:this.currentMerchant.state,city:this.currentMerchant.city}]],images:[[]],description:["",[a.kI.maxLength(1e3)]]}),this._activatedRoute.params.pipe((0,m.R)(this._unsubscribeAll)).subscribe(({goodsId:t})=>{this.windowsMode="new"===t?"new":"edit",this._fillProductServiceData(),this._changeDetectorRef.markForCheck()}),this.productServiceForm.get("images").valueChanges.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.images=t,this._changeDetectorRef.markForCheck()})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){let t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t=(0,R.omit)(t,"_id"),t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._router.navigateByUrl("/modules/commercial/goods"),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}uploadImage(t){if(!t.length)return;const i=t[0];!["image/jpeg","image/jpg","image/webp","image/png"].includes(i.type)||this._imagesService.uploadImage("Comercial",i).subscribe(s=>{const c=[...this.productServiceForm.get("images").value,s.imageUrl];this.productServiceForm.get("images").setValue(c);const d=Object.assign(Object.assign({},R.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:c});"edit"===this.windowsMode&&this._productServicesService.updateProductService(d).subscribe(()=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})},s=>{console.warn(s)})}removeImage(t){void 0!==t&&this._fuseConfirmationService.open({title:"Cuidado",message:"\xbfEst\xe1 seguro que desea eliminar esta imagen?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().pipe((0,m.R)(this._unsubscribeAll)).subscribe(i=>{"confirmed"===i&&this._imagesService.removeImage("Comercial",t).subscribe(c=>{const d=[...this.productServiceForm.get("images").value],F=d.findIndex(D=>D===t);if(d.splice(F,1),this.productServiceForm.get("images").setValue(d),"edit"===this.windowsMode){const D=Object.assign(Object.assign({},R.omit(Object.assign({},this.selectedProductService),["merchantId","uomId","createdAt","updatedAt","images"])),{merchantId:this.selectedProductService.merchantId._id,uomId:this.selectedProductService.uomId._id,images:d});this._productServicesService.updateProductService(D).subscribe(()=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}})})}})})}trackByFn(t,n){return n.id||t}_fillProductServiceData(){"edit"===this.windowsMode&&(this.productServiceForm.patchValue(this.selectedProductService),this.images=this.selectedProductService.images,this.productServiceForm.get("locations").setValue([{state:this.currentMerchant.state,city:this.currentMerchant.city}]),this.productServiceForm.get("merchantId").setValue(this.selectedProductService.merchantId._id),void 0!==this.selectedProductService&&this.productServiceForm.get("uomId").setValue(this.selectedProductService.uomId._id))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0),e.Y36(a.qu),e.Y36(w.R),e.Y36(B.z),e.Y36(q.ux),e.Y36(be.C),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-detail"]],decls:153,vars:69,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/goods",1,"ml-1","text-primary-500","hover:underline"],["class","flex items-center ml-1 whitespace-nowrap",4,"ngIf"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[4,"ngIf"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["class","ml-4 text-white bg-primary-500 hover:bg-primary-700 hover:shadow-lg","mat-raised-button","",3,"disabled","ngClass","click",4,"ngIf"],[1,"flex-auto","p-4","sm:p-6"],[1,"flex","flex-col","flex-auto","min-w-0"],[3,"formGroup","autocomplete"],["multi","",1,"w-full","bg-transparent"],[3,"expanded"],[3,"collapsedHeight"],[1,"flex","items-center"],[1,"text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"grid","w-full","pb-8","pt-8","pr-4","pl-4","border-t-2","sm:grid-cols-2","gap-y-3","gap-x-6"],[1,"sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["class","sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["value","MXN"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","required","",3,"formControlName","min","max"],["impuestoField",""],["descuentoField",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","value"],[1,"flex","flex-col","sm:col-span-1"],["value","true",1,"pt-4","mb-2",3,"color","formControlName"],[1,"pt-4","sm:col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[1,"w-full","pb-8","pt-8","pr-4","pl-4","border-t-2"],[1,"flex","flex-row","w-full","flex-wrap"],[1,"flex","flex-row","flex-wrap"],[4,"ngFor","ngForOf"],[1,"w-26","h-26","mt-3"],["id","image-file-input","type","file",1,"absolute","invisible","w-0","h-0","opacity-0","pointer-events-none",3,"multiple","accept","change"],["imageFileInput",""],["for","image-file-input","matRipple",""],[1,"flex","flex-col","flex-auto","p-6","overflow-hidden","w-26","h-26","transition-all","duration-100","ease-linear","border","border-gray-300","rounded-lg","cursor-pointer","hover:bg-hover"],[1,"flex","flex-col","items-center","justify-center","h-full"],[1,"font-thin","icon-size-10",3,"svgIcon"],[1,"flex","flex-col","flex-wrap","justify-end","px-6","pb-10","sm:flex-row","flex-0","sm:items-center","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex","items-center","flex-shrink-0","mt-6","text-right","sm:mt-0","sm:ml-4"],[1,"ml-1","text-primary-500"],["mat-raised-button","",1,"ml-4","text-white","bg-primary-500","hover:bg-primary-700","hover:shadow-lg",3,"disabled","ngClass","click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[3,"formControlName"],[1,"flex","items-center","mt-3"],[1,"relative","flex","items-center","justify-center","mr-6","overflow-hidden","border","rounded","w-26","h-26","flex-0"],[3,"alt","src"],["mat-mini-fab","",1,"absolute","p-5","transition-opacity","ease-linear","delay-200","rounded-full","opacity-50","bg-primary-500","hover:opacity-100",3,"click"],["svgIcon","heroicons_solid:trash",1,"text-white","icon-size-5"]],template:function(t,n){if(1&t){const i=e.EpF();e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()(),e.YNc(16,Ze,4,1,"div",9),e.qZA(),e.TgZ(17,"div",10)(18,"a",11),e._UZ(19,"mat-icon",6),e.TgZ(20,"span",12),e._uU(21,"Regresar"),e.qZA()()()(),e.TgZ(22,"div",13)(23,"div",14),e.YNc(24,Ce,2,0,"span",15),e.YNc(25,ye,2,1,"span",15),e.qZA()()(),e.TgZ(26,"div",16),e.YNc(27,Ie,4,5,"button",17),e.YNc(28,Te,4,5,"button",17),e.qZA()(),e.TgZ(29,"div",18)(30,"div",19)(31,"form",20)(32,"mat-accordion",21)(33,"mat-expansion-panel",22)(34,"mat-expansion-panel-header",23)(35,"mat-panel-title",24)(36,"div",25),e._uU(37," Informaci\xf3n General "),e.qZA()()(),e.TgZ(38,"div",26)(39,"div",27)(40,"mat-form-field",28)(41,"mat-label"),e._uU(42,"Tipo"),e.qZA(),e.TgZ(43,"mat-select",29)(44,"mat-option",30),e._uU(45," Producto "),e.qZA(),e.TgZ(46,"mat-option",30),e._uU(47," Servicio "),e.qZA()(),e.YNc(48,qe,2,0,"mat-error",15),e.TgZ(49,"mat-hint"),e._uU(50,"Especifique si es producto o servicio"),e.qZA()()(),e.TgZ(51,"div",27)(52,"mat-form-field",28)(53,"mat-label"),e._uU(54,"Nombre"),e.qZA(),e._UZ(55,"input",31),e.YNc(56,ke,2,0,"mat-error",15),e.YNc(57,Ae,2,0,"mat-error",15),e.qZA()(),e.YNc(58,Ue,6,3,"mat-form-field",32),e.ALo(59,"async"),e.TgZ(60,"div",27)(61,"mat-form-field",28)(62,"mat-label"),e._uU(63,"Moneda por defecto"),e.qZA(),e.TgZ(64,"mat-select",29)(65,"mat-option",33),e._uU(66,"CUP"),e.qZA(),e.TgZ(67,"mat-option",34),e._uU(68,"MLC"),e.qZA(),e.TgZ(69,"mat-option",35),e._uU(70,"USD"),e.qZA(),e.TgZ(71,"mat-option",36),e._uU(72,"MXN"),e.qZA()(),e._UZ(73,"mat-icon",37),e.YNc(74,Je,2,0,"mat-error",15),e.qZA()(),e.TgZ(75,"mat-form-field",27)(76,"mat-label"),e._uU(77,"Costo"),e.qZA(),e.TgZ(78,"span",38),e._uU(79,"$"),e.qZA(),e._UZ(80,"input",39,40),e.YNc(82,Fe,2,0,"mat-error",15),e.YNc(83,De,2,0,"mat-error",15),e.YNc(84,Se,2,0,"mat-error",15),e.qZA(),e.TgZ(85,"mat-form-field",27)(86,"mat-label"),e._uU(87,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(88,"span",38),e._uU(89,"%"),e.qZA(),e._UZ(90,"input",41,42),e.YNc(92,Pe,2,0,"mat-error",15),e.YNc(93,Ne,2,0,"mat-error",15),e.YNc(94,Me,2,0,"mat-hint",15),e.qZA(),e.TgZ(95,"mat-form-field",27)(96,"mat-label"),e._uU(97,"Impuesto"),e.qZA(),e.TgZ(98,"span",38),e._uU(99,"%"),e.qZA(),e._UZ(100,"input",43,44),e.YNc(102,Re,2,0,"mat-error",15),e.YNc(103,Ee,2,0,"mat-error",15),e.YNc(104,Ye,2,0,"mat-hint",15),e.qZA(),e.TgZ(105,"mat-form-field",27)(106,"mat-label"),e._uU(107,"Descuento"),e.qZA(),e.TgZ(108,"span",38),e._uU(109,"%"),e.qZA(),e._UZ(110,"input",43,45),e.YNc(112,Be,2,0,"mat-error",15),e.YNc(113,Le,2,0,"mat-error",15),e.YNc(114,Oe,2,0,"mat-hint",15),e.qZA(),e.TgZ(115,"mat-form-field",27)(116,"mat-label"),e._uU(117,"Precio"),e.qZA(),e.TgZ(118,"span",38),e._uU(119,"$"),e.qZA(),e._UZ(120,"input",46),e.YNc(121,ze,2,0,"mat-error",15),e.qZA(),e.TgZ(122,"div",47)(123,"mat-label"),e._uU(124,"Estado"),e.qZA(),e.TgZ(125,"mat-slide-toggle",48),e._uU(126," Activo "),e.qZA()(),e.TgZ(127,"div",49)(128,"mat-form-field",50)(129,"mat-label"),e._uU(130,"Descripci\xf3n"),e.qZA(),e._UZ(131,"mat-icon",51)(132,"textarea",52),e.qZA()()()(),e.TgZ(133,"mat-expansion-panel")(134,"mat-expansion-panel-header",23)(135,"mat-panel-title",24)(136,"div",25),e._uU(137," Im\xe1genes "),e.qZA()()(),e.TgZ(138,"div",53)(139,"div",54)(140,"div",55),e.YNc(141,je,6,2,"ng-container",56),e.TgZ(142,"div",57)(143,"input",58,59),e.NdJ("change",function(){e.CHM(i);const c=e.MAs(144);return e.KtG(n.uploadImage(c.files))}),e.qZA(),e.TgZ(145,"label",60)(146,"div",61)(147,"div",62),e._UZ(148,"mat-icon",63),e.qZA()()()()()()()()()()()(),e.TgZ(149,"div",64)(150,"div",65),e.YNc(151,Ge,4,5,"button",17),e.YNc(152,He,4,5,"button",17),e.qZA()()()}if(2&t){const i=e.MAs(81),s=e.MAs(91),c=e.MAs(101),d=e.MAs(111);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(3),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(2),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(5),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","edit"===n.windowsMode&&n.selectedProductService),e.xp6(2),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode),e.xp6(3),e.Q6J("formGroup",n.productServiceForm)("autocomplete","off"),e.xp6(2),e.Q6J("expanded",!0),e.xp6(1),e.Q6J("collapsedHeight","56px"),e.xp6(9),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("name").hasError("maxlength")||n.productServiceForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",e.lcZ(59,67,n.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(9),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("currency").hasError("required")),e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("margin").hasError("min")||n.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").hasError("min")||n.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount")("min",0)("max",100),e.xp6(2),e.Q6J("ngIf",n.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("discount").hasError("min")||n.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",c.value/100*i.value-d.value/100*i.value+s.value/100*i.value+ +i.value),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("price").hasError("required")),e.xp6(4),e.Q6J("color","primary")("formControlName","active"),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(2),e.Q6J("collapsedHeight","56px"),e.xp6(7),e.Q6J("ngForOf",n.images),e.xp6(2),e.Q6J("multiple",!0)("accept","image/jpeg, image/jpg, image/webp, image/png"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(3),e.Q6J("ngIf","new"===n.windowsMode),e.xp6(1),e.Q6J("ngIf","new"!==n.windowsMode)}},dependencies:[g.yS,u.mk,u.sg,u.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.sg,a.u,U.PQ,j.ey,C.lW,G.pp,G.ib,G.yz,G.yK,y.Hw,p.TO,p.KE,p.bx,p.hX,p.qo,Q.Nt,j.wG,W.gD,X.Rr,u.Ov],encapsulation:2,changeDetection:0}),o})();var k=l(6087),f=l(4847),E=l(6451),J=l(8372),x=l(3900),N=l(4004),M=l(3844);class $e{}var Y=l(6428),v=l(8966),ee=l(5119);function Ke(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Agregar producto o servicio"),e.qZA())}function We(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar producto o servicio"),e.qZA())}function Xe(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del producto o servicio"),e.qZA())}function et(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11),e.ynx(4),e.TgZ(5,"div",12)(6,"mat-label",13),e._uU(7,"Nombre"),e.qZA(),e.TgZ(8,"div",14),e._uU(9),e.qZA()(),e.BQk(),e.ynx(10),e.TgZ(11,"div",12)(12,"mat-label",13),e._uU(13,"Descripci\xf3n"),e.qZA(),e.TgZ(14,"div",14),e._uU(15),e.qZA()(),e.BQk(),e.qZA()()()()),2&o){const t=e.oxw();e.xp6(9),e.Oqu(t.data.productService.name),e.xp6(6),e.Oqu(t.data.productService.description)}}function tt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe seleccionar el tipo. "),e.qZA())}function ot(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio es obligatorio. "),e.qZA())}function nt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre del producto o servicio debe contener entre 3 y 255 caracteres. "),e.qZA())}function it(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",21),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit;e.xp6(1),e.Q6J("value",t._id),e.xp6(1),e.hij(" ",t.abbr," ")}}function rt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El la unidad de medida es obligatoria. "),e.qZA())}function at(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",18)(1,"mat-label"),e._uU(2,"Unidad de Medida"),e.qZA(),e.TgZ(3,"mat-select",45),e.YNc(4,it,3,2,"ng-container",46),e.qZA(),e.YNc(5,rt,2,0,"mat-error",6),e.qZA()),2&o){const t=r.ngIf,n=e.oxw(2);e.xp6(3),e.Q6J("formControlName","uomId"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.productServiceForm.get("uomId").hasError("required"))}}function st(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Debe escoger la moneda. "),e.qZA())}function ct(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo del producto es obligatorio. "),e.qZA())}function lt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe de ser mayor que 0. "),e.qZA())}function mt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El costo debe contener solo n\xfameros. "),e.qZA())}function ut(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El margen Gesti\xf3n Comercial del producto es obligatorio "),e.qZA())}function dt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 1000 "),e.qZA())}function pt(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo debe estar entre 0 y 1000"),e.qZA())}function _t(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El impuesto del producto es obligatorio "),e.qZA())}function gt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 15 "),e.qZA())}function ft(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor debe este campo de estar entre 0 y 15"),e.qZA())}function ht(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El descuento del producto es obligatorio "),e.qZA())}function xt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 50 "),e.qZA())}function vt(o,r){1&o&&(e.TgZ(0,"mat-hint"),e._uU(1,"El valor de este campo de estar entre 0 y 50"),e.qZA())}function bt(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El precio del producto es obligatorio "),e.qZA())}function Zt(o,r){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Tipo"),e.qZA(),e.TgZ(7,"mat-select",20)(8,"mat-option",21),e._uU(9," Producto "),e.qZA(),e.TgZ(10,"mat-option",21),e._uU(11," Servicio "),e.qZA()(),e.YNc(12,tt,2,0,"mat-error",6),e.TgZ(13,"mat-hint"),e._uU(14,"Especifique si es producto o servicio"),e.qZA()()(),e.TgZ(15,"div",18)(16,"mat-form-field",19)(17,"mat-label"),e._uU(18,"Nombre"),e.qZA(),e._UZ(19,"input",22),e.YNc(20,ot,2,0,"mat-error",6),e.YNc(21,nt,2,0,"mat-error",6),e.qZA()(),e.YNc(22,at,6,3,"mat-form-field",23),e.ALo(23,"async"),e.TgZ(24,"div",18)(25,"mat-form-field",19)(26,"mat-label"),e._uU(27,"Moneda por defecto"),e.qZA(),e.TgZ(28,"mat-select",20)(29,"mat-option",24),e._uU(30,"CUP"),e.qZA(),e.TgZ(31,"mat-option",25),e._uU(32,"MLC"),e.qZA(),e.TgZ(33,"mat-option",26),e._uU(34,"USD"),e.qZA(),e.TgZ(35,"mat-option",27),e._uU(36,"MXN"),e.qZA()(),e._UZ(37,"mat-icon",28),e.YNc(38,st,2,0,"mat-error",6),e.qZA()(),e.TgZ(39,"mat-form-field",18)(40,"mat-label"),e._uU(41,"Costo"),e.qZA(),e.TgZ(42,"span",29),e._uU(43,"$"),e.qZA(),e._UZ(44,"input",30,31),e.YNc(46,ct,2,0,"mat-error",6),e.YNc(47,lt,2,0,"mat-error",6),e.YNc(48,mt,2,0,"mat-error",6),e.qZA(),e.TgZ(49,"mat-form-field",18)(50,"mat-label"),e._uU(51,"Margen Gesti\xf3n Comercial"),e.qZA(),e.TgZ(52,"span",29),e._uU(53,"%"),e.qZA(),e._UZ(54,"input",32,33),e.YNc(56,ut,2,0,"mat-error",6),e.YNc(57,dt,2,0,"mat-error",6),e.YNc(58,pt,2,0,"mat-hint",6),e.qZA(),e.TgZ(59,"mat-form-field",18)(60,"mat-label"),e._uU(61,"Impuesto"),e.qZA(),e.TgZ(62,"span",29),e._uU(63,"%"),e.qZA(),e._UZ(64,"input",34,35),e.YNc(66,_t,2,0,"mat-error",6),e.YNc(67,gt,2,0,"mat-error",6),e.YNc(68,ft,2,0,"mat-hint",6),e.qZA(),e.TgZ(69,"mat-form-field",18)(70,"mat-label"),e._uU(71,"Descuento"),e.qZA(),e.TgZ(72,"span",29),e._uU(73,"%"),e.qZA(),e._UZ(74,"input",36,37),e.YNc(76,ht,2,0,"mat-error",6),e.YNc(77,xt,2,0,"mat-error",6),e.YNc(78,vt,2,0,"mat-hint",6),e.qZA(),e.TgZ(79,"mat-form-field",18)(80,"mat-label"),e._uU(81,"Precio"),e.qZA(),e.TgZ(82,"span",29),e._uU(83,"$"),e.qZA(),e._UZ(84,"input",38),e.YNc(85,bt,2,0,"mat-error",6),e.qZA(),e.TgZ(86,"div",39)(87,"mat-label"),e._uU(88,"Estado"),e.qZA(),e.TgZ(89,"mat-slide-toggle",40),e._uU(90," Activo "),e.qZA()(),e.TgZ(91,"div",41)(92,"mat-form-field",42)(93,"mat-label"),e._uU(94,"Descripci\xf3n"),e.qZA(),e._UZ(95,"mat-icon",43)(96,"textarea",44),e.qZA()()()()()),2&o){const t=e.MAs(45),n=e.MAs(55),i=e.MAs(65),s=e.MAs(75),c=e.oxw();e.xp6(2),e.Q6J("formGroup",c.productServiceForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","Producto"),e.xp6(2),e.Q6J("value","Servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("type").hasError("required")),e.xp6(7),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del producto o servicio"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("name").hasError("maxlength")||c.productServiceForm.get("name").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",e.lcZ(23,46,c.uoms$)),e.xp6(6),e.Q6J("formControlName","currency"),e.xp6(9),e.Q6J("svgIcon","heroicons_solid:cash"),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("currency").hasError("required")),e.xp6(6),e.Q6J("formControlName","cost")("min",1)("placeholder","Costo del producto o servicio"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("min")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("cost").hasError("pattern")),e.xp6(6),e.Q6J("formControlName","margin"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").hasError("min")||c.productServiceForm.get("margin").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("margin").valid),e.xp6(6),e.Q6J("formControlName","taxPercent"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").hasError("min")||c.productServiceForm.get("taxPercent").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("taxPercent").valid),e.xp6(6),e.Q6J("formControlName","discount"),e.xp6(2),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("required")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").hasError("min")||c.productServiceForm.get("discount").hasError("max")),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("discount").valid),e.xp6(6),e.Q6J("formControlName","price")("value",i.value/100*t.value-s.value/100*t.value+n.value/100*t.value+ +t.value),e.xp6(1),e.Q6J("ngIf",c.productServiceForm.get("price").hasError("required")),e.xp6(4),e.Q6J("value",!0)("color","primary")("formControlName","active"),e.xp6(6),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3)}}const re=function(o){return{"cursor-not-allowed":o}};function Ct(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateProductService())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,re,t.productServiceForm.invalid))}}function yt(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createProductService())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.productServiceForm.invalid)("ngClass",e.VKq(4,re,t.productServiceForm.invalid))}}function It(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",47),e.ynx(2),e.TgZ(3,"button",48),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Ct,3,6,"ng-container",6),e.YNc(6,yt,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Tt=(()=>{class o{constructor(t,n,i,s,c,d,F,D){this.data=t,this._activatedRoute=n,this._changeDetectorRef=i,this._formBuilder=s,this._fuseConfirmationService=c,this._productServicesService=d,this._snackBar=F,this.store=D,this.dialogMode="view",this.user$=(0,T.of)(null),this.uoms$=null,this._unsubscribeAll=new h.x}ngOnInit(){this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.uoms$=this.store.select(K.av),this.store.select(A.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.productServiceForm=this._formBuilder.group({_id:[""],active:[!0],uomId:["",[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],type:["",[a.kI.required]],currency:[{value:"CUP",disabled:!0},[a.kI.required]],cost:[0,[a.kI.required,a.kI.min(1),P.L.onlyNumbersPattern()]],margin:[0,[a.kI.min(0),a.kI.max(1e3)]],taxPercent:[0,[a.kI.min(0),a.kI.max(15)]],discount:[0,[a.kI.min(0),a.kI.max(50)]],price:[{disabled:!0,value:0},[a.kI.required,a.kI.min(0),a.kI.max(999999999),a.kI.maxLength(9)]],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],slug:[""],description:["",[a.kI.maxLength(1e3)]]}),"edit"===this.data.dialogMode&&(this.productServiceForm.patchValue(this.data.productService),this.productServiceForm.get("merchantId").setValue(this.data.productService.merchantId._id),void 0!==this.data.productService.uomId&&this.productServiceForm.get("uomId").setValue(this.data.productService.uomId._id))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){let t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t=(0,ee.Z)(t,"_id"),t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productServicesService.createProductService(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updateProductService(){const t=this.productServiceForm.getRawValue();t.price=t.cost+(t.taxPercent/100*t.cost-t.discount/100*t.cost+t.margin/100*t.cost),t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Departamento",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productServicesService.updateProductService(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(g.gz),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(w.R),e.Y36(B.z),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["goods-dialog"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"flex","sm:items-center"],[1,"min-w-56","font-semibold"],[1,"leading-6"],[1,"w-full","overflow-hidden"],[1,"pt-5"],[1,"grid","grid-cols-2","gap-y-3","gap-x-4","w-full","mt-1",3,"formGroup","autocomplete"],[1,"col-span-2","sm:col-span-1"],[1,"w-full"],["required","",3,"formControlName"],[3,"value"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],["class","col-span-2 sm:col-span-1",4,"ngIf"],["value","CUP"],["value","MLC"],["value","USD"],["value","MXN"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matPrefix",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","min","placeholder"],["costoField",""],["matInput","","type","number","step","1","min","0","max","1000","maxlength","9","required","",3,"formControlName"],["margenField",""],["type","number","matInput","","step","1","min","0","max","15","maxlength","9","required","",3,"formControlName"],["impuestoField",""],["type","number","matInput","","step","1","min","0","max","50","maxlength","9","required","",3,"formControlName"],["descuentoField",""],["matInput","","type","number","min","0","max","999999999","maxlength","9","required","",3,"formControlName","value"],[1,"col-span-2","sm:col-span-1","flex","flex-col"],[1,"pt-4","mb-2",3,"value","color","formControlName"],[1,"col-span-2","pt-4","sm:col-span-2"],[1,"w-full","fuse-mat-textarea","flex-auto"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","",3,"formControlName","rows","spellcheck","maxlength"],[3,"formControlName"],[4,"ngFor","ngForOf"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Ke,2,0,"h2",2),e.YNc(4,We,2,0,"h2",2),e.YNc(5,Xe,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,et,16,2,"div",4),e.BQk(),e.ynx(9),e.YNc(10,Zt,97,48,"div",5),e.BQk(),e.qZA(),e.YNc(11,It,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.productService._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.productService._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},encapsulation:2,changeDetection:0}),o})();function qt(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",44),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function kt(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",45),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}const ae=function(o){return[o]};function At(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div",36),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.qZA(),e.TgZ(8,"div",38),e._uU(9),e.ALo(10,"currency"),e.qZA(),e.TgZ(11,"div",39),e.YNc(12,qt,2,1,"ng-container",23),e.YNc(13,kt,2,1,"ng-container",23),e.qZA(),e.TgZ(14,"div",40)(15,"button",41),e._UZ(16,"mat-icon",42),e.qZA(),e.TgZ(17,"button",43),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteProductService(s))}),e._UZ(18,"mat-icon",42),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.type," "),e.xp6(2),e.hij(" ",t.uomId.name," "),e.xp6(2),e.hij(" ",e.xi3(10,9,t.cost,e.VKq(12,ae,t.currency+" "))," "),e.xp6(3),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("routerLink",e.VKq(14,ae,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function wt(o,r){if(1&o&&(e.ynx(0),e.YNc(1,At,19,16,"ng-container",34),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Qt=function(o){return{"pointer-events-none":o}},Ut=function(){return[10,25,50,100]};function Jt(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26)(2,"div",27)(3,"div",28),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div",28),e._uU(6," Tipo "),e.qZA(),e.TgZ(7,"div",29),e._uU(8," U.Medida "),e.qZA(),e.TgZ(9,"div",30),e._uU(10," Costo "),e.qZA(),e.TgZ(11,"div",31),e._uU(12," Activo "),e.qZA(),e.TgZ(13,"div",32),e._uU(14," Acciones "),e.qZA()(),e.YNc(15,wt,2,2,"ng-container",23),e.ALo(16,"async"),e._UZ(17,"mat-paginator",33),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","type"),e.xp6(4),e.Q6J("mat-sort-header","cost"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(16,11,t.productServices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,Qt,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(15,Ut))("showFirstLastButtons",!0)}}function Ft(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Jt,18,16,"ng-container",25),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Dt(o,r){if(1&o&&(e.TgZ(0,"div",46),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado productos o servicios!":"\xa1No se ha creado ning\xfan producto o servicio a\xfan!")}}const St=function(){return["new"]};let Pt=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._fuseConfirmationService=n,this._productServiceService=i,this._snackBar=s,this.dialog=c,this.store=d,this.merchantId="",this.productService=new $e,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new a.NI(""),this._unsubscribeAll=new h.x}ngOnInit(){this.productServices$=this.store.select(ie.ZQ),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._productServiceService.getProductServices(0,20,"active","desc",t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._productServiceService.getProductServices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createProductService(){this._openDialog(this.productService,"add")}editProductService(t){this._openDialog(t,"edit")}deleteProductService(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar el departamento ${t.name}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._productServiceService.deleteProductService(t._id,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,n){return n.id||t}_openDialog(t,n){this.dialog.open(Tt,{width:"600px",height:"98%",data:{productService:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(w.R),e.Y36(B.z),e.Y36(q.ux),e.Y36(v.uw),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-productServices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:38,vars:14,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"routerLink"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","overflow-x-auto","sm:overflow-x-clip"],[4,"ngIf"],["noProductServices",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","productServices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-center"],[1,"flex","justify-end",3,"mat-sort-header"],[1,"flex","justify-center","lg:ml-6",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","productServices-table","md:px-8"],[1,"truncate"],[1,"truncate","text-center"],[1,"truncate","text-right"],[1,"text-center","lg:ml-6"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Productos y Servicios"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Productos y Servicios "),e.qZA()()(),e.TgZ(24,"div",14)(25,"mat-form-field",15),e._UZ(26,"mat-icon",16)(27,"input",17),e.qZA(),e.TgZ(28,"button",18),e._UZ(29,"mat-icon",19),e.TgZ(30,"span",20),e._uU(31,"Nuevo"),e.qZA()()()(),e.TgZ(32,"div",21)(33,"div",22),e.YNc(34,Ft,2,2,"ng-container",23),e.ALo(35,"async"),e.YNc(36,Dt,2,1,"ng-template",null,24,e.W1O),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar productos o servicios"),e.xp6(1),e.Q6J("routerLink",e.DdM(13,St)),e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(35,11,n.productServices$)))},dependencies:[g.rH,g.yS,u.mk,u.sg,u.O5,a.Fj,a.JJ,a.oH,U.PQ,C.lW,y.Hw,p.KE,p.qo,Q.Nt,k.NW,f.YE,f.nU,u.Ov,u.H9],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})();var Nt=l(4128),V=l(609);const Mt=[{path:"goods",component:Pt,resolve:{prodS:(()=>{class o{constructor(t){this._productServicesService=t}resolve(t,n){return this._productServicesService.getProductServices()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(B.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}},{path:"goods/:goodsId",component:Ve,resolve:{prod:(()=>{class o{constructor(t,n){this._uomService=t,this._productServicesService=n}resolve(t,n){const i=t.params.goodsId;return"new"===i?this._uomService.getActiveUoms():(0,Nt.D)([this._productServicesService.getProductServiceById(i),this._uomService.getActiveUoms()])}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(V.c),e.LFG(B.z))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}];let Rt=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Mt),z.m]}),o})();var Et=l(9602);let Yt=(()=>{class o{constructor(t,n,i){this._activatedRoute=t,this._changeDetectorRef=n,this._router=i,this.merchantId="",this._unsubscribeAll=new h.x}ngOnInit(){this._activatedRoute.params.pipe((0,m.R)(this._unsubscribeAll)).subscribe(({merchantId:t})=>{void 0!==t&&(this.merchantId=t,this._changeDetectorRef.markForCheck())})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g.gz),e.Y36(e.sBO),e.Y36(g.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["ath-commercial"]],decls:38,vars:3,consts:[["cdkScrollable","",1,"absolute","inset-0","flex","flex-col","min-w-0","overflow-y-auto"],[1,"flex","flex-col","flex-wrap","p-6","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex-auto","p-6","sm:p-10"],[1,"flex","flex-col","flex-auto","min-w-0"],[1,"flex","flex-col","w-full"],[1,"grid","grid-flow-row","grid-cols-1","mt-8","sm:grid-cols-2","lg:grid-cols-4","gap-y-12","sm:gap-x-4"],["routerLink","/modules/commercial/goods",1,"flex","items-center","justify-between","w-full","p-6","cursor-pointer","max-w-80","filter-info","hover:shadow-md"],[1,"flex","flex-col"],[1,"text-2xl","font-semibold","leading-tight"],[1,"text-md","text-secondary"],["routerLink","/modules/commercial/uoms",1,"flex","items-center","justify-between","w-full","p-6","cursor-pointer","max-w-80","filter-info","hover:shadow-md"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()()(),e.TgZ(12,"div",8)(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA()()()(),e.TgZ(17,"div",11)(18,"div",12),e._uU(19," Gesti\xf3n Gesti\xf3n Comercial "),e.qZA()()()(),e.TgZ(20,"div",13)(21,"div",14)(22,"div",15)(23,"div",12),e._uU(24," M\xf3dulos "),e.qZA(),e.TgZ(25,"div",16)(26,"fuse-card",17)(27,"div",18)(28,"div",19),e._uU(29,"Productos y Servicios"),e.qZA(),e.TgZ(30,"div",20),e._uU(31,"listado productos y servicios "),e.qZA()()(),e.TgZ(32,"fuse-card",21)(33,"div",18)(34,"div",19),e._uU(35,"Unidades de medida"),e.qZA(),e.TgZ(36,"div",20),e._uU(37,"listado de unidades de medida"),e.qZA()()()()()()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"))},dependencies:[g.rH,g.yS,Et.y,U.PQ,y.Hw],encapsulation:2,changeDetection:0}),o})();var Bt=l(1915);const Lt=["invoiceDetail"],Ot=function(){return["../"]};let zt=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.invoiceDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["invoice-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf(Lt,5),2&t){let i;e.iGM(i=e.CRH())&&(n.invoiceDetailsComponent=i.first)}},decls:35,vars:9,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["invoiceDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la factura"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"invoice-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("routerLink",e.DdM(8,Ot)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,U.PQ,C.lW,y.Hw,Bt._],encapsulation:2,changeDetection:0}),o})();var L=(()=>{return(o=L||(L={})).PendientePago="Pendiente de Pago",o.PagadaParcialmente="Pagada Parcialmente",o.PagadaTotalmente="Pagada Totalmente",o.Cancelada="Cancelada",o.Vencida="Vencida",L;var o})(),jt=l(7939),te=l(3294),se=l(9997),oe=l(2181),$=l(7238);function Gt(o,r){1&o&&e.GkF(0)}function Ht(o,r){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function Vt(o,r){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function $t(o,r){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}function Kt(o,r){1&o&&e._UZ(0,"mat-icon",43),2&o&&e.Q6J("svgIcon","heroicons_solid:check")}const Wt=function(){return["CUP "]},Xt=function(o,r,t,n,i){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":r,"bg-green-50 text-green-700":t,"bg-red-50 text-red-700":n,"bg-pink-50 text-pink-700":i}},eo=function(o){return[o]};function to(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"div")(18,"button",44),e._UZ(19,"mat-icon",43),e.qZA(),e.TgZ(20,"mat-menu",null,45)(22,"button",46)(23,"div",47),e.YNc(24,Ht,1,1,"mat-icon",48),e.qZA(),e.TgZ(25,"span",49),e._uU(26,"Pendiente de Pago"),e.qZA()(),e.TgZ(27,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Parcialmente"))}),e.TgZ(28,"div",47),e.YNc(29,Vt,1,1,"mat-icon",48),e.qZA(),e.TgZ(30,"span",49),e._uU(31,"Pagada Parcialmente"),e.qZA()(),e.TgZ(32,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateStatus(s,"Pagada Totalmente"))}),e.TgZ(33,"div",47),e.YNc(34,$t,1,1,"mat-icon",48),e.qZA(),e.TgZ(35,"span",49),e._uU(36,"Pagada Totalmente"),e.qZA()(),e.TgZ(37,"button",50),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.cancelInvoice(s))}),e.TgZ(38,"div",47),e.YNc(39,Kt,1,1,"mat-icon",48),e.qZA(),e.TgZ(40,"span",49),e._uU(41,"Cancelada"),e.qZA()()()(),e.TgZ(42,"button",51),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteInvoice(s))}),e._UZ(43,"mat-icon",43),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit,n=e.MAs(21),i=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.quotationNo," "),e.xp6(2),e.hij(" ",e.xi3(8,23,i.getTotalAmount(t),e.DdM(26,Wt))," "),e.xp6(3),e.hij(" ",t.quotationId.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Cancelada"===t.status?"Motivo: "+t.canceledReason:"")("ngClass",e.qbA(27,Xt,"Pendiente de Pago"===t.status,"Pagada Parcialmente"===t.status,"Pagada Totalmente"===t.status,"Cancelada"===t.status,"Vencida"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(33,eo,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(2),e.Q6J("matMenuTriggerFor",n)("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-list"),e.xp6(3),e.Q6J("disabled",!0),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pendiente de Pago")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Parcialmente")||t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Parcialmente")),e.xp6(3),e.Q6J("disabled",t.status.includes("Pagada Totalmente")||t.status.includes("Cancelada")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Pagada Totalmente")),e.xp6(3),e.Q6J("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(2),e.Q6J("ngIf",t.status.includes("Cancelada")),e.xp6(3),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Pendiente de Pago")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function oo(o,r){if(1&o&&(e.ynx(0),e.YNc(1,to,44,35,"ng-container",34),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const no=function(o){return{"pointer-events-none":o}},io=function(){return[10,25,50,100]};function ro(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,Gt,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," N.Factura "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,oo,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","quotationNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.invoices$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,no,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,io))("showFirstLastButtons",!0)}}const ao=function(o){return{"bg-amber-500 text-amber-50":o}},so=function(o){return{"bg-blue-500 text-blue-50":o}},co=function(o){return{"bg-green-500 text-green-50":o}},lo=function(o){return{"bg-red-500 text-red-50":o}},mo=function(o){return{"bg-pink-500 text-pink-50":o}};function uo(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",52)(1,"button",53),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Pendiente de Pago"!==i.filterInputControl.value?"Pendiente de Pago":""))}),e.TgZ(2,"span",54),e._uU(3,"Pendiente de Pago"),e.qZA(),e._UZ(4,"div",55),e.qZA(),e.TgZ(5,"button",56),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Pagada Parcialmente"!==i.filterInputControl.value?"Pagada Parcialmente":""))}),e.TgZ(6,"span",54),e._uU(7,"Pagada Parcialmente"),e.qZA(),e._UZ(8,"div",57),e.qZA(),e.TgZ(9,"button",58),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Pagada Totalmente"!==i.filterInputControl.value?"Pagada Totalmente":""))}),e.TgZ(10,"span",54),e._uU(11,"Pagada Totalmente"),e.qZA(),e._UZ(12,"div",59),e.qZA(),e.TgZ(13,"button",60),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Cancelada"!==i.filterInputControl.value?"Cancelada":""))}),e.TgZ(14,"span",54),e._uU(15,"Canceladas"),e.qZA(),e._UZ(16,"div",61),e.qZA(),e.TgZ(17,"button",62),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Vencida"!==i.filterInputControl.value?"Vencida":""))}),e.TgZ(18,"span",54),e._uU(19,"Vencidas"),e.qZA(),e._UZ(20,"div",63),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(5,ao,"Pendiente de Pago"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,so,"Pagada Parcialmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(9,co,"Pagada Totalmente"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,lo,"Cancelada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,mo,"Vencida"===t.filterInputControl.value))}}function po(o,r){if(1&o&&(e.TgZ(0,"div",64),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado facturas!":"\xa1No se ha creado ninguna factura a\xfan!")}}function _o(o,r){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Facturas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Facturas "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,ro,21,16,"ng-container",19),e.YNc(29,uo,21,15,"ng-template",null,20,e.W1O),e.YNc(31,po,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=r.ngIf,n=e.MAs(30),i=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar facturas"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:i)}}let go=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._invoiceService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new h.x}ngOnInit(){this.invoices$=this.store.select(jt.vm),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._invoiceService.getInvoices(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._invoiceService.getInvoices(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._invoiceService.getInvoices(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteInvoice(t){this._fuseConfirmationService.open({title:"Eliminar Factura",message:`\xbfEst\xe1 seguro que desea eliminar la factura # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._invoiceService.deleteInvoice(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}updateStatus(t,n){this._fuseConfirmationService.open({title:"Actualizar estado",message:`\xbfEst\xe1 seguro desea actualizar el estado de la factura # ${t.no} a ${n} `,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._invoiceService.updateStatus(t._id,n).subscribe(c=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}cancelInvoice(t){this._dialog.open(te.g,{data:{title:"Cancelar Factura",message:`\xbfEst\xe1 seguro desea cancelar la factura # ${t.no}`,rejectedReason:t.canceledReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,m.R)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._invoiceService.updateStatus(t._id,L.Cancelada,i.reason).subscribe(c=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}getTotalAmount(t){return t.quotationId.goodsData.map(n=>n.quantity).reduce((n,i)=>n+i,0)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(w.R),e.Y36(se.x),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoices"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noInvoices",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","invoices-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","invoices-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","","matTooltip","Cambiar estado",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matMenuTriggerFor","disabled"],["listStatusMenu","matMenu"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled"],[1,"col-span-1"],["class","icon-size-5",3,"svgIcon",4,"ngIf"],[1,"col-span-3"],["mat-menu-item","",1,"grid","grid-cols-4",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-2","pl-2","sm:pr-6","w-full","sm:w-11/12","md:w-full","lg:w-11/12","xl:w-9/12","flex","justify-around"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","md:w-auto","hover:bg-green-500","hover:text-green-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","justify-center","items-center","ml-1","sm:ml-0","pl-6","pr-6","md:pr-4","md:pl-4","h-full","text-pink-700","transition-all","ease-in-out","delay-50","bg-pink-100","border-0","rounded-full","w-36","md:w-auto","hover:bg-pink-500","hover:text-pink-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,_o,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.invoices$))},dependencies:[u.mk,u.sg,u.O5,u.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,U.PQ,C.lW,y.Hw,p.KE,p.qo,Q.Nt,oe.VK,oe.OP,oe.p6,k.NW,f.YE,f.nU,$.gM,u.Ov,u.H9],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})();var ce=l(2567);const le=o=>o.paymentMethods,me=((0,Z.P1)(le,o=>o.paymentMethod),(0,Z.P1)(le,o=>o.paymentMethods));class ue{}var ne=l(8721),fo=l(7446),de=l(9814);function ho(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar forma de pago"),e.qZA())}function xo(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Editar forma de pago "),e.qZA())}function vo(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1,"Detalles del forma de pago"),e.qZA())}function bo(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.paymentMethod.name||"Sin nombre")}}function Zo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre es obligatorio. "),e.qZA())}function Co(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El nombre debe contener entre 3 y 255 caracteres. "),e.qZA())}function yo(o,r){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Porciento"),e.qZA())}function Io(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El porciento es obligatorio "),e.qZA())}function To(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El valor de este campo debe estar entre 0 y 100 "),e.qZA())}function qo(o,r){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",t.get("percent").getError("outOfRange")," ")}}function ko(o,r){1&o&&(e.TgZ(0,"mat-label"),e._uU(1,"Descripci\xf3n"),e.qZA())}function Ao(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n es obligatoria "),e.qZA())}function wo(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," La descripci\xf3n debe contener entre 3 y 1000 caracteres. "),e.qZA())}function Qo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",45)(2,"button",46),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().index,s=e.oxw(2);return e.KtG(s.removeTermField(i))}),e._UZ(3,"mat-icon",25),e.qZA()(),e.BQk()}2&o&&(e.xp6(3),e.Q6J("svgIcon","heroicons_solid:trash"))}function Uo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",38)(2,"mat-form-field",39),e.YNc(3,yo,2,0,"mat-label",6),e.TgZ(4,"span",40),e._uU(5,"%"),e.qZA(),e.TgZ(6,"input",41),e.NdJ("blur",function(i){const c=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.checkOutOfRange(i.target.value,c))}),e.qZA(),e.YNc(7,Io,2,0,"mat-error",6),e.YNc(8,To,2,0,"mat-error",6),e.YNc(9,qo,2,1,"mat-error",6),e.qZA(),e.TgZ(10,"mat-form-field",42),e.YNc(11,ko,2,0,"mat-label",6),e._UZ(12,"mat-icon",43)(13,"textarea",44),e.YNc(14,Ao,2,0,"mat-error",6),e.YNc(15,wo,2,0,"mat-error",6),e.qZA(),e.YNc(16,Qo,4,1,"ng-container",6),e.qZA(),e.BQk()}if(2&o){const t=r.$implicit,n=r.first,i=r.last;e.xp6(3),e.Q6J("ngIf",n),e.xp6(3),e.Q6J("formControl",t.get("percent"))("spellcheck",!1),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("min")||t.get("percent").hasError("max")),e.xp6(1),e.Q6J("ngIf",t.get("percent").hasError("outOfRange")),e.xp6(2),e.Q6J("ngIf",n),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControl",t.get("description"))("placeholder","Descripci\xf3n")("minLength",3)("maxLength",1e3),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.get("description").hasError("maxlength")||t.get("description").hasError("minlength")),e.xp6(1),e.Q6J("ngIf",!(n&&i))}}function Jo(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",15)(1,"div",9)(2,"form",16)(3,"div",17)(4,"mat-form-field",18)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",19),e.YNc(8,Zo,2,0,"mat-error",6),e.YNc(9,Co,2,0,"mat-error",6),e.qZA()(),e.TgZ(10,"div",20)(11,"span",21),e._uU(12,"T\xe9rminos"),e.qZA(),e.TgZ(13,"div",22),e.YNc(14,Uo,17,15,"ng-container",23),e.qZA(),e.TgZ(15,"div",24),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addTermField())}),e._UZ(16,"mat-icon",25),e.TgZ(17,"span",26),e._uU(18,"Agregar t\xe9rmino"),e.qZA()()(),e.TgZ(19,"div",27)(20,"span",21),e._uU(21,"Pagos"),e.qZA(),e.TgZ(22,"div",28)(23,"mat-checkbox",29),e._uU(24),e.ALo(25,"uppercase"),e.qZA(),e.TgZ(26,"mat-radio-group",30)(27,"mat-radio-button",31),e._uU(28,"Ninguno"),e.qZA(),e.TgZ(29,"mat-radio-button",32),e._uU(30,"Pagos por ATHENDAT"),e.qZA(),e.TgZ(31,"mat-radio-button",33),e._uU(32),e.ALo(33,"uppercase"),e.qZA()()(),e._UZ(34,"div",34),e.qZA(),e.TgZ(35,"div",35)(36,"span",36),e._uU(37,"Estado"),e.qZA(),e.TgZ(38,"mat-slide-toggle",37),e._uU(39),e.qZA()()()()()}if(2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.paymentMethodForm)("autocomplete","off"),e.xp6(5),e.Q6J("type","text")("formControlName","name")("minlength",3)("maxlength",255)("placeholder","Nombre del forma de pago"),e.xp6(1),e.Q6J("ngIf",t.paymentMethodForm.get("name").hasError("required")),e.xp6(1),e.Q6J("ngIf",t.paymentMethodForm.get("name").hasError("maxlength")||t.paymentMethodForm.get("name").hasError("minlength")),e.xp6(5),e.Q6J("ngForOf",t.paymentMethodForm.get("terms").controls)("ngForTrackBy",t.trackByFn),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:plus-circle"),e.xp6(7),e.Q6J("color","primary")("formControlName","includeBankAccount"),e.xp6(1),e.hij(" Incluir la cuenta bancaria de ",e.lcZ(25,21,t.currentMerchant.name),""),e.xp6(2),e.Q6J("color","primary")("formControlName","paymentBy"),e.xp6(6),e.hij("Pagos por QRs de ",e.lcZ(33,23,t.currentMerchant.name),""),e.xp6(6),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.paymentMethodForm.get("active").value?"Activo":"Inactivo"," ")}}const pe=function(o){return{"cursor-not-allowed":o}};function Fo(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updatePaymentMethod())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value)("ngClass",e.VKq(4,pe,t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value))}}function Do(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",49),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createPaymentMethod())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("matDialogClose","confirmed")("disabled",t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value)("ngClass",e.VKq(4,pe,t.paymentMethodForm.invalid||100!==t.totalPercent||"none"===t.paymentMethodForm.get("paymentBy").value&&!1===t.paymentMethodForm.get("includeBankAccount").value))}}function So(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",47),e.ynx(2),e.TgZ(3,"button",48),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Fo,3,6,"ng-container",6),e.YNc(6,Do,3,6,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Po=(()=>{class o{constructor(t,n,i,s,c,d,F){this.data=t,this._changeDetectorRef=n,this._formBuilder=i,this._fuseConfirmationService=s,this._paymentMethodsService=c,this._snackBar=d,this.store=F,this.paymentMethod=new ue,this.dialogMode="view",this.merchants=[],this.selectedMerchant$=null,this.user=null,this.user$=(0,T.of)(null),this.totalPercent=0,this._unsubscribeAll=new h.x}ngOnInit(){this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(A.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.paymentMethodForm=this._formBuilder.group({_id:[""],active:[!0,[a.kI.required]],userId:[this.user._id,[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],paymentBy:["none",[a.kI.required]],includeBankAccount:[!0],name:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],terms:this._formBuilder.array([])}),"edit"===this.data.dialogMode&&(this.paymentMethodForm.patchValue(this.data.paymentMethod),this.paymentMethodForm.get("merchantId").setValue(this.data.paymentMethod.merchantId._id)),this.setTermsDataOnForm()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}addTermField(){const t=this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(1e3)]]}),n=this.paymentMethodForm.get("terms");n.length<=6&&n.push(t),this._changeDetectorRef.markForCheck()}removeTermField(t){this.paymentMethodForm.get("terms").removeAt(t),this.totalPercent=this.paymentMethodForm.get("terms").getRawValue().map(i=>i.percent).reduce((i,s)=>i+s,0),this._changeDetectorRef.markForCheck()}createPaymentMethod(){if(100!==this.totalPercent||this.paymentMethodForm.invalid)return;let t=this.paymentMethodForm.getRawValue();t=(0,ee.Z)(t,"_id"),t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Crear Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentMethodsService.createPaymentMethod(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}updatePaymentMethod(){if(100!==this.totalPercent||this.paymentMethodForm.invalid)return;const t=this.paymentMethodForm.getRawValue();t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Forma de pago",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentMethodsService.updatePaymentMethod(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}checkOutOfRange(t,n){if(+t<=100){const i=this.paymentMethodForm.get("terms").getRawValue().map(c=>c.percent).reduce((c,d)=>c+d,0),s=this.paymentMethodForm.get("terms").controls;i<=100&&s.forEach(c=>{c.get("percent").hasError("outOfRange")&&c.get("percent").setErrors(null)}),i>100&&s.at(n).get("percent").setErrors({outOfRange:"La suma del % de todos los t\xe9rminos no debe superar a 100"}),this.totalPercent=i}}trackByFn(t,n){return n.id||t}setTermsDataOnForm(){if("add"===this.data.dialogMode)return void this.addTermField();const t=[];this.data.paymentMethod.terms.length>0?this.data.paymentMethod.terms.forEach(n=>{t.push(this._formBuilder.group({percent:[n.percent,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:[n.description,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]}))}):t.push(this._formBuilder.group({percent:[0,[a.kI.required,a.kI.min(0),a.kI.max(100)]],description:["",[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]})),t.forEach(n=>{this.paymentMethodForm.get("terms").push(n)}),this.totalPercent=this.paymentMethodForm.get("terms").getRawValue().map(n=>n.percent).reduce((n,i)=>n+i,0)}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(e.sBO),e.Y36(a.qu),e.Y36(w.R),e.Y36(ne.o),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["paymentMethods-detail"]],decls:12,vars:6,consts:[[1,"relative","flex","flex-col","w-full","h-full","overflow-y-auto"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"pt-5"],[1,"w-full"],["matInput","","required","",3,"type","formControlName","minlength","maxlength","placeholder"],[1,"mt-4"],[1,"text-gray-400"],[1,"border-t-2","p-6","pb-0"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"inline-flex","items-center","px-4","-ml-4","mt-2","rounded","cursor-pointer","group",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"ml-2","font-medium","text-secondary","group-hover:underline"],[1,"mt-6"],[1,"border-t-2","p-6","pt-7","pb-7","grid","sm:grid-cols-2","gap-4"],[1,"mb-4",3,"color","formControlName"],["aria-label","Select an option",1,"sm:col-span-2","flex","flex-wrap","justify-between","gap-2",3,"color","formControlName"],["value","none",1,"sm:col-span-1"],["value","UseAthendatPayments",1,"sm:col-span-1","truncate"],["value","UseMerchantPayments",1,"sm:col-span-1"],[1,"border-t-2","w-full"],[1,"flex","flex-col","mt-8"],[1,"font-medium"],[1,"mt-1","sm:mt-3",3,"formControlName","color"],[1,"flex","flex-col","sm:flex-row"],[1,"flex-auto","mt-2","sm:max-w-[20%]"],["matPrefix",""],["matInput","","type","number","min","0","max","100","required","",3,"formControl","spellcheck","blur"],[1,"flex-auto","w-full","mt-2","sm:ml-4","fuse-mat-textarea"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",3,"formControl","placeholder","minLength","maxLength"],[1,"flex","sm:items-center","mb-2","self-end","w-10","sm:pl-2"],["mat-icon-button","","matTooltip","Eliminar",1,"w-8","h-8","min-h-8",3,"click"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","matDialogClose","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,ho,2,0,"h2",2),e.YNc(4,xo,2,0,"h2",2),e.YNc(5,vo,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,bo,9,1,"div",4),e.BQk(),e.ynx(9),e.YNc(10,Jo,40,25,"div",5),e.BQk(),e.qZA(),e.YNc(11,So,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===n.data.paymentMethod._id&&"add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentMethod._id&&"edit"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf",n.data.paymentMethod._id&&"view"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[u.mk,u.sg,u.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.wO,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,C.lW,fo.oG,v.ZT,y.Hw,p.TO,p.KE,p.hX,p.qo,Q.Nt,de.VQ,de.U0,X.Rr,$.gM,u.gd],encapsulation:2,changeDetection:0}),o})();function No(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",39),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Mo(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",40),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Ro(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",33)(2,"div",34),e._uU(3),e.qZA(),e.TgZ(4,"div",35),e.YNc(5,No,2,1,"ng-container",30),e.YNc(6,Mo,2,1,"ng-container",30),e.qZA(),e.TgZ(7,"div",36)(8,"button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.editPaymentMethod(s))}),e._UZ(9,"mat-icon",38),e.qZA(),e.TgZ(10,"button",37),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deletePaymentMethod(s._id))}),e._UZ(11,"mat-icon",38),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(3),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(2),e.Q6J("svgIcon","heroicons_solid:trash")}}function Eo(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Ro,12,5,"ng-container",32),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Yo=function(o){return{"pointer-events-none":o}},Bo=function(){return[10,25,50,100]};function Lo(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",25)(2,"div",26)(3,"div",27),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div",28),e._uU(6," Activo "),e.qZA(),e.TgZ(7,"div",29),e._uU(8," Acciones "),e.qZA()(),e.YNc(9,Eo,2,2,"ng-container",30),e.ALo(10,"async"),e._UZ(11,"mat-paginator",31),e.qZA(),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name")("mat-sort-header","name"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(10,10,t.paymentMethods$)),e.xp6(2),e.Q6J("ngClass",e.VKq(12,Yo,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,Bo))("showFirstLastButtons",!0)}}function Oo(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Lo,12,15,"ng-container",23),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function zo(o,r){if(1&o&&(e.TgZ(0,"div",41),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado formas de pago!":"\xa1No se ha creado ninguna forma de pago a\xfan!")}}let jo=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._paymentMethodService=n,this._dialog=i,this._fuseConfirmationService=s,this._snackBar=c,this.store=d,this.merchantId="",this.paymentMethods$=(0,T.of)([]),this.paymentMethod=new ue,this.isLoading=!1,this.searchInputControl=new a.NI(""),this._unsubscribeAll=new h.x}ngOnInit(){this.paymentMethods$=this.store.select(me),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._paymentMethodService.getPaymentMethods(0,20,"active","desc",t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._paymentMethodService.getPaymentMethods(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createPaymentMethod(){this._openDialog(this.paymentMethod,"add")}editPaymentMethod(t){this._openDialog(t,"edit")}deletePaymentMethod(t){this._fuseConfirmationService.open({title:"Eliminar Forma de pago",message:"\xbfEsta seguro que desea Eliminar el Forma de pago? Perder\xe1 el acceso a todos los datos asociados al mismo.",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._paymentMethodService.deletePaymentMethod(t,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()}),this._changeDetectorRef.markForCheck()})}trackByFn(t,n){return n.id||t}_openDialog(t,n){this._dialog.open(Po,{data:{paymentMethod:t,dialogMode:n},panelClass:"ath-payment-method-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(ne.o),e.Y36(v.uw),e.Y36(w.R),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-paymentMethods"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:38,vars:13,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto","overflow-x-auto","lg:overflow-x-hidden"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto"],[4,"ngIf","ngIfElse"],["noPaymentMethods",""],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5","payment-methods-table"],[3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"text-center","mr-4","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","md:px-8","payment-methods-table"],[1,"truncate"],[1,"text-center","sm:mr-4"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-red-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Formas de pago"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13),e._uU(23," Formas de Pago "),e.qZA()()(),e.TgZ(24,"div",14)(25,"mat-form-field",15),e._UZ(26,"mat-icon",16)(27,"input",17),e.qZA(),e.TgZ(28,"button",18),e.NdJ("click",function(){return n.createPaymentMethod()}),e._UZ(29,"mat-icon",19),e.TgZ(30,"span",20),e._uU(31,"Nueva"),e.qZA()()()(),e.TgZ(32,"div",21)(33,"div",22),e.YNc(34,Oo,2,2,"ng-container",23),e.ALo(35,"async"),e.YNc(36,zo,2,1,"ng-template",null,24,e.W1O),e.qZA()()()),2&t){const i=e.MAs(37);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar formas de pago"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(35,11,n.paymentMethods$))("ngIfElse",i)}},dependencies:[g.yS,u.mk,u.sg,u.O5,a.Fj,a.JJ,a.oH,U.PQ,C.lW,y.Hw,p.KE,p.qo,Q.Nt,k.NW,f.YE,f.nU,u.Ov],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})(),Go=(()=>{class o{constructor(t){this._paymentMethodsService=t}resolve(t,n){return this._paymentMethodsService.getPaymentMethods(0,20,"name","asc","")}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(ne.o))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var Ho=l(5453);const Vo=["quotationDetail"],$o=function(){return["../"]};let Ko=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.quotationDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf(Vo,5),2&t){let i;e.iGM(i=e.CRH())&&(n.quotationDetailsComponent=i.first)}},decls:35,vars:9,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],[1,"ml-1","text-primary-500","hover:underline",3,"routerLink"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["quotationDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la oferta"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"quotation-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(1),e.Q6J("routerLink",e.DdM(8,$o)),e.xp6(3),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,U.PQ,C.lW,y.Hw,Ho.i],encapsulation:2,changeDetection:0}),o})();var Wo=l(6861),Xo=l(1494);function en(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),e.qZA())}const tn=function(o){return{"cursor-not-allowed":o}};let on=(()=>{class o{constructor(t,n,i,s,c,d){this.data=t,this._formBuilder=n,this._dialogRef=i,this._invoiceService=s,this._snackBar=c,this.store=d,this.selectedQuotation=null,this.user$=(0,T.of)(null),this._unsubscribeAll=new h.x,this.selectedQuotation=t.quotation}ngOnInit(){this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t}),this.invoiceForm=this._formBuilder.group({merchantId:[this.selectedQuotation.merchantId._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],quotationId:[this.selectedQuotation._id,[a.kI.required]],quotationNo:[{disabled:!0,value:this.selectedQuotation.no},[a.kI.required]],expirationDays:[this.selectedQuotation.merchantId.commercialManagement.expirationInvoiceDays,[a.kI.required,a.kI.min(1),a.kI.max(60)]],bankAccount:["",[a.kI.minLength(16),a.kI.maxLength(24)]],status:[L.PendientePago,[a.kI.required]]}),this.selectedQuotation.paymentMethodData.includeBankAccount&&this.invoiceForm.get("bankAccount").setValue(this.selectedQuotation.merchantId.bankAccount)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createInvoice(){const t=this.invoiceForm.getRawValue();this._invoiceService.createInvoice(t).subscribe(n=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:n.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.store.dispatch((0,Xo.qm)({quotation:Object.assign(Object.assign({},this.selectedQuotation),{status:"Facturada"})})),this._dialogRef.close()})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(a.qu),e.Y36(v.so),e.Y36(se.x),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-invoice-conform-dialog"]],decls:29,vars:15,consts:[[1,"ng-star-inserted","h-full"],[1,"relative","flex","flex-col","w-full","h-full"],[1,"h-full","flex","items-center"],[1,"block","w-full"],[1,"flex","flex-col","sm:flex-row","flex-auto","items-center","sm:items-start","p-8","pb-4","sm:pb-6"],["ng-reflect-ng-class","[object Object]",1,"flex","flex-0","items-center","justify-center","w-10","h-10","sm:mr-4","rounded-full","text-blue-600","bg-blue-100","dark:text-blue-50","dark:bg-blue-600","ng-star-inserted"],["role","img","aria-hidden","true","ng-reflect-svg-icon","heroicons_outline:question-mar","data-mat-icon-type","svg","data-mat-icon-name","question-mark-circle","data-mat-icon-namespace","heroicons_outline",1,"mat-icon","notranslate","text-current","mat-icon-no-color"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor","fit","","height","100%","width","100%","preserveAspectRatio","xMidYMid meet","focusable","false"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"flex","flex-col","items-center","sm:items-start","mt-4","sm:mt-0","sm:pr-8","space-y-1","text-center","sm:text-left","ng-star-inserted"],[1,"text-xl","leading-6","font-medium","ng-star-inserted"],[1,"text-secondary","ng-star-inserted"],[1,"pr-8","pl-8","mt-10","sm:mt-0","sm:pl-22","pb-6",3,"formGroup","autocomplete"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"flex","flex-wrap","tems-center","justify-center","md:justify-end","px-6","py-4","space-x-3","bg-gray-50","dark:bg-black","dark:bg-opacity-10","ng-star-inserted"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","","mat-button","",3,"color","disabled","ngClass","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"mat-icon",6),e.O4$(),e.TgZ(7,"svg",7),e._UZ(8,"path",8),e.qZA()()(),e.kcU(),e.TgZ(9,"div",9)(10,"div",10),e._uU(11),e.qZA(),e.TgZ(12,"div",11),e._uU(13),e.qZA()()(),e.TgZ(14,"form",12)(15,"div")(16,"mat-form-field",13)(17,"mat-label"),e._uU(18,"Expira en"),e.qZA(),e.TgZ(19,"span",14),e._uU(20,"D\xedas"),e.qZA(),e._UZ(21,"mat-icon",15)(22,"input",16),e.YNc(23,en,2,0,"mat-error",17),e.qZA()()()()(),e.TgZ(24,"div",18)(25,"button",19),e._uU(26,"Cancelar"),e.qZA(),e.TgZ(27,"button",20),e.NdJ("click",function(){return n.createInvoice()}),e._uU(28," Aceptar "),e.qZA()()()()),2&t&&(e.xp6(11),e.Oqu(n.data.title),e.xp6(2),e.Oqu(n.data.message),e.xp6(1),e.Q6J("formGroup",n.invoiceForm)("autocomplete","off"),e.xp6(7),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",60),e.xp6(1),e.Q6J("ngIf",n.invoiceForm.get("expirationDays").hasError("min")||n.invoiceForm.get("expirationDays").hasError("max")),e.xp6(2),e.Q6J("matDialogClose",!0),e.xp6(2),e.Q6J("color","primary")("disabled",n.invoiceForm.invalid)("ngClass",e.VKq(13,tn,n.invoiceForm.invalid)))},dependencies:[u.mk,u.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.qQ,a.Fd,a.sg,a.u,C.lW,v.ZT,y.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,Q.Nt],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})();var _e=l(7871);function nn(o,r){1&o&&e.GkF(0)}const rn=function(){return["CUP "]},an=function(o,r,t,n,i){return{"bg-amber-50 text-amber-700":o,"bg-green-50 text-green-700":r,"bg-blue-50 text-blue-700":t,"bg-red-50 text-red-700":n,"bg-pink-50 text-pink-700":i}},sn=function(o){return[o]};function cn(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"button",44),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.rejectQuotation(s))}),e._UZ(18,"mat-icon",43),e.qZA(),e.TgZ(19,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.conformInvoice(s))}),e._UZ(20,"mat-icon",43),e.qZA(),e.TgZ(21,"button",46),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteQuotation(s))}),e._UZ(22,"mat-icon",43),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.requestNo," "),e.xp6(2),e.hij(" ",e.xi3(8,16,n.getTotalAmount(t),e.DdM(19,rn))," "),e.xp6(3),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.qbA(20,an,"Nueva"===t.status,"Aceptada"===t.status,"Facturada"===t.status,"Rechazada"===t.status,"Vencida"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("routerLink",e.VKq(26,sn,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Nueva")&&!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-copy"),e.xp6(1),e.Q6J("disabled",!t.status.includes("Aceptada")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:clipboard-check"),e.xp6(1),e.Q6J("matTooltip","Eliminar")("disabled",!t.status.includes("Nueva")),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function ln(o,r){if(1&o&&(e.ynx(0),e.YNc(1,cn,23,28,"ng-container",34),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const mn=function(o){return{"pointer-events-none":o}},un=function(){return[10,25,50,100]};function dn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,nn,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," N.Oferta "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,ln,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","requestNo"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.quotations$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,mn,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,un))("showFirstLastButtons",!0)}}const pn=function(o){return{"bg-amber-500 text-amber-50":o}},_n=function(o){return{"bg-green-500 text-green-50":o}},gn=function(o){return{"bg-blue-500 text-blue-50":o}},fn=function(o){return{"bg-red-500 text-pink-50 text-red-5":o}},hn=function(o){return{"bg-pink-500 text-pink-50":o}};function xn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Nueva"!==i.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",49),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",50),e.qZA(),e.TgZ(5,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Aceptada"!==i.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",49),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",52),e.qZA(),e.TgZ(9,"button",53),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Facturada"!==i.filterInputControl.value?"Facturada":""))}),e.TgZ(10,"span",49),e._uU(11,"Facturadas"),e.qZA(),e._UZ(12,"div",54),e.qZA(),e.TgZ(13,"button",55),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Rechazada"!==i.filterInputControl.value?"Rechazada":""))}),e.TgZ(14,"span",49),e._uU(15,"Rechazadas"),e.qZA(),e._UZ(16,"div",56),e.qZA(),e.TgZ(17,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Vencida"!==i.filterInputControl.value?"Vencida":""))}),e.TgZ(18,"span",49),e._uU(19,"Vencidas"),e.qZA(),e._UZ(20,"div",58),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(5,pn,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,_n,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(9,gn,"Facturada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(11,fn,"Rechazada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(13,hn,"Vencida"===t.filterInputControl.value))}}function vn(o,r){if(1&o&&(e.TgZ(0,"div",59),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.searchInputControl.value?"\xa1No se han encontrado ofertas!":"\xa1No se ha creado ninguna oferta a\xfan!","")}}function bn(o,r){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Ofertas"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Ofertas "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,dn,21,16,"ng-container",19),e.YNc(29,xn,21,15,"ng-template",null,20,e.W1O),e.YNc(31,vn,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=r.ngIf,n=e.MAs(30),i=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar ofertas"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:i)}}let Zn=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._quotationService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new h.x}ngOnInit(){this.quotations$=this.store.select(Wo.uy),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._quotationService.getQuotations(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._quotationService.getQuotations(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._quotationService.getQuotations(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteQuotation(t){this._fuseConfirmationService.open({title:"Eliminar Oferta",message:`\xbfEst\xe1 seguro que desea eliminar la oferta # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._quotationService.deleteQuotation(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectQuotation(t){this._dialog.open(te.g,{data:{title:"Rechazar Oferta",message:`\xbfEst\xe1 seguro desea Rechazar la oferta # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,m.R)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._quotationService.rejectQuotation(t._id,i.reason).subscribe(c=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}conformInvoice(t){this._dialog.open(on,{data:{title:"Generar Factura",message:`\xbfEst\xe1 seguro que desea generar una factura para la oferta # ${t.no}?`,quotation:t},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"})}getTotalAmount(t){return t.goodsData.map(n=>n.quantity).reduce((n,i)=>n+i,0)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(w.R),e.Y36(_e.D),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["commercial-quotations"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noQuotations",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","quotations-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-10","mr-6","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","quotations-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],[1,"icon-size-5",3,"svgIcon"],["matTooltip","Rechazar Oferta","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["matTooltip","Generar Factura","mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","disabled","click"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-2","pl-2","sm:pr-6","w-full","md:w-11/12","lg:w-10/12","xl:w-8/12","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-green-700","transition-all","ease-in-out","delay-100","bg-green-50","border-0","rounded-full","w-36","hover:bg-green-500","hover:text-green-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-green-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"flex","justify-center","items-center","ml-1","sm:ml-0","h-full","text-pink-700","transition-all","ease-in-out","delay-50","bg-pink-100","border-0","rounded-full","w-36","hover:bg-pink-500","hover:text-pink-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-pink-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,bn,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.quotations$))},dependencies:[u.mk,u.sg,u.O5,u.tP,a.Fj,a.JJ,a.oH,g.rH,g.yS,U.PQ,C.lW,y.Hw,p.KE,p.qo,Q.Nt,k.NW,f.YE,f.nU,$.gM,u.Ov,u.H9],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})();var ge=l(9641),Cn=l(2627);const yn=["requestDetail"];let In=(()=>{class o{constructor(){}ngOnInit(){}generatePDF(t){this.quotationDetailsComponent.generatePDF(t)}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["request-details-header"]],viewQuery:function(t,n){if(1&t&&e.Gf(yn,5),2&t){let i;e.iGM(i=e.CRH())&&(n.quotationDetailsComponent=i.first)}},decls:35,vars:7,consts:[["cdkScrollable","",1,"absolute","flex","flex-col","w-full","inset-0","min-w-0","text-center","overflow-auto","print:overflow-visible"],[1,"flex","flex-col","flex-wrap","p-6","pb-4","sm:flex-row","flex-0","sm:items-center","sm:justify-between","sm:pt-12","sm:px-10","bg-default","dark:bg-transparent"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial/",1,"ml-1","text-primary-500","hover:underline"],["routerLink","/modules/commercial/request",1,"ml-1","text-primary-500","hover:underline"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2","ml-2","text-left"],[1,"mt-2","text-3xl","font-extrabold","leading-tight","tracking-tight","sm:text-3xl"],[1,"flex","items-center","flex-shrink-0","mt-6","md:mt-0","sm:ml-4","gap-x-4","justify-center"],["mat-button","",1,"rounded-full","bg-primary-100",3,"click"],[1,"text-primary-700",3,"svgIcon"],[1,"w-full"],["requestDetail",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div",4)(6,"a",5),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",4),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",4),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"div",13)(23,"span"),e._uU(24,"Detalles de la solicitud"),e.qZA()()()(),e.TgZ(25,"div",14)(26,"button",15),e.NdJ("click",function(){return n.generatePDF("open")}),e._UZ(27,"mat-icon",16),e.qZA(),e.TgZ(28,"button",15),e.NdJ("click",function(){return n.generatePDF("download")}),e._UZ(29,"mat-icon",16),e.qZA(),e.TgZ(30,"button",15),e.NdJ("click",function(){return n.generatePDF("print")}),e._UZ(31,"mat-icon",16),e.qZA()()(),e.TgZ(32,"div",17),e._UZ(33,"request-details",null,18),e.qZA()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(9),e.Q6J("svgIcon","heroicons_outline:eye"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:download"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:printer"))},dependencies:[g.yS,U.PQ,C.lW,y.Hw,Cn.d],encapsulation:2,changeDetection:0}),o})();var Tn=l(4899),fe=l(2440),qn=l(2454),he=l(7205),I=l(8279);function kn(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"mat-option",27),e._uU(2),e.qZA(),e.BQk()),2&o){const t=r.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("value",n.transformPaymentMethod(t)),e.xp6(1),e.hij(" ",t.name," ")}}function An(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," El m\xe9todo de pago es obligatoria. "),e.qZA())}function wn(o,r){if(1&o&&(e.TgZ(0,"mat-form-field",6)(1,"mat-label"),e._uU(2,"M\xe9todo de pago"),e.qZA(),e._UZ(3,"mat-icon",8),e.TgZ(4,"mat-select",25),e.YNc(5,kn,3,2,"ng-container",26),e.qZA(),e.YNc(6,An,2,0,"mat-error",10),e.qZA()),2&o){const t=r.ngIf,n=e.oxw();e.xp6(3),e.Q6J("svgIcon","heroicons_solid:credit-card"),e.xp6(1),e.Q6J("formControlName","paymentMethodData"),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("paymentMethodData").hasError("required"))}}function Qn(o,r){1&o&&(e.TgZ(0,"mat-error"),e._uU(1," Los d\xedas en que expira deben ser mayores igual que 1 o menores igual que 60. "),e.qZA())}const Un=function(o){return{"text-center pl-8  md:pl-0":o}};function Jn(o,r){if(1&o&&(e.TgZ(0,"th",32),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.Q6J("ngClass",e.VKq(2,Un,"name"!==t)),e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}const Fn=function(o){return{"text-center":o}};function Dn(o,r){if(1&o&&(e.TgZ(0,"td",33),e._uU(1),e.qZA()),2&o){const t=r.$implicit,n=e.oxw(2).$implicit;e.Q6J("ngClass",e.VKq(2,Fn,"name"!==n)),e.xp6(1),e.hij(" ",t[n]," ")}}function Sn(o,r){1&o&&(e.TgZ(0,"span"),e._uU(1,"Total"),e.qZA())}const Pn=function(o,r){return{"text-center":o,truncate:r}};function Nn(o,r){if(1&o&&(e.TgZ(0,"td",34),e.YNc(1,Sn,2,0,"span",10),e.qZA()),2&o){const t=e.oxw(2).$implicit;e.Q6J("ngClass",e.WLB(2,Pn,"name"!==t,"name"===t)),e.xp6(1),e.Q6J("ngIf","name"===t)}}function Mn(o,r){1&o&&(e.TgZ(0,"div"),e.YNc(1,Jn,2,4,"th",29),e.YNc(2,Dn,2,4,"td",30),e.YNc(3,Nn,2,5,"td",31),e.qZA())}function Rn(o,r){if(1&o&&(e.TgZ(0,"th",38),e._uU(1),e.qZA()),2&o){const t=e.oxw(2).$implicit,n=e.oxw();e.xp6(1),e.hij(" ",n.getFieldsTableHeaderNames(t)," ")}}function En(o,r){if(1&o&&(e.TgZ(0,"span",42),e._uU(1),e.qZA()),2&o){const t=e.oxw().$implicit,n=e.oxw(2).$implicit;e.xp6(1),e.hij(" ",t[n],"")}}function Yn(o,r){if(1&o&&(e.TgZ(0,"div",42)(1,"mat-form-field",43),e._UZ(2,"input",44),e.qZA()()),2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("formControl",n.amountFormControl)("min",0)("max",n.getOldGoodsAmountById(t.goodsId))}}function Bn(o,r){if(1&o&&(e.TgZ(0,"td",39)(1,"div",40),e.YNc(2,En,2,1,"span",41),e.YNc(3,Yn,3,3,"div",41),e.qZA()()),2&o){const t=r.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}function Ln(o,r){1&o&&e._UZ(0,"td",45)}function On(o,r){1&o&&(e.TgZ(0,"div"),e.YNc(1,Rn,2,1,"th",35),e.YNc(2,Bn,4,2,"td",36),e.YNc(3,Ln,1,0,"td",37),e.qZA())}function zn(o,r){1&o&&(e.TgZ(0,"th",49),e._uU(1," Acciones "),e.qZA())}function jn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(i.goodsId,-1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit;e.Q6J("disabled",0===t.amount),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:minus-sm")}}function Gn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",55),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.operation(i.goodsId,1))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("disabled",t.amount===n.getOldGoodsAmountById(t.goodsId)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:plus-sm")}}function Hn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",57),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(i))}),e._UZ(1,"mat-icon",56),e.qZA()}2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt"))}function Vn(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit,s=e.oxw(3);return e.KtG(s.toggleToEditGoods(i))}),e._UZ(1,"mat-icon",56),e.qZA()}if(2&o){const t=e.oxw().$implicit,n=e.oxw(3);e.Q6J("color","primary")("disabled",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)&&n.amountFormControl.invalid),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil-alt")}}function $n(o,r){if(1&o&&(e.TgZ(0,"td",50)(1,"div",51),e.YNc(2,jn,2,2,"button",52),e.YNc(3,Gn,2,2,"button",52),e.YNc(4,Hn,2,1,"button",53),e.YNc(5,Vn,2,3,"button",54),e.qZA()()),2&o){const t=r.$implicit,n=e.oxw(3);e.xp6(2),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",!n.selectedGoodDataToEdit||t.goodsId!==(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId)),e.xp6(1),e.Q6J("ngIf",n.selectedGoodDataToEdit&&t.goodsId===(null==n.selectedGoodDataToEdit?null:n.selectedGoodDataToEdit.goodsId))}}const Kn=function(){return["CUP "]};function Wn(o,r){if(1&o&&(e.TgZ(0,"td",59),e._uU(1),e.ALo(2,"currency"),e.qZA()),2&o){const t=e.oxw(3);e.xp6(1),e.hij(" ",e.xi3(2,1,t.getTotalQuantity(),e.DdM(4,Kn))," ")}}function Xn(o,r){1&o&&(e.TgZ(0,"div"),e.YNc(1,zn,2,0,"th",46),e.YNc(2,$n,6,4,"td",47),e.YNc(3,Wn,3,5,"td",48),e.qZA())}function ei(o,r){if(1&o&&(e.ynx(0,28),e.YNc(1,Mn,4,0,"div",10),e.YNc(2,On,4,0,"div",10),e.YNc(3,Xn,4,0,"div",10),e.BQk()),2&o){const t=r.$implicit;e.s9C("matColumnDef",t),e.xp6(1),e.Q6J("ngIf","actions"!==t&&"amount"!==t),e.xp6(1),e.Q6J("ngIf","amount"===t),e.xp6(1),e.Q6J("ngIf","actions"===t)}}function ti(o,r){1&o&&e._UZ(0,"tr",60)}function oi(o,r){1&o&&e._UZ(0,"tr",61)}function ni(o,r){1&o&&e._UZ(0,"tr",62)}const ii=function(o){return{"cursor-not-allowed":o}};let ri=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._formBuilder=n,this._fuseConfirmationService=i,this._quotationsService=s,this._snackBar=c,this.store=d,this.selectedRequest=null,this.reject=new e.vpe,this.isQuotationCreated=new e.vpe,this.user$=(0,T.of)(null),this.selectedGoodDataToEdit=null,this.amountFormControl=new a.NI(0),this.paymentMethods$=(0,T.of)(null),this.displayedColumns=["name","type","uom","amount","price","quantity","actions"],this._unsubscribeAll=new h.x,this.amountFormControl.setValidators([a.kI.required])}ngOnInit(){this.goodsData=(0,R.cloneDeep)(this.selectedRequest.goodsData),this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.paymentMethods$=this.store.select(me),this.quotationForm=this._formBuilder.group({merchantId:[this.selectedRequest.merchantId._id,[a.kI.required]],userId:[this.user._id,[a.kI.required]],requestId:[this.selectedRequest._id,[a.kI.required]],requestNo:[{disabled:!0,value:this.selectedRequest.no},[a.kI.required]],expirationDays:[this.selectedRequest.merchantId.commercialManagement.expirationQuotationDays,[a.kI.required,a.kI.min(1),a.kI.max(60)]],status:[he.qm.Nueva,[a.kI.required]],description:["",[a.kI.maxLength(1e3)]],paymentMethodData:[null,[a.kI.required]]})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createQuotation(){let t=this.quotationForm.getRawValue();t=Object.assign(Object.assign({},t),{goodsData:this.goodsData}),this._fuseConfirmationService.open({title:"Crear Oferta",message:"\xbfEsta seguro que todos los datos son correctos?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._quotationsService.createQuotation(t).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this.isQuotationCreated.next(this.selectedRequest)}),this._changeDetectorRef.markForCheck()})}transformPaymentMethod(t){return new he.R8(t)}getTotalQuantity(){return this.goodsData.map(t=>t.quantity).reduce((t,n)=>t+n,0)}getFieldsTableHeaderNames(t){switch(t){case"name":return"Nombre";case"uom":return"U.M";case"amount":return"Cantidad";case"price":return"Precio";case"quantity":return"Total unitario";case"type":return"Tipo"}}operation(t,n){const i=this.goodsData.find(s=>s.goodsId===t);i.amount=i.amount+n,i.quantity=i.amount*i.price}getOldGoodsAmountById(t){return this.selectedRequest.goodsData.find(n=>n.goodsId===t).amount}toggleToEditGoods(t){if(this.selectedGoodDataToEdit&&this.selectedGoodDataToEdit.goodsId===t.goodsId){const i=this.amountFormControl.value;this.amountFormControl.clearValidators();const s=this.goodsData.find(c=>c.goodsId===t.goodsId);return s.amount=i,s.quantity=s.amount*s.price,this.amountFormControl.clearValidators(),void(this.selectedGoodDataToEdit=null)}const n=this.selectedRequest.goodsData.find(i=>i.goodsId===t.goodsId);this.amountFormControl.setValidators([a.kI.required,a.kI.min(0),a.kI.max(n.amount)]),this.amountFormControl.setValue(t.amount),this.selectedGoodDataToEdit=t}triggerReject(){this.reject.next(this.selectedRequest)}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(a.qu),e.Y36(w.R),e.Y36(_e.D),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["quotation-conform"]],inputs:{selectedRequest:"selectedRequest"},outputs:{reject:"reject",isQuotationCreated:"isQuotationCreated"},decls:36,vars:25,consts:[[1,"shadow-lg","overflow-hidden"],[1,"flex","flex-col","justify-between","order-b"],[1,"p-4","sm:p-10","flex","flex-col","space-y-1","w-full"],[1,"grid","w-full","grid-cols-4","gap-y-1","gap-x-6",3,"formGroup"],[1,"col-span-1"],["class","w-full",4,"ngIf"],[1,"w-full"],["matSuffix","",1,"ml-1"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["type","number","required","","matInput","",3,"formControlName","min","max"],[4,"ngIf"],[1,"col-span-2"],[1,"flex-auto","w-full","fuse-mat-textarea"],["matInput","","matTextareaAutosize","",1,"h-4","min-h-4","max-h-20",3,"formControlName","rows","spellcheck","maxlength"],[1,"flex","flex-col","col-span-4"],[1,"font-medium"],["tabindex","0",1,"mt-2","overflow-auto","max-h-80","rounded-md",2,"box-shadow","0 0 3px 0 rgb(0 0 0 / 10%), 0 1px 2px -1px rgb(0 0 0 / 10%) !important"],["mat-table","",1,"w-full",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-footer-row","","class","font-medium",4,"matFooterRowDef"],[1,"flex","items-center","justify-between","w-full","border-t","px-8","py-4"],["mat-button","",1,"-ml-4",3,"color","click"],["mat-flat-button","",3,"color","disabled","ngClass","click"],["required","",3,"formControlName"],[4,"ngFor","ngForOf"],[3,"value"],[3,"matColumnDef"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0",3,"ngClass",4,"matHeaderCellDef"],["mat-cell","",3,"ngClass",4,"matCellDef"],["mat-footer-cell","",3,"ngClass",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0",3,"ngClass"],["mat-cell","",3,"ngClass"],["mat-footer-cell","",3,"ngClass"],["mat-header-cell","","class","w-10 pr-8 md:w-auto md:pr-0 text-center pl-8  md:pl-0",4,"matHeaderCellDef"],["mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-center",4,"matFooterCellDef"],["mat-header-cell","",1,"w-10","pr-8","md:w-auto","md:pr-0","text-center","pl-8","md:pl-0"],["mat-cell","",1,"text-center"],[1,"flex","justify-center"],["class","w-24",4,"ngIf"],[1,"w-24"],[1,"w-full","fuse-mat-no-subscript"],["type","number","matInput","","required","",3,"formControl","min","max"],["mat-footer-cell","",1,"text-center"],["mat-header-cell","","class","text-center pr-8 pl-8 md:pr-6 md:pl-0",4,"matHeaderCellDef"],["style","width: 120px;","mat-cell","","class","text-center",4,"matCellDef"],["mat-footer-cell","","class","text-end",4,"matFooterCellDef"],["mat-header-cell","",1,"text-center","pr-8","pl-8","md:pr-6","md:pl-0"],["mat-cell","",1,"text-center",2,"width","120px"],[1,"flex","justify-center","space-x-2",2,"width","120px"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"disabled","click",4,"ngIf"],["class","min-w-10 min-h-7 h-7 px-2 leading-6","mat-button","",3,"click",4,"ngIf"],["class","min-h-7 h-7 px-2 leading-6","mat-flat-button","",3,"color","disabled","click",4,"ngIf"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"click"],["mat-flat-button","",1,"min-h-7","h-7","px-2","leading-6",3,"color","disabled","click"],["mat-footer-cell","",1,"text-end"],["mat-header-row",""],["mat-row",""],["mat-footer-row","",1,"font-medium"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"form",3)(4,"div",4),e.YNc(5,wn,7,4,"mat-form-field",5),e.ALo(6,"async"),e.qZA(),e.TgZ(7,"div",4)(8,"mat-form-field",6)(9,"mat-label"),e._uU(10,"Expira en"),e.qZA(),e.TgZ(11,"span",7),e._uU(12,"D\xedas"),e.qZA(),e._UZ(13,"mat-icon",8)(14,"input",9),e.YNc(15,Qn,2,0,"mat-error",10),e.qZA()(),e.TgZ(16,"div",11)(17,"mat-form-field",12)(18,"mat-label"),e._uU(19,"Descripci\xf3n"),e.qZA(),e._UZ(20,"mat-icon",8)(21,"textarea",13),e.qZA()()(),e.TgZ(22,"div",14)(23,"mat-label",15),e._uU(24,"Productos y servicios"),e.qZA(),e.TgZ(25,"div",16)(26,"table",17),e.YNc(27,ei,4,4,"ng-container",18),e.YNc(28,ti,1,0,"tr",19),e.YNc(29,oi,1,0,"tr",20),e.YNc(30,ni,1,0,"tr",21),e.qZA()()()(),e.TgZ(31,"div",22)(32,"button",23),e.NdJ("click",function(){return n.triggerReject()}),e._uU(33," Rechazar Solicitud "),e.qZA(),e.TgZ(34,"button",24),e.NdJ("click",function(){return n.createQuotation()}),e._uU(35," Conformar Oferta "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("formGroup",n.quotationForm),e.xp6(2),e.Q6J("ngIf",e.lcZ(6,21,n.paymentMethods$)),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:clock"),e.xp6(1),e.Q6J("formControlName","expirationDays")("min",1)("max",60),e.xp6(1),e.Q6J("ngIf",n.quotationForm.get("expirationDays").hasError("min")||n.quotationForm.get("expirationDays").hasError("max")),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1)("maxlength",1e3),e.xp6(5),e.Q6J("dataSource",n.goodsData),e.xp6(1),e.Q6J("ngForOf",n.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",n.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",n.displayedColumns),e.xp6(1),e.Q6J("matFooterRowDef",n.displayedColumns),e.xp6(2),e.Q6J("color","warn"),e.xp6(2),e.Q6J("color","primary")("disabled",n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotalQuantity())("ngClass",e.VKq(23,ii,n.quotationForm.invalid||n.amountFormControl.invalid||0===n.getTotalQuantity())))},dependencies:[u.mk,u.sg,u.O5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.Q7,a.nD,a.qQ,a.Fd,a.oH,a.sg,a.u,j.ey,C.lW,y.Hw,p.TO,p.KE,p.hX,p.qo,p.R9,Q.Nt,W.gD,I.BZ,I.fO,I.as,I.w1,I.Dz,I.nj,I.mD,I.Ke,I.ge,I.ev,I.yh,I.XQ,I.Gk,I.Q2,u.Ov,u.H9],encapsulation:2,changeDetection:0}),o})();function ai(o,r){1&o&&e.GkF(0)}function si(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"quotation-conform",46),e.NdJ("reject",function(i){e.CHM(t);const s=e.oxw(5);return e.KtG(s.rejectRequest(i))})("isQuotationCreated",function(i){e.CHM(t);const s=e.oxw(5);return e.KtG(s.getRequestById(i))}),e.qZA(),e.BQk()}if(2&o){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("selectedRequest",t)}}const ci=function(){return["CUP "]},li=function(o,r,t){return{"bg-amber-50 text-amber-700":o,"bg-blue-50 text-blue-700":r,"bg-red-50 text-red-700":t}},mi=function(o){return[o]};function ui(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div"),e._uU(3),e.qZA(),e.TgZ(4,"div",36),e._uU(5),e.qZA(),e.TgZ(6,"div",37),e._uU(7),e.ALo(8,"currency"),e.qZA(),e.TgZ(9,"div",38),e._uU(10),e.qZA(),e.TgZ(11,"div",39)(12,"span",40),e._uU(13),e.qZA()(),e.TgZ(14,"div",41)(15,"button",42),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.toggleDetails(s))}),e._UZ(16,"mat-icon",43),e.qZA(),e.TgZ(17,"button",44),e._UZ(18,"mat-icon",43),e.qZA(),e.TgZ(19,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteRequest(s))}),e._UZ(20,"mat-icon",43),e.qZA()()(),e.TgZ(21,"div",25),e.YNc(22,si,2,1,"ng-container",32),e.qZA(),e.BQk()}if(2&o){const t=r.$implicit,n=e.oxw(4);e.xp6(3),e.hij(" ",t.no," "),e.xp6(2),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",e.xi3(8,14,n.getTotalAmount(t),e.DdM(17,ci))," "),e.xp6(3),e.hij(" ",t.goodsData.length," "),e.xp6(1),e.Q6J("matTooltip","Rechazada"===t.status?"Motivo: "+t.rejectedReason:"")("ngClass",e.kEZ(18,li,"Nueva"===t.status,"Aceptada"===t.status,"Rechazada"===t.status)),e.xp6(2),e.Oqu(t.status),e.xp6(2),e.Q6J("disabled","Nueva"!==t.status),e.xp6(1),e.Q6J("svgIcon",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id?"heroicons_solid:chevron-up":"heroicons_solid:chevron-down"),e.xp6(1),e.Q6J("routerLink",e.VKq(22,mi,t._id)),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"),e.xp6(1),e.Q6J("matTooltip","Eliminar"),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash"),e.xp6(2),e.Q6J("ngIf",(null==n.selectedRequest?null:n.selectedRequest._id)===t._id)}}function di(o,r){if(1&o&&(e.ynx(0),e.YNc(1,ui,23,24,"ng-container",34),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const pi=function(o){return{"pointer-events-none":o}},_i=function(){return[10,25,50,100]};function gi(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",22),e.YNc(2,ai,1,0,"ng-container",23),e.TgZ(3,"div",24)(4,"div",25)(5,"div",26)(6,"div",27),e._uU(7," N\xfamero "),e.qZA(),e.TgZ(8,"div",27),e._uU(9," Nombre "),e.qZA(),e.TgZ(10,"div",28),e._uU(11," Importe "),e.qZA(),e.TgZ(12,"div",29),e._uU(13," Cantidad "),e.qZA(),e.TgZ(14,"div",30),e._uU(15," Estado "),e.qZA(),e.TgZ(16,"div",31),e._uU(17," Acciones "),e.qZA()(),e.YNc(18,di,2,2,"ng-container",32),e.ALo(19,"async"),e._UZ(20,"mat-paginator",33),e.qZA()()(),e.BQk()),2&o){e.oxw();const t=e.MAs(30),n=e.oxw();e.xp6(2),e.Q6J("ngTemplateOutlet",t),e.xp6(4),e.Q6J("mat-sort-header","no"),e.xp6(2),e.Q6J("mat-sort-header","name"),e.xp6(6),e.Q6J("mat-sort-header","status"),e.xp6(4),e.Q6J("ngIf",e.lcZ(19,11,n.requests$)),e.xp6(2),e.Q6J("ngClass",e.VKq(13,pi,n.isLoading))("length",n.pagination.length)("pageIndex",n.pagination.page)("pageSize",n.pagination.size)("pageSizeOptions",e.DdM(15,_i))("showFirstLastButtons",!0)}}const fi=function(o){return{"bg-amber-500 text-amber-50":o}},hi=function(o){return{"bg-blue-500 text-blue-50":o}},xi=function(o){return{"bg-red-500 text-red-50":o}};function vi(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",47)(1,"button",48),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Nueva"!==i.filterInputControl.value?"Nueva":""))}),e.TgZ(2,"span",49),e._uU(3,"Nuevas"),e.qZA(),e._UZ(4,"div",50),e.qZA(),e.TgZ(5,"button",51),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Aceptada"!==i.filterInputControl.value?"Aceptada":""))}),e.TgZ(6,"span",49),e._uU(7,"Aceptadas"),e.qZA(),e._UZ(8,"div",52),e.qZA(),e.TgZ(9,"button",53),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.filterInputControl.setValue("Rechazada"!==i.filterInputControl.value?"Rechazada":""))}),e.TgZ(10,"span",49),e._uU(11,"Rechazadas"),e.qZA(),e._UZ(12,"div",54),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(3,fi,"Nueva"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(5,hi,"Aceptada"===t.filterInputControl.value)),e.xp6(4),e.Q6J("ngClass",e.VKq(7,xi,"Rechazada"===t.filterInputControl.value))}}function bi(o,r){if(1&o&&(e.TgZ(0,"div",55),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado solicitudes!":"\xa1No le han enviado ninguna solicitud a\xfan!")}}function Zi(o,r){if(1&o&&(e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div")(4,"div",4)(5,"div",5)(6,"a",6),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",7),e.TgZ(10,"a",8),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",7),e.TgZ(14,"a",9),e._uU(15,"Solicitudes"),e.qZA()()(),e.TgZ(16,"div",10)(17,"a",11),e._UZ(18,"mat-icon",7),e.TgZ(19,"span",12),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",13)(22,"div",14),e._uU(23," Solicitudes "),e.qZA()()(),e.TgZ(24,"div",15)(25,"mat-form-field",16),e._UZ(26,"mat-icon",17)(27,"input",18),e.qZA()()(),e.YNc(28,gi,21,16,"ng-container",19),e.YNc(29,vi,13,9,"ng-template",null,20,e.W1O),e.YNc(31,bi,2,1,"ng-template",null,21,e.W1O),e.qZA()),2&o){const t=r.ngIf,n=e.MAs(30),i=e.MAs(32),s=e.oxw();e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",s.searchInputControl)("autocomplete","off")("placeholder","Buscar solicitudes"),e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",s.filterInputControl.value?n:i)}}let Ci=(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._requestService=s,this._snackBar=c,this.store=d,this.isLoading=!1,this.searchInputControl=new a.NI(""),this.filterInputControl=new a.NI(""),this._unsubscribeAll=new h.x}ngOnInit(){this.requests$=this.store.select(Tn.Mu),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._requestService.getRequests(0,20,"createdAt","desc",t,this.filterInputControl.value))).subscribe(),this.filterInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>this._requestService.getRequests(0,20,"createdAt","desc",this.searchInputControl.value,t))).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"desc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._requestService.getRequests(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction,this.searchInputControl.value,this.filterInputControl.value))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}deleteRequest(t){this._fuseConfirmationService.open({title:"Eliminar Usuario",message:`\xbfEst\xe1 seguro que desea eliminar la solicitud # ${t.no}? Perder\xe1 el acceso a todos los datos asociados al mismo.`,icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._requestService.deleteRequest(t._id,this.pagination.page,this.pagination.size,"createdAt","desc",this.searchInputControl.value,this.filterInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})}),this._changeDetectorRef.markForCheck()}rejectRequest(t){this._dialog.open(te.g,{data:{title:"Rechazar Solicitud",message:`\xbfEst\xe1 seguro desea Rechazar la solicitud # ${t.no}?`,rejectedReason:t.rejectedReason,rejectedReasonRequired:!0},panelClass:"ath-reject-dialog-panel",maxWidth:"520px"}).afterClosed().pipe((0,m.R)(this._unsubscribeAll)).subscribe(i=>{void 0!==i&&this._requestService.rejectRequest(t._id,i.reason).subscribe(c=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:c.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this.closeDetails(),this._changeDetectorRef.markForCheck()})})}getRequestById(t){this._requestService.getRequestById(t._id).subscribe(n=>{this.store.dispatch((0,fe.WN)({request:n.data})),this.store.dispatch((0,fe._P)()),this.closeDetails(),this._changeDetectorRef.markForCheck()})}getTotalAmount(t){return t.goodsData.map(n=>n.quantity).reduce((n,i)=>n+i,0)}toggleDetails(t){this.selectedRequest&&this.selectedRequest._id===t._id?this.closeDetails():this.selectedRequest=t}closeDetails(){this.selectedRequest=null}trackByFn(t,n){return n.id||t}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(w.R),e.Y36(qn.r),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["hrm-requests"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:2,vars:3,consts:[["class","flex flex-col flex-auto min-w-0 sm:absolute sm:inset-0  bg-card dark:bg-transparent overflow-y-auto","cdkScrollable","",4,"ngIf"],["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"flex","items-center","ml-1","whitespace-nowrap"],["routerLink","/desktop",1,"ml-1","text-primary-500","hover:underline"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],[1,"fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-auto","sm:min-w-64","w-full"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],[4,"ngIf","ngIfElse"],["filter",""],["noRequests",""],[1,"flex","flex-col","flex-auto"],[4,"ngTemplateOutlet"],[1,"flex","flex-col","flex-auto","overflow-x-auto","lg:overflow-x-clip"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","requests-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,"text-right"],[1,"text-center"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-8","mr-1","text-right"],[4,"ngIf"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","requests-table","md:px-8"],[1,"whitespace-nowrap"],[1,"truncate","text-right"],[1,"truncate","text-center"],[1,"flex","h-[95%]","items-center","text-center","lock","truncate","rounded-full","dark:bg-white","dark:bg-opacity-5","mr-4","delay-100",3,"matTooltip","ngClass"],[1,"w-full","text-center"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"min-w-10","min-h-7","h-7","px-2","leading-6",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"routerLink"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"matTooltip","click"],[3,"selectedRequest","reject","isQuotationCreated"],[1,"self-end","h-10","mt-7","mb-3","md:mt-10","md:mb-5","pr-6","w-7/12","md:w-7/12","lg:w-6/12","xl:w-5/12","flex","justify-around"],[1,"flex","justify-center","items-center","mr-1","h-full","text-amber-700","transition-all","ease-in-out","delay-100","bg-amber-50","border-0","rounded-full","w-36","hover:bg-amber-500","hover:text-amber-50",3,"ngClass","click"],[1,"ml-2","mr-1","text-lg","hidden","md:block"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-amber-500","md:hidden"],[1,"flex","justify-center","items-center","mr-1","h-full","text-blue-700","transition-all","ease-in-out","delay-100","bg-blue-50","border-0","rounded-full","w-36","hover:bg-blue-500","hover:text-blue-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-blue-500","md:hidden"],[1,"flex","justify-center","items-center","h-full","text-red-700","transition-all","ease-in-out","delay-50","bg-red-100","border-0","rounded-full","w-36","hover:bg-red-500","hover:text-red-50",3,"ngClass","click"],[1,"w-1.5","h-1.5","sm:w-2.5","sm:h-2.5","rounded-full","bg-red-500","md:hidden"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.YNc(0,Zi,33,10,"div",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,n.requests$))},dependencies:[g.rH,g.yS,u.mk,u.sg,u.O5,u.tP,a.Fj,a.JJ,a.oH,U.PQ,C.lW,y.Hw,p.KE,p.qo,Q.Nt,k.NW,f.YE,f.nU,$.gM,ri,u.Ov,u.H9],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})();var xe=l(4290);function yi(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Agregar Unidad de Medida "),e.qZA())}function Ii(o,r){1&o&&(e.TgZ(0,"h2",7),e._uU(1," Editar Unidad de Medida "),e.qZA())}function Ti(o,r){if(1&o&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Nombre"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()()()()()()),2&o){const t=e.oxw();e.xp6(8),e.Oqu(t.data.uom.name||"Sin nombre")}}function qi(o,r){if(1&o&&(e.TgZ(0,"div",15)(1,"div",16)(2,"form",17)(3,"div",18)(4,"mat-form-field",19)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"input",20),e.qZA()(),e.TgZ(8,"div",18)(9,"mat-form-field",19)(10,"mat-label"),e._uU(11,"Sigla"),e.qZA(),e._UZ(12,"input",20),e.qZA()(),e.TgZ(13,"div",18)(14,"mat-form-field",19)(15,"mat-label"),e._uU(16,"Tipo"),e.qZA(),e.TgZ(17,"mat-select",21)(18,"mat-option",22),e._uU(19,"\xc1rea"),e.qZA(),e.TgZ(20,"mat-option",22),e._uU(21,"Conteo"),e.qZA(),e.TgZ(22,"mat-option",22),e._uU(23,"Energ\xeda"),e.qZA(),e.TgZ(24,"mat-option",22),e._uU(25,"Longitud"),e.qZA(),e.TgZ(26,"mat-option",22),e._uU(27,"Peso"),e.qZA(),e.TgZ(28,"mat-option",22),e._uU(29,"Volumen"),e.qZA(),e.TgZ(30,"mat-option",22),e._uU(31,"Tiempo"),e.qZA()()()(),e.TgZ(32,"div",23)(33,"span",24),e._uU(34,"Estado"),e.qZA(),e.TgZ(35,"mat-slide-toggle",25),e._uU(36),e.qZA()()()()()),2&o){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.uomForm)("autocomplete","off"),e.xp6(5),e.Q6J("formControlName","name")("placeholder","Nombre del Unidad de Medida"),e.xp6(5),e.Q6J("formControlName","abbr")("placeholder","Siglas"),e.xp6(5),e.Q6J("formControlName","type"),e.xp6(1),e.Q6J("value","area"),e.xp6(2),e.Q6J("value","conteo"),e.xp6(2),e.Q6J("value","energ\xeda"),e.xp6(2),e.Q6J("value","longitud"),e.xp6(2),e.Q6J("value","peso"),e.xp6(2),e.Q6J("value","volumen"),e.xp6(2),e.Q6J("value","tiempo"),e.xp6(5),e.Q6J("formControlName","active")("color","primary"),e.xp6(1),e.hij(" ",!0===t.uomForm.get("active").value?"Activo":"Inactivo"," ")}}function ki(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateUom())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function Ai(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.createUom())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&o){const t=e.oxw(2);e.xp6(1),e.Q6J("color","primary")("disabled",t.uomForm.invalid)("matDialogClose","confirmed")}}function wi(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26),e.ynx(2),e.TgZ(3,"button",27),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,ki,3,3,"ng-container",6),e.YNc(6,Ai,3,3,"ng-container",6),e.qZA(),e.BQk()),2&o){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Qi=(()=>{class o{constructor(t,n,i,s,c,d,F,D){this.data=t,this._changeDetectorRef=n,this._formBuilder=i,this._fuseConfirmationService=s,this._dialogRef=c,this._uomService=d,this._snackBar=F,this.store=D,this.dialogMode="view",this.user$=(0,T.of)(null),this.user=null,this._unsubscribeAll=new h.x,this.dialogMode=t.dialogMode,this.uom=t.uom}ngOnInit(){this.user$=this.store.select(b.rk),this.user$.pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.user=t,this._changeDetectorRef.markForCheck()}),this.store.select(A.Qs).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.currentMerchant=t}),this.uomForm=this._formBuilder.group({_id:[null],userId:[this.user._id,[a.kI.required]],merchantId:[this.currentMerchant._id,[a.kI.required]],active:[!0,[a.kI.required]],name:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]],abbr:[null,[a.kI.required,a.kI.maxLength(255)]],type:[null,[a.kI.required,a.kI.minLength(3),a.kI.maxLength(255)]]}),"edit"===this.dialogMode&&(this.uomForm.patchValue(this.uom),this.uomForm.get("merchantId").setValue(this.uom.merchantId._id))}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDialog(){this._dialogRef.close()}createUom(){let t=this.uomForm.getRawValue();t.slug=new S.i(t.name).slug,t=(0,ee.Z)(t,["_id"]),this._fuseConfirmationService.open({title:"Crear Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._uomService.createUom(t).pipe((0,m.R)(this._unsubscribeAll)).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}})}),this._changeDetectorRef.markForCheck()})}updateUom(){const t=this.uomForm.getRawValue();t.slug=new S.i(t.name).slug,this._fuseConfirmationService.open({title:"Actualizar Unidad de Medida",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._uomService.updateUom(t).pipe((0,m.R)(this._unsubscribeAll)).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()})})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(v.WI),e.Y36(e.sBO),e.Y36(a.QS),e.Y36(w.R),e.Y36(v.so),e.Y36(V.c),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom-dialog"]],decls:11,vars:5,consts:[[1,"relative","flex","flex-col","w-full","h-full","max-h-screenl"],[1,"flex","flex-col","items-center","px-8","pt-4","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","pb-6","sm:flex-row","sm:items-start","sm:pb-8"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","overflow-hidden"],[1,"flex","flex-col"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"py-5"],[1,"w-full","fuse-mat-no-subscript"],["matInput","","type","text","required","","maxlength","250",3,"formControlName","placeholder"],["required","",3,"formControlName"],[3,"value"],[1,"flex","flex-col","mt-4"],[1,"mb-4","font-medium"],[3,"formControlName","color"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-flat-button","",3,"color","disabled","matDialogClose","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,yi,2,0,"h2",2),e.YNc(4,Ii,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(5,"div",3),e.ynx(6),e.YNc(7,Ti,9,1,"div",4),e.BQk(),e.ynx(8),e.YNc(9,qi,37,17,"div",5),e.BQk(),e.qZA(),e.YNc(10,wi,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","add"===n.data.dialogMode),e.xp6(1),e.Q6J("ngIf","edit"===n.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===n.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===n.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==n.data.dialogMode))},dependencies:[u.O5,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.nD,a.sg,a.u,j.ey,C.lW,v.ZT,p.KE,p.hX,Q.Nt,W.gD,X.Rr],encapsulation:2}),o})();const Ui={_id:null,active:null,userId:null,merchantId:null,name:null,slug:null,abbr:null,type:null};function Ji(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",43),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:check"))}function Fi(o,r){1&o&&(e.ynx(0),e._UZ(1,"mat-icon",44),e.BQk()),2&o&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:x"))}function Di(o,r){if(1&o){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",35)(2,"div",36),e._uU(3),e.qZA(),e.TgZ(4,"div",37)(5,"div",38),e._uU(6),e.qZA()(),e.TgZ(7,"div",37)(8,"div",38),e._uU(9),e.qZA()(),e.TgZ(10,"div",39),e.YNc(11,Ji,2,1,"ng-container",23),e.YNc(12,Fi,2,1,"ng-container",23),e.qZA(),e.TgZ(13,"div",40)(14,"button",41),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.updateUom(s))}),e._UZ(15,"mat-icon",42),e.qZA(),e.TgZ(16,"button",41),e.NdJ("click",function(){const s=e.CHM(t).$implicit,c=e.oxw(4);return e.KtG(c.deleteUom(s._id))}),e._UZ(17,"mat-icon",42),e.qZA()()(),e.BQk()}if(2&o){const t=r.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.Oqu(t.abbr),e.xp6(3),e.Oqu(t.type),e.xp6(2),e.Q6J("ngIf",t.active),e.xp6(1),e.Q6J("ngIf",!t.active),e.xp6(2),e.Q6J("disabled",t.isDefault),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"),e.xp6(1),e.Q6J("disabled",t.isDefault),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash")}}function Si(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Di,18,9,"ng-container",34),e.BQk()),2&o){const t=r.ngIf,n=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",n.trackByFn)}}const Pi=function(o){return{"pointer-events-none":o}},Ni=function(){return[10,25,50,100]};function Mi(o,r){if(1&o&&(e.ynx(0),e.TgZ(1,"div",26)(2,"div",27)(3,"div",28),e._uU(4,"Nombre"),e.qZA(),e.TgZ(5,"div",29),e._uU(6," Siglas "),e.qZA(),e.TgZ(7,"div",30),e._uU(8," Tipo "),e.qZA(),e.TgZ(9,"div",31),e._uU(10," Activo "),e.qZA(),e.TgZ(11,"div",32),e._uU(12,"Acciones"),e.qZA()(),e.YNc(13,Si,2,2,"ng-container",23),e.ALo(14,"async"),e.qZA(),e._UZ(15,"mat-paginator",33),e.BQk()),2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("mat-sort-header","name"),e.xp6(4),e.Q6J("mat-sort-header","value"),e.xp6(2),e.Q6J("mat-sort-header","active"),e.xp6(4),e.Q6J("ngIf",e.lcZ(14,10,t.uoms$)),e.xp6(2),e.Q6J("ngClass",e.VKq(12,Pi,t.isLoading))("length",t.pagination.length)("pageIndex",t.pagination.page)("pageSize",t.pagination.size)("pageSizeOptions",e.DdM(14,Ni))("showFirstLastButtons",!0)}}function Ri(o,r){if(1&o&&(e.ynx(0),e.YNc(1,Mi,16,15,"ng-container",25),e.BQk()),2&o){const t=r.ngIf;e.oxw();const n=e.MAs(37);e.xp6(1),e.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Ei(o,r){if(1&o&&(e.TgZ(0,"div",45),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.Oqu(t.searchInputControl.value?"\xa1No se han encontrado unidades de medida!":"\xa1No se ha creado ninguna unidad de medida!")}}const Yi=[{path:"",component:Yt},{path:"uoms",component:(()=>{class o{constructor(t,n,i,s,c,d){this._changeDetectorRef=t,this._dialog=n,this._fuseConfirmationService=i,this._uomService=s,this._snackBar=c,this.store=d,this.flashMessage=null,this.uoms$=(0,T.of)([]),this.searchInputControl=new a.NI(""),this.isLoading=!1,this._unsubscribeAll=new h.x}ngOnInit(){this.uoms$=this.store.select(K.av),this.store.select(Y.B).pipe((0,m.R)(this._unsubscribeAll)).subscribe(t=>{this.pagination=t,this._changeDetectorRef.markForCheck()}),this.searchInputControl.valueChanges.pipe((0,m.R)(this._unsubscribeAll),(0,J.b)(300),(0,x.w)(t=>(this.isLoading=!0,this._uomService.getUoms(0,10,"name","asc",t))),(0,N.U)(()=>{this.isLoading=!1})).subscribe()}ngAfterViewInit(){this._sort&&this._paginator&&(this._sort.sort({id:"",start:"asc",disableClear:!0}),this._changeDetectorRef.markForCheck(),this._changeDetectorRef.markForCheck(),this._sort.sortChange.pipe((0,m.R)(this._unsubscribeAll)).subscribe(()=>{this._paginator.pageIndex=0}),(0,E.T)(this._sort.sortChange,this._paginator.page).pipe((0,x.w)(()=>(this.isLoading=!0,this._uomService.getUoms(this._paginator.pageIndex,this._paginator.pageSize,this._sort.active,this._sort.direction))),(0,N.U)(()=>{this.isLoading=!1})).subscribe())}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}createUom(){this._openDialog(Ui,"add")}updateUom(t){this._openDialog(t,"edit")}deleteUom(t){this._fuseConfirmationService.open({title:"Eliminar unidad de medida",message:"\xbfEsta seguro que desea Eliminar esta unidad de medida? Perder\xe1 el acceso a todos los datos asociados a la misma.",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(i=>{"confirmed"===i&&this._uomService.deleteUom(t,this.pagination.page,this.pagination.size,"active","desc",this.searchInputControl.value).subscribe(s=>{this._snackBar.openFromComponent(_.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:s.message,title:"Confirmaci\xf3n",type:"success",appearance:"fill"}}),this._changeDetectorRef.markForCheck()})})}trackByFn(t,n){return t||n.id}_openDialog(t,n){this._dialog.open(Qi,{data:{uom:t,dialogMode:n},panelClass:"ath-dialog-panel"})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(e.sBO),e.Y36(v.uw),e.Y36(w.R),e.Y36(V.c),e.Y36(q.ux),e.Y36(Z.yh))},o.\u0275cmp=e.Xpm({type:o,selectors:[["stock-uom"]],viewQuery:function(t,n){if(1&t&&(e.Gf(k.NW,5),e.Gf(f.YE,5)),2&t){let i;e.iGM(i=e.CRH())&&(n._paginator=i.first),e.iGM(i=e.CRH())&&(n._sort=i.first)}},decls:38,vars:12,consts:[[1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","bg-card","dark:bg-transparent","overflow-y-auto"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],["routerLink","/desktop",1,"whitespace-nowrap","text-primary-500"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],["routerLink","/modules/commercial",1,"ml-1","text-primary-500"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"mt-2","text-2xl","font-extrabold","leading-tight","tracking-tight","sm:text-2xl"],[1,"flex","flex-wrap","items-center","mt-2","sm:mt-0","shrink-0","sm:mt-0","sm:ml-4"],[1,"mr-4","mt-4","sm:mt-0","fuse-mat-dense","fuse-mat-no-subscript","fuse-mat-rounded","min-w-64"],["matPrefix","",1,"icon-size-5",3,"svgIcon"],["matInput","",3,"formControl","autocomplete","placeholder"],["mat-raised-button","",1,"mt-4","sm:mt-0","text-white","bg-gradient-to-r","from-primary-500","to-primary-600","hover:to-primary-900","hover:shadow-lg",3,"click"],[3,"svgIcon"],[1,"hidden","ml-2","mr-1","text-white","sm:block"],[1,"flex","flex-auto"],[1,"flex","flex-col","flex-auto","overflow-x-auto","sm:overflow-x-clip"],[4,"ngIf"],["noUoms",""],[4,"ngIf","ngIfElse"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","gap-4","px-6","py-4","font-semibold","shadow","uom-table","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[3,"mat-sort-header"],[1,""],[1,"",3,"mat-sort-header"],[1,"flex","justify-center",3,"mat-sort-header"],[1,"pr-4","text-right"],[1,"z-10","border-b","sm:inset-x-0","sm:bottom-0","sm:border-t","sm:border-b-0","bg-gray-50","dark:bg-transparent",3,"ngClass","length","pageIndex","pageSize","pageSizeOptions","showFirstLastButtons"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","uom-table","md:px-8"],[1,"truncate"],[1,"items-center","flex"],[1,"min-w-4"],[1,"text-center","mr-4"],[1,"flex","justify-end","gap-2","flex-row"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"disabled","click"],[1,"icon-size-5",3,"svgIcon"],[1,"text-green-400","icon-size-5",3,"svgIcon"],[1,"text-gray-400","icon-size-5",3,"svgIcon"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Inicio"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Gesti\xf3n Comercial"),e.qZA()(),e.TgZ(12,"div",5),e._UZ(13,"mat-icon",6),e.TgZ(14,"a",8),e._uU(15,"Unidades de Medida"),e.qZA()()(),e.TgZ(16,"div",9)(17,"a",10),e._UZ(18,"mat-icon",6),e.TgZ(19,"span",11),e._uU(20,"Regresar"),e.qZA()()()(),e.TgZ(21,"div",12)(22,"h2",13),e._uU(23," Unidades de Medida "),e.qZA()()(),e.TgZ(24,"div",14)(25,"mat-form-field",15),e._UZ(26,"mat-icon",16)(27,"input",17),e.qZA(),e.TgZ(28,"button",18),e.NdJ("click",function(){return n.createUom()}),e._UZ(29,"mat-icon",19),e.TgZ(30,"span",20),e._uU(31,"Nueva"),e.qZA()()()(),e.TgZ(32,"div",21)(33,"div",22),e.YNc(34,Ri,2,2,"ng-container",23),e.ALo(35,"async"),e.YNc(36,Ei,2,1,"ng-template",null,24,e.W1O),e.qZA()()()),2&t&&(e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(8),e.Q6J("svgIcon","heroicons_solid:search"),e.xp6(1),e.Q6J("formControl",n.searchInputControl)("autocomplete","off")("placeholder","Buscar unidades"),e.xp6(2),e.Q6J("svgIcon","heroicons_outline:plus"),e.xp6(5),e.Q6J("ngIf",e.lcZ(35,10,n.uoms$)))},dependencies:[g.yS,u.mk,u.sg,u.O5,a.Fj,a.JJ,a.oH,C.lW,y.Hw,p.KE,p.qo,Q.Nt,k.NW,f.YE,f.nU,u.Ov],encapsulation:2,data:{animation:M.L},changeDetection:0}),o})(),resolve:{uoms:(()=>{class o{constructor(t){this._uomService=t}resolve(t,n){return this._uomService.getUoms()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(V.c))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}},{path:"request",component:Ci,resolve:{requests:xe.r}},{path:"request/:requestId",component:In,resolve:{request:xe.N}},{path:"payment-methods",component:jo,resolve:{paymentMethod:Go}},{path:"quotations",component:Zn,resolve:{quotations:ge.S}},{path:"quotations/:quotationId",component:Ko,resolve:{quotation:ge.x}},{path:"invoices",component:go,resolve:{quotations:ce.l}},{path:"invoices/:invoiceId",component:zt,resolve:{quotation:ce.u}}];var Bi=l(6863),Li=l(6826);let Oi=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[g.Bz.forChild(Yi),Rt,Bi.K,Li.b,z.m]}),o})()}}]);