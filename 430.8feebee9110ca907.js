"use strict";(self.webpackChunkatherp=self.webpackChunkatherp||[]).push([[430],{4430:(ho,Y,a)=>{a.r(Y),a.d(Y,{RolesModule:()=>po});var B=a(5357),Ze=a(2504),p=a(3075),be=a(6087),D=a(4847),G=a(7579),$=a(9646),y=a(2722),Ce=a(8372),ye=a(3900),Ae=a(8288),S=a(8966),Te=a(7585),Ie=a(139),M=a(4157);var H=a(8706);const q=function Fe(n,o){return function(t,i){if(null==t)return t;if(!(0,H.Z)(t))return n(t,i);for(var s=t.length,r=o?s:-1,l=Object(t);(o?r--:++r<s)&&!1!==i(l[r],r,l););return t}}(function we(n,o){return n&&(0,Ie.Z)(n,o,M.Z)});var K=a(9940);var b=a(4177);const A=function Oe(n,o){return((0,b.Z)(n)?Te.Z:q)(n,function Se(n){return"function"==typeof n?n:K.Z}(o))};var T=a(5343),Ee=a(3639);function I(n){var o=-1,t=null==n?0:n.length;for(this.__data__=new Ee.Z;++o<t;)this.add(n[o])}I.prototype.add=I.prototype.push=function Qe(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this},I.prototype.has=function Ue(n){return this.__data__.has(n)};const Ye=I,W=function Be(n,o){for(var t=-1,i=null==n?0:n.length;++t<i;)if(o(n[t],t,n))return!0;return!1},$e=function Ge(n,o){return n.has(o)},z=function Ke(n,o,t,i,s,r){var l=1&t,c=n.length,d=o.length;if(c!=d&&!(l&&d>c))return!1;var g=r.get(n),f=r.get(o);if(g&&f)return g==o&&f==n;var u=-1,m=!0,x=2&t?new Ye:void 0;for(r.set(n,o),r.set(o,n);++u<c;){var h=n[u],_=o[u];if(i)var v=l?i(_,h,u,o,n,r):i(h,_,u,n,o,r);if(void 0!==v){if(v)continue;m=!1;break}if(x){if(!W(o,function(R,Z){if(!$e(x,Z)&&(h===R||s(h,R,t,i,r)))return x.push(Z)})){m=!1;break}}else if(h!==_&&!s(h,_,t,i,r)){m=!1;break}}return r.delete(n),r.delete(o),m};var X=a(8492),k=a(1630),We=a(3093);const Xe=function ze(n){var o=-1,t=Array(n.size);return n.forEach(function(i,s){t[++o]=[s,i]}),t},je=function ke(n){var o=-1,t=Array(n.size);return n.forEach(function(i){t[++o]=i}),t};var j=X.Z?X.Z.prototype:void 0,O=j?j.valueOf:void 0;var V=a(8501),_n=Object.prototype.hasOwnProperty;var ee=a(4116),ne=a(5202),Rn=a(7583),te="[object Arguments]",oe="[object Array]",w="[object Object]",ie=Object.prototype.hasOwnProperty;const yn=function Cn(n,o,t,i,s,r){var l=(0,b.Z)(n),c=(0,b.Z)(o),d=l?oe:(0,ee.Z)(n),g=c?oe:(0,ee.Z)(o),f=(d=d==te?w:d)==w,u=(g=g==te?w:g)==w,m=d==g;if(m&&(0,ne.Z)(n)){if(!(0,ne.Z)(o))return!1;l=!0,f=!1}if(m&&!f)return r||(r=new T.Z),l||(0,Rn.Z)(n)?z(n,o,t,i,s,r):function gn(n,o,t,i,s,r,l){switch(t){case"[object DataView]":if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=o.byteLength||!r(new k.Z(n),new k.Z(o)));case"[object Boolean]":case"[object Date]":case"[object Number]":return(0,We.Z)(+n,+o);case"[object Error]":return n.name==o.name&&n.message==o.message;case"[object RegExp]":case"[object String]":return n==o+"";case"[object Map]":var c=Xe;case"[object Set]":if(c||(c=je),n.size!=o.size&&!(1&i))return!1;var g=l.get(n);if(g)return g==o;i|=2,l.set(n,o);var f=z(c(n),c(o),i,s,r,l);return l.delete(n),f;case"[object Symbol]":if(O)return O.call(n)==O.call(o)}return!1}(n,o,d,t,i,s,r);if(!(1&t)){var x=f&&ie.call(n,"__wrapped__"),h=u&&ie.call(o,"__wrapped__");if(x||h){var _=x?n.value():n,v=h?o.value():o;return r||(r=new T.Z),s(_,v,t,i,r)}}return!!m&&(r||(r=new T.Z),function xn(n,o,t,i,s,r){var l=1&t,c=(0,V.Z)(n),d=c.length;if(d!=(0,V.Z)(o).length&&!l)return!1;for(var u=d;u--;){var m=c[u];if(!(l?m in o:_n.call(o,m)))return!1}var x=r.get(n),h=r.get(o);if(x&&h)return x==o&&h==n;var _=!0;r.set(n,o),r.set(o,n);for(var v=l;++u<d;){var R=n[m=c[u]],Z=o[m];if(i)var Re=l?i(Z,R,m,o,n,r):i(R,Z,m,n,o,r);if(!(void 0===Re?R===Z||s(R,Z,t,i,r):Re)){_=!1;break}v||(v="constructor"==m)}if(_&&!v){var P=n.constructor,F=o.constructor;P!=F&&"constructor"in n&&"constructor"in o&&!("function"==typeof P&&P instanceof P&&"function"==typeof F&&F instanceof F)&&(_=!1)}return r.delete(n),r.delete(o),_}(n,o,t,i,s,r))};var se=a(214);const ae=function re(n,o,t,i,s){return n===o||(null==n||null==o||!(0,se.Z)(n)&&!(0,se.Z)(o)?n!=n&&o!=o:yn(n,o,t,i,re,s))};var E=a(1999);const le=function Pn(n){return n==n&&!(0,E.Z)(n)},ce=function Sn(n,o){return function(t){return null!=t&&t[n]===o&&(void 0!==o||n in Object(t))}},On=function Mn(n){var o=function Fn(n){for(var o=(0,M.Z)(n),t=o.length;t--;){var i=o[t],s=n[i];o[t]=[i,s,le(s)]}return o}(n);return 1==o.length&&o[0][2]?ce(o[0][0],o[0][1]):function(t){return t===n||function In(n,o,t,i){var s=t.length,r=s,l=!i;if(null==n)return!r;for(n=Object(n);s--;){var c=t[s];if(l&&c[2]?c[1]!==n[c[0]]:!(c[0]in n))return!1}for(;++s<r;){var d=(c=t[s])[0],g=n[d],f=c[1];if(l&&c[2]){if(void 0===g&&!(d in n))return!1}else{var u=new T.Z;if(i)var m=i(g,f,d,n,o,u);if(!(void 0===m?ae(f,g,3,i,u):m))return!1}}return!0}(t,n,o)}};var de=a(7298);const Jn=function Qn(n,o){return null!=n&&o in Object(n)};var Un=a(7370),Ln=a(4825),Yn=a(6667),Bn=a(8696),N=a(2168);const qn=function Hn(n,o){return null!=n&&function Gn(n,o,t){for(var i=-1,s=(o=(0,Un.Z)(o,n)).length,r=!1;++i<s;){var l=(0,N.Z)(o[i]);if(!(r=null!=n&&t(n,l)))break;n=n[l]}return r||++i!=s?r:!!(s=null==n?0:n.length)&&(0,Bn.Z)(s)&&(0,Yn.Z)(l,s)&&((0,b.Z)(n)||(0,Ln.Z)(n))}(n,o,Jn)};var fe=a(3660);const Xn=function zn(n,o){return(0,fe.Z)(n)&&le(o)?ce((0,N.Z)(n),o):function(t){var i=function En(n,o,t){var i=null==n?void 0:(0,de.Z)(n,o);return void 0===i?t:i}(t,n);return void 0===i&&i===o?qn(t,n):ae(o,i,3)}},tt=function nt(n){return(0,fe.Z)(n)?function kn(n){return function(o){return null==o?void 0:o[n]}}((0,N.Z)(n)):function Vn(n){return function(o){return(0,de.Z)(o,n)}}(n)},Q=function ot(n){return"function"==typeof n?n:null==n?K.Z:"object"==typeof n?(0,b.Z)(n)?Xn(n[0],n[1]):On(n):tt(n)};var lt=/\s/;var ft=/^\s+/;const gt=function mt(n){return n&&n.slice(0,function ct(n){for(var o=n.length;o--&&lt.test(n.charAt(o)););return o}(n)+1).replace(ft,"")};var ut=a(6460),pt=/^[-+]0x[0-9a-f]+$/i,ht=/^0b[01]+$/i,_t=/^0o[0-7]+$/i,xt=parseInt;const Ct=function bt(n){return n?1/0===(n=function vt(n){if("number"==typeof n)return n;if((0,ut.Z)(n))return NaN;if((0,E.Z)(n)){var o="function"==typeof n.valueOf?n.valueOf():n;n=(0,E.Z)(o)?o+"":o}if("string"!=typeof n)return 0===n?n:+n;n=gt(n);var t=ht.test(n);return t||_t.test(n)?xt(n.slice(2),t?2:8):pt.test(n)?NaN:+n}(n))||-1/0===n?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0};var Tt=Math.max;const ue=function it(n){return function(o,t,i){var s=Object(o);if(!(0,H.Z)(o)){var r=Q(t);o=(0,M.Z)(o),t=function(c){return r(s[c],c,s)}}var l=n(o,t,i);return l>-1?s[r?o[l]:l]:void 0}}(function It(n,o,t){var i=null==n?0:n.length;if(!i)return-1;var s=null==t?0:function yt(n){var o=Ct(n),t=o%1;return o==o?t?o-t:o:0}(t);return s<0&&(s=Tt(i+s,0)),function rt(n,o,t,i){for(var s=n.length,r=t+(i?1:-1);i?r--:++r<s;)if(o(n[r],r,n))return r;return-1}(n,Q(o),s)}),Ft=function Pt(n,o){var t;return q(n,function(i,s,r){return!(t=o(i,s,r))}),!!t};var Dt=a(4810);var Ot=a(5119);class J{clear(){this._id=null,this.name="",this.permissions=[],this.isCoreRole=!1,this.checked=!1}}class pe{clear(){this._id=void 0,this.title="",this.level=1,this.parentId=void 0,this.isSelected=!1,this.name="",this._children=[]}}var he=a(9784),e=a(5e3),_e=a(1683),U=a(1349),Et=a(7261),C=a(9808),xe=a(7423),Nt=a(7446),ve=a(5245),L=a(7322),Qt=a(7531);function Jt(n,o){1&n&&(e.TgZ(0,"h2",7),e._uU(1," Agregar rol "),e.qZA())}function Ut(n,o){1&n&&(e.TgZ(0,"h2",7),e._uU(1," Editar rol "),e.qZA())}function Lt(n,o){1&n&&(e.TgZ(0,"h2",7),e._uU(1," Detalles del rol "),e.qZA())}function Yt(n,o){if(1&n&&(e.TgZ(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h6",13),e._uU(6,"Title"),e.qZA(),e.TgZ(7,"span",14),e._uU(8),e.qZA()(),e.TgZ(9,"div",15)(10,"h6",13),e._uU(11,"Descripci\xf3n"),e.qZA(),e.TgZ(12,"span",14),e._uU(13),e.qZA()()()()()()),2&n){const t=e.oxw();e.xp6(8),e.Oqu(t.data.role.name||"Sin nombre"),e.xp6(5),e.Oqu(t.data.role.description||"Sin descripci\xf3n")}}function Bt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",36)(1,"span")(2,"mat-checkbox",37),e.NdJ("ngModelChange",function(s){const l=e.CHM(t).$implicit;return e.KtG(l.isSelected=s)})("change",function(s){const l=e.CHM(t).$implicit,c=e.oxw(3);return e.KtG(c.isSelectedChanged(s,l))}),e._uU(3),e.qZA()()()}if(2&n){const t=o.$implicit,i=e.oxw(3);e.xp6(2),e.Q6J("color","primary")("ngModel",t.isSelected)("disabled",i.singleRole.isCoreRole),e.xp6(1),e.hij(" ",t.title," ")}}function Gt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",31)(1,"div",32)(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"mat-checkbox",33),e.NdJ("ngModelChange",function(s){const l=e.CHM(t).$implicit;return e.KtG(l.isSelected=s)})("change",function(s){const l=e.CHM(t).$implicit,c=e.oxw(2);return e.KtG(c.isSelectedChanged(s,l))}),e.qZA()(),e.TgZ(5,"div",34),e.YNc(6,Bt,4,4,"div",35),e.qZA()()}if(2&n){const t=o.$implicit,i=e.oxw(2);e.xp6(3),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngModel",t.isSelected)("disabled",i.singleRole.isCoreRole),e.xp6(2),e.Q6J("ngForOf",t._children)}}function $t(n,o){if(1&n&&(e.TgZ(0,"div",16)(1,"div",17)(2,"form",18)(3,"div",19)(4,"mat-form-field",20)(5,"mat-label"),e._uU(6,"Nombre"),e.qZA(),e._UZ(7,"mat-icon",21)(8,"input",22),e.qZA()(),e.TgZ(9,"div",23)(10,"mat-form-field",20)(11,"mat-label"),e._uU(12,"Descripc\xf3n"),e.qZA(),e._UZ(13,"mat-icon",24)(14,"textarea",25),e.qZA()()(),e.TgZ(15,"div",26)(16,"div",27)(17,"mat-label",28),e._uU(18,"Permisos"),e.qZA()(),e.TgZ(19,"div",29),e.YNc(20,Gt,7,4,"div",30),e.qZA()()()()),2&n){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.roleForm)("autocomplete","off"),e.xp6(5),e.Q6J("svgIcon","heroicons_outline:pencil-alt"),e.xp6(1),e.Q6J("type","text")("formControlName","name")("placeholder","Nombre del rol")("disabled",t.singleRole.static),e.xp6(5),e.Q6J("svgIcon","heroicons_solid:menu-alt-2"),e.xp6(1),e.Q6J("formControlName","description")("rows",3)("spellcheck",!1),e.xp6(6),e.Q6J("ngForOf",t.rolePermissions)}}function Ht(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",40),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.updateRole())}),e._uU(2," Actualizar "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",t.roleForm.disabled||t.roleForm.invalid)("color","primary")("matDialogClose","confirmed")}}function qt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",40),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.createRole())}),e._uU(2," Agregar "),e.qZA(),e.BQk()}if(2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("disabled",t.roleForm.disabled||t.roleForm.invalid)("color","primary")("matDialogClose","confirmed")}}function Kt(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",38),e.ynx(2),e.TgZ(3,"button",39),e._uU(4," Cancelar "),e.qZA(),e.BQk(),e.YNc(5,Ht,3,3,"ng-container",6),e.YNc(6,qt,3,3,"ng-container",6),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("matDialogClose","cancelled"),e.xp6(2),e.Q6J("ngIf","edit"===t.data.dialogMode),e.xp6(1),e.Q6J("ngIf","add"===t.data.dialogMode)}}let Wt=(()=>{class n{constructor(t,i,s,r,l,c){this.data=t,this._changeDetectorRef=i,this._formBuilder=s,this._fuseConfirmationService=r,this._roleService=l,this._snackBar=c,this.singleRole=new J,this.dialogMode="view",this.rolePermissions=[],this._unsubscribeAll=new G.x}ngOnInit(){this.singleRole.clear(),this.roleForm=this._formBuilder.group({_id:[""],isCoreRole:[!1],name:["",[p.kI.required]],description:["",[p.kI.required,p.kI.minLength(8)]]}),"edit"===this.data.dialogMode&&(this.singleRole=this.data.singleRole,this.roleForm.patchValue(this.data.singleRole)),this.allPermissions$=this._roleService.permissions$,this.loadPermissions()}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}loadPermissions(){this.allPermissions$.subscribe(t=>{t&&t.filter(s=>s.parentId===s._id).forEach(s=>{const r=this.singleRole.permissions.some(d=>d===s._id),l=new pe;l.clear(),l.isSelected=r,l._children=[],l._id=s._id,l.level=s.level,l.parentId=s.parentId,l.title=s.title,t.filter(d=>d.parentId&&d.parentId===s._id).forEach(d=>{if(d._id!==d.parentId){const g=this.singleRole.permissions.some(u=>u===d._id),f=new pe;f.clear(),f.isSelected=g,f._children=[],f._id=d._id,f.level=d.level,f.parentId=d.parentId,f.title=d.title,l._children.push(f)}}),this.rolePermissions.push(l)})})}preparePermissionIds(){const t=[];return A(this.rolePermissions,i=>{i.isSelected&&(t.push(i._id),A(i._children,s=>{s.isSelected&&t.push(s._id)}))}),t}prepareRole(){const t=new J;return t._id=this.singleRole._id,t.permissions=this.preparePermissionIds(),t.name=this.singleRole.name,t.isCoreRole=this.singleRole.isCoreRole,t}isSelectedChanged(t,i){if(0===i._children.length&&i.isSelected){const s=ue(this.rolePermissions,r=>r._id===i.parentId);s&&!s.isSelected&&(s.isSelected=!0)}else if(0!==i._children.length||i.isSelected)i._children.length>0&&i.isSelected?A(i._children,s=>s.isSelected=!0):i._children.length>0&&!i.isSelected&&A(i._children,s=>{s.isSelected=!1});else{const s=ue(this.rolePermissions,r=>r._id===i.parentId);s&&s.isSelected&&(function St(n,o,t){var i=(0,b.Z)(n)?W:Ft;return t&&(0,Dt.Z)(n,o,t)&&(o=void 0),i(n,Q(o))}(s._children,r=>!0===r.isSelected)||(s.isSelected=!1))}}createRole(){let t=this.roleForm.getRawValue();t=(0,Ot.Z)(t,"id"),t.permissions=this.prepareRole().permissions,this._fuseConfirmationService.open({title:"Crear Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._roleService.createRole(t).pipe((0,y.R)(this._unsubscribeAll)).subscribe(r=>{this._snackBar.openFromComponent(he.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Rol creado correctamente",title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()},r=>{console.log(r)}),this._changeDetectorRef.markForCheck()})}updateRole(){const t=this.roleForm.getRawValue();t.permissions=this.prepareRole().permissions,this._fuseConfirmationService.open({title:"Actualizar Rol",message:"\xbfEsta seguro que toda la informaci\xf3n es correcta?",icon:{show:!0,name:"heroicons_outline:question-mark-circle",color:"info"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._roleService.updateRole(t).pipe((0,y.R)(this._unsubscribeAll)).subscribe(r=>{this._snackBar.openFromComponent(he.h,{panelClass:["p-0","bg-transparent"],horizontalPosition:"end",verticalPosition:"bottom",duration:5e3,data:{message:"Rol actualizado correctamente",title:"Confirmaci\xf3n",type:"success",svgIcon:"heroicons_solid:check"}}),this._changeDetectorRef.markForCheck()},r=>{console.log(r)}),this._changeDetectorRef.markForCheck()})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(S.WI),e.Y36(e.sBO),e.Y36(p.QS),e.Y36(_e.R),e.Y36(U.N),e.Y36(Et.ux))},n.\u0275cmp=e.Xpm({type:n,selectors:[["roles-dialog"]],decls:12,vars:6,consts:[["athScrollbar","",1,"relative","flex","flex-col","w-full","h-full","max-h-screen"],[1,"flex","flex-col","items-center","px-8","pt-4","pb-6","space-y-1","text-center","sm:items-start","sm:mt-0","sm:pr-8","sm:pb-6","sm:text-left"],["class","text-2xl text-gray-400",4,"ngIf"],[1,"flex","flex-col","items-center","flex-auto","w-full","px-8","sm:flex-row","sm:items-start"],["class","flex-auto",4,"ngIf"],["class","w-full overflow-hidden",4,"ngIf"],[4,"ngIf"],[1,"text-2xl","text-gray-400"],[1,"flex-auto"],[1,"flex"],[1,"flex","flex-col","w-full","mt-5"],[1,"flex","flex-col","p-8","pb-0","sm:flex-row"],[1,"w-full","py-10","my-10"],[1,"mb-2","font-medium"],[1,"border-sm"],[1,"w-full","pb-4","my-10"],[1,"w-full","overflow-hidden"],[1,"flex",2,"flex-direction","column"],[1,"flex","flex-col","w-full","mt-1",3,"formGroup","autocomplete"],[1,"sm:col-span-3"],[1,"w-full","fuse-mat-no-subscript"],[1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","required","",2,"margin-left","6px",3,"type","formControlName","placeholder","disabled"],[1,"py-5","sm:col-span-2"],["matPrefix","",1,"hidden","sm:flex","icon-size-5",3,"svgIcon"],["matInput","","matTextareaAutosize","","required","",3,"formControlName","rows","spellcheck"],[2,"margin-top","10px","margin-bottom","20px"],[2,"margin-bottom","12px"],[1,"font-medium"],[2,"border-width","1.5px","border-radius","6px","--tw-border-opacity","1 !important","border-color","#3bbf44","padding","20px 25px 0 20px","--tw-shadow","0 0 #f000","box-shadow","0 4px 8px 0 rgba(0, 0, 0, 0.02)"],["class","mb-4","style","display: grid;\n                            grid-template-columns: 150px auto;",4,"ngFor","ngForOf"],[1,"mb-4",2,"display","grid","grid-template-columns","150px auto"],[1,"mt-2",2,"display","flex","justify-content","space-between"],[3,"ngModel","disabled","ngModelChange","change"],[2,"display","flex","flex-wrap","wrap","justify-content","space-between"],["class","mt-2","style","display: flex; justify-content: space-around;",4,"ngFor","ngForOf"],[1,"mt-2",2,"display","flex","justify-content","space-around"],[2,"opacity","0.8",3,"color","ngModel","disabled","ngModelChange","change"],[1,"flex","items-center","justify-center","px-6","py-4","space-x-3","sm:justify-end","bg-gray-50","dark:bg-black","dark:bg-opacity-10"],["mat-stroked-button","",3,"matDialogClose"],["mat-raised-button","",1,"text-white","bg-primary-500",3,"disabled","color","matDialogClose","click"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0),e.ynx(1),e.TgZ(2,"div",1),e.YNc(3,Jt,2,0,"h2",2),e.YNc(4,Ut,2,0,"h2",2),e.YNc(5,Lt,2,0,"h2",2),e.qZA(),e.BQk(),e.TgZ(6,"div",3),e.ynx(7),e.YNc(8,Yt,14,2,"div",4),e.BQk(),e.ynx(9),e.YNc(10,$t,21,12,"div",5),e.BQk(),e.qZA(),e.YNc(11,Kt,7,3,"ng-container",6),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf",null===i.data.singleRole._id&&"add"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf",i.data.singleRole._id&&"edit"===i.data.dialogMode),e.xp6(1),e.Q6J("ngIf",i.data.singleRole._id&&"view"===i.data.dialogMode),e.xp6(3),e.Q6J("ngIf","view"===i.data.dialogMode),e.xp6(2),e.Q6J("ngIf","edit"===i.data.dialogMode||"add"),e.xp6(1),e.Q6J("ngIf","view"!==i.data.dialogMode))},dependencies:[C.sg,C.O5,p._Y,p.Fj,p.JJ,p.JL,p.Q7,p.On,p.sg,p.u,xe.lW,Nt.oG,S.ZT,ve.Hw,L.KE,L.hX,L.qo,Qt.Nt],encapsulation:2,changeDetection:0}),n})();var zt=a(2729),Xt=a(5620),kt=a(393),jt=a(7238),Vt=a(1235);function eo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.createRole())}),e._UZ(1,"mat-icon",20),e.TgZ(2,"span",21),e._uU(3,"Nuevo"),e.qZA()()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_outline:plus"))}function no(n,o){1&n&&e._UZ(0,"mat-icon",33),2&n&&e.Q6J("color","primary")}function to(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,r=e.oxw(3);return e.KtG(r.updateRole(s))}),e._UZ(1,"mat-icon",38),e.qZA()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:pencil"))}function oo(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",37),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(3).$implicit,r=e.oxw(3);return e.KtG(r.deleteRole(s))}),e._UZ(1,"mat-icon",38),e.qZA()}2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:trash"))}function io(n,o){1&n&&(e.TgZ(0,"div"),e.YNc(1,oo,2,1,"button",35),e.qZA()),2&n&&(e.xp6(1),e.Q6J("ngxPermissionsOnly","RolesPermissionsDelete"))}function so(n,o){1&n&&(e.TgZ(0,"button",39),e._UZ(1,"mat-icon",38),e.qZA()),2&n&&(e.xp6(1),e.Q6J("svgIcon","heroicons_solid:eye"))}const ro=function(){return["RolesPermissionsUpdate","RolesPermissionsDelete"]};function ao(n,o){if(1&n&&(e.TgZ(0,"div",34),e.YNc(1,to,2,1,"button",35),e.YNc(2,io,2,1,"div",26),e.YNc(3,so,2,1,"button",36),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngxPermissionsOnly","RolesPermissionsUpdate"),e.xp6(1),e.Q6J("ngIf",!t.static),e.xp6(1),e.Q6J("ngxPermissionsExcept",e.DdM(3,ro))}}function lo(n,o){1&n&&(e.TgZ(0,"div",34)(1,"button",39),e._UZ(2,"mat-icon",38),e.qZA()()),2&n&&(e.xp6(2),e.Q6J("svgIcon","heroicons_solid:eye"))}function co(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",28)(2,"div",29),e.YNc(3,no,1,1,"mat-icon",30),e._uU(4),e.qZA(),e.TgZ(5,"div",31),e._uU(6),e.qZA(),e.YNc(7,ao,4,4,"div",32),e.YNc(8,lo,3,1,"div",32),e.qZA(),e.BQk()),2&n){const t=o.$implicit;e.xp6(3),e.Q6J("ngIf",t.isCoreRole),e.xp6(1),e.hij(" ",t.name," "),e.xp6(2),e.hij(" ",t.description," "),e.xp6(1),e.Q6J("ngIf",!t.isCoreRole),e.xp6(1),e.Q6J("ngIf",t.isCoreRole)}}function fo(n,o){if(1&n&&(e.ynx(0),e.YNc(1,co,9,5,"ng-container",27),e.BQk()),2&n){const t=o.ngIf,i=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t)("ngForTrackBy",i.trackByFn)}}function mo(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",22)(2,"div",23)(3,"div",24),e._uU(4," Nombre "),e.qZA(),e.TgZ(5,"div"),e._uU(6,"Descripci\xf3n"),e.qZA(),e.TgZ(7,"div",25),e._uU(8,"Acci\xf3n"),e.qZA()(),e.YNc(9,fo,2,2,"ng-container",26),e.ALo(10,"async"),e.qZA(),e.BQk()),2&n){const t=e.oxw();e.xp6(3),e.Q6J("mat-sort-header","date"),e.xp6(6),e.Q6J("ngIf",e.lcZ(10,2,t.role$))}}function go(n,o){1&n&&(e.TgZ(0,"div",40),e._uU(1," \xa1A\xfan ha creado ning\xfan rol a\xfan! "),e.qZA())}const uo=[{path:"",component:(()=>{class n{constructor(t,i,s,r,l){this._changeDetectorRef=t,this._fuseConfirmationService=i,this._roleService=s,this.dialog=r,this.store=l,this.emptyRole=new J,this.flashMessage=null,this.isLoading=!1,this.searchInputControl=new p.p4,this.selectedRole=null,this._unsubscribeAll=new G.x}ngOnInit(){this.emptyRole.clear(),this.role$=this.store.select(zt.g),this.searchInputControl.valueChanges.pipe((0,y.R)(this._unsubscribeAll),(0,Ce.b)(200),(0,ye.w)(t=>(this.closeDetails(),this.isLoading=!0,this.role$.pipe((0,y.R)(this._unsubscribeAll)).subscribe(i=>{this.role$=(0,$.of)(i.filter(s=>s.name.toLowerCase().includes(t.toLowerCase()))),this.isLoading=!1}),(0,$.of)(t)))).subscribe()}ngAfterViewInit(){}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}closeDetails(){this.selectedRole=null}createRole(){this.openDialog(this.emptyRole,"add")}updateRole(t){this.openDialog(t,"edit")}deleteRole(t){this._fuseConfirmationService.open({title:"Eliminar Rol",message:"\xbfEsta seguro que desea eliminar este rol?",icon:{show:!0,name:"heroicons_outline:exclamation",color:"warning"},actions:{confirm:{label:"Aceptar",color:"primary"}}}).afterClosed().subscribe(s=>{"confirmed"===s&&this._roleService.deleteRole(t._id).subscribe(()=>{this._fuseConfirmationService.open({title:"Rol eliminada correctamente",message:"",icon:{show:!0,name:"heroicons_outline:check",color:"success"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1}),this._changeDetectorRef.markForCheck()},r=>{this._fuseConfirmationService.open({title:`${r.statusText}: ${r.status}`,message:r.error.message,icon:{show:!0,name:"heroicons_outline:exclamation-circle",color:"error"},actions:{confirm:{show:!0,label:"Ok",color:"primary"},cancel:{show:!1}},dismissible:!1})}),this._changeDetectorRef.markForCheck()})}showFlashMessage(t){this.flashMessage=t,this._changeDetectorRef.markForCheck(),setTimeout(()=>{this.flashMessage=null,this._changeDetectorRef.markForCheck()},3e3)}trackByFn(t,i){return t||i.id}openDialog(t,i){this.dialog.open(Wt,{maxWidth:"750px",minWidth:"200px",height:"90%",data:{singleRole:t,dialogMode:i},panelClass:"ath-dialog-panel"})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.sBO),e.Y36(_e.R),e.Y36(U.N),e.Y36(S.uw),e.Y36(Xt.yh))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ath-roles"]],viewQuery:function(t,i){if(1&t&&(e.Gf(be.NW,5),e.Gf(D.YE,5)),2&t){let s;e.iGM(s=e.CRH())&&(i._paginator=s.first),e.iGM(s=e.CRH())&&(i._sort=s.first)}},decls:27,vars:6,consts:[["cdkScrollable","",1,"flex","flex-col","flex-auto","min-w-0","sm:absolute","sm:inset-0","sm:overflow-hidden","bg-card","dark:bg-transparent"],[1,"relative","flex","flex-col","px-6","py-8","border-b","sm:flex-row","flex-0","sm:items-center","sm:justify-between","md:px-8"],[1,"flex-1","min-w-0"],[1,"flex-wrap","items-center","hidden","font-medium","sm:flex"],[1,"whitespace-nowrap","text-primary-700"],[1,"flex","items-center","ml-1","whitespace-nowrap"],[1,"icon-size-5","text-secondary",3,"svgIcon"],[1,"ml-1","text-primary-500"],[1,"flex","sm:hidden"],[1,"inline-flex","items-center","-ml-1.5","text-secondary","font-medium",3,"routerLink"],[1,"ml-1"],[1,"mt-2"],[1,"text-3xl","font-extrabold","leading-7","tracking-tight","truncate","md:text-4xl","sm:leading-10"],[1,"flex","items-center","flex-shrink-0","mt-6","sm:mt-0","sm:ml-4"],["mat-raised-button","","class","ml-4 text-white bg-primary-500","mat-button","",3,"click",4,"ngxPermissionsOnly"],[1,"flex","flex-auto","overflow-hidden"],[1,"flex","flex-col","flex-auto","overflow-hidden","sm:mb-18","sm:overflow-y-auto"],[4,"ngIf","ngIfElse"],["noRoles",""],["mat-raised-button","","mat-button","",1,"ml-4","text-white","bg-primary-500",3,"click"],[3,"svgIcon"],[1,"ml-2","mr-1"],[1,"grid"],["matSort","","matSortDisableClear","",1,"sticky","top-0","z-10","grid","roles-grid","role-table","gap-4","px-6","py-4","font-semibold","shadow","md:px-8","text-md","text-secondary","bg-gray-50","dark:bg-black","dark:bg-opacity-5"],[1,"hidden","sm:block",3,"mat-sort-header"],[1,"text-center"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"grid","items-center","gap-4","px-6","py-3","border-b","roles-grid","role-table","md:px-8"],[1,"truncate","flex"],["svgIcon","heroicons_solid:fire","class","mr-1",3,"color",4,"ngIf"],[1,"truncate"],["style","justify-content: center;","class","flex flex-row gap-2",4,"ngIf"],["svgIcon","heroicons_solid:fire",1,"mr-1",3,"color"],[1,"flex","flex-row","gap-2",2,"justify-content","center"],["class","px-2 leading-6  min-w-10 min-h-7 h-7","mat-stroked-button","",3,"click",4,"ngxPermissionsOnly"],["disabled","","class","px-2 leading-6 min-w-10 min-h-7 h-7","mat-stroked-button","","matTooltip","Proximamente",4,"ngxPermissionsExcept"],["mat-stroked-button","",1,"px-2","leading-6","min-w-10","min-h-7","h-7",3,"click"],[1,"icon-size-5",3,"svgIcon"],["disabled","","mat-stroked-button","","matTooltip","Proximamente",1,"px-2","leading-6","min-w-10","min-h-7","h-7"],[1,"p-8","text-4xl","font-semibold","tracking-tight","text-center","border-t","sm:p-16"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"div",3)(5,"div")(6,"a",4),e._uU(7,"Usuarios"),e.qZA()(),e.TgZ(8,"div",5),e._UZ(9,"mat-icon",6),e.TgZ(10,"a",7),e._uU(11,"Roles"),e.qZA()()(),e.TgZ(12,"div",8)(13,"a",9),e._UZ(14,"mat-icon",6),e.TgZ(15,"span",10),e._uU(16,"Regresar"),e.qZA()()()(),e.TgZ(17,"div",11)(18,"h2",12),e._uU(19," Gesti\xf3n de Roles "),e.qZA()()(),e.TgZ(20,"div",13),e.YNc(21,eo,4,1,"button",14),e.qZA()(),e.TgZ(22,"div",15)(23,"div",16),e.YNc(24,mo,11,4,"ng-container",17),e.YNc(25,go,2,0,"ng-template",null,18,e.W1O),e.qZA()()()),2&t){const s=e.MAs(26);e.xp6(9),e.Q6J("svgIcon","heroicons_solid:chevron-right"),e.xp6(4),e.Q6J("routerLink","./.."),e.xp6(1),e.Q6J("svgIcon","heroicons_solid:chevron-left"),e.xp6(7),e.Q6J("ngxPermissionsOnly","RolesPermissionsCreate"),e.xp6(3),e.Q6J("ngIf",i.role$)("ngIfElse",s)}},dependencies:[B.yS,C.sg,C.O5,kt.PQ,xe.lW,ve.Hw,D.YE,D.nU,jt.gM,Vt.gE,C.Ov],styles:[".roles-grid{grid-template-columns:auto 95px}@media (min-width: 960px){.roles-grid{grid-template-columns:150px auto 95px}}@media (min-width: 1280px){.roles-grid{grid-template-columns:150px auto 95px}}\n"],encapsulation:2,data:{animation:Ae.L},changeDetection:0}),n})(),resolve:{roles:(()=>{class n{constructor(t){this._roleService=t}resolve(t,i){return this._roleService.getPermissions()}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(U.N))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}];let po=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[B.Bz.forChild(uo),Ze.m]}),n})()}}]);